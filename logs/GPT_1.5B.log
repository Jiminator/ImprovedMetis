{'DeviceType.A100': {'tp32_bs32': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs4': {'time': {'layer-computes': [2.507448196411133, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 0.6699562072753906], 'fb_sync': 102.50520706176758}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs8': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs2': {'time': {'layer-computes': [0.45746564865112305, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 0.10097026824951172], 'fb_sync': 6.075316667556763}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs4': {'time': {'layer-computes': [0.368654727935791, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 0.08487701416015625], 'fb_sync': 5.634516477584839}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs64': {'time': {'layer-computes': [47.18780517578125, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 10.8642578125], 'fb_sync': 721.2181091308594}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs4': {'time': {'layer-computes': [0.09216368198394775, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 0.021219253540039062], 'fb_sync': 1.4086291193962097}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs8': {'time': {'layer-computes': [5.014896392822266, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 1.3399124145507812], 'fb_sync': 205.01041412353516}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs1': {'time': {'layer-computes': [0.2892017364501953, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 0.4100799560546875], 'fb_sync': 56.03322982788086}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs4': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs128': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs32': {'time': {'layer-computes': [20.059585571289062, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 5.359649658203125], 'fb_sync': 820.0416564941406}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs8': {'time': {'layer-computes': [0.737309455871582, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 0.1697540283203125], 'fb_sync': 11.269032955169678}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs32': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs8': {'time': {'layer-computes': [0.1843273639678955, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 0.042438507080078125], 'fb_sync': 2.8172582387924194}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs64': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs64': {'time': {'layer-computes': [40.119171142578125, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 10.71929931640625], 'fb_sync': 1640.0833129882812}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs1': {'time': {'layer-computes': [0.06414949893951416, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.02110004425048828], 'fb_sync': 1.0512709617614746}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs2': {'time': {'layer-computes': [1.8298625946044922, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 0.4038810729980469], 'fb_sync': 24.30126667022705}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs32': {'time': {'layer-computes': [23.593902587890625, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 5.43212890625], 'fb_sync': 360.6090545654297}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs128': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs64': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs2': {'time': {'layer-computes': [0.9149312973022461, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 0.20194053649902344], 'fb_sync': 12.150633335113525}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs64': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs8': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs128': {'time': {'layer-computes': [35.0799560546875, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 34.12628173828125], 'fb_sync': 6697.303771972656}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs2': {'time': {'layer-computes': [1.7201900482177734, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 0.469207763671875], 'fb_sync': 53.24146747589111}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs4': {'time': {'layer-computes': [0.737309455871582, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 0.1697540283203125], 'fb_sync': 11.269032955169678}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs16': {'time': {'layer-computes': [4.3849945068359375, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 4.265785217285156], 'fb_sync': 837.162971496582}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs64': {'time': {'layer-computes': [23.593902587890625, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 5.43212890625], 'fb_sync': 360.6090545654297}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs2': {'time': {'layer-computes': [0.22873282432556152, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 0.05048513412475586], 'fb_sync': 3.0376583337783813}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs2': {'time': {'layer-computes': [0.05718320608139038, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.012621283531188965], 'fb_sync': 0.7594145834445953}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs4': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs128': {'time': {'layer-computes': [94.3756103515625, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 21.728515625], 'fb_sync': 1442.4362182617188}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs32': {'time': {'layer-computes': [11.796951293945312, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 2.716064453125], 'fb_sync': 180.30452728271484}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs16': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs8': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs32': {'time': {'layer-computes': [0.737309455871582, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 0.1697540283203125], 'fb_sync': 11.269032955169678}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs16': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs4': {'time': {'layer-computes': [0.1843273639678955, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 0.042438507080078125], 'fb_sync': 2.8172582387924194}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs128': {'time': {'layer-computes': [23.593902587890625, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 5.43212890625], 'fb_sync': 360.6090545654297}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs8': {'time': {'layer-computes': [0.368654727935791, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 0.08487701416015625], 'fb_sync': 5.634516477584839}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs16': {'time': {'layer-computes': [10.029792785644531, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 2.6798248291015625], 'fb_sync': 410.0208282470703}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs16': {'time': {'layer-computes': [0.737309455871582, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 0.1697540283203125], 'fb_sync': 11.269032955169678}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs8': {'time': {'layer-computes': [2.1924972534179688, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 2.132892608642578], 'fb_sync': 418.581485748291}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs1': {'time': {'layer-computes': [1.1625289916992188, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 0.3528594970703125], 'fb_sync': 31.382155418395996}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs1': {'time': {'layer-computes': [0.12829899787902832, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 0.04220008850097656], 'fb_sync': 2.102541923522949}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs1': {'time': {'layer-computes': [0.03207474946975708, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.01055002212524414], 'fb_sync': 0.5256354808807373}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs16': {'time': {'layer-computes': [11.796951293945312, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 2.716064453125], 'fb_sync': 180.30452728271484}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs4': {'time': {'layer-computes': [1.0962486267089844, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 1.066446304321289], 'fb_sync': 209.2907428741455}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs1': {'time': {'layer-computes': [0.5131959915161133, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 0.16880035400390625], 'fb_sync': 8.410167694091797}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs128': {'time': {'layer-computes': [80.23834228515625, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 21.4385986328125], 'fb_sync': 3280.1666259765625}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs1': {'time': {'layer-computes': [1.0263919830322266, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 16.820335388183594}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs32': {'time': {'layer-computes': [8.769989013671875, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 8.531570434570312], 'fb_sync': 1674.325942993164}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs128': {'time': {'layer-computes': [47.18780517578125, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 10.8642578125], 'fb_sync': 721.2181091308594}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs64': {'time': {'layer-computes': [11.796951293945312, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 2.716064453125], 'fb_sync': 180.30452728271484}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs128': {'time': {'layer-computes': [11.796951293945312, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 2.716064453125], 'fb_sync': 180.30452728271484}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs2': {'time': {'layer-computes': [0.11436641216278076, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 0.02524256706237793], 'fb_sync': 1.5188291668891907}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs2': {'time': {'layer-computes': [0.6282329559326172, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 0.6556510925292969], 'fb_sync': 108.06832313537598}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs16': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs64': {'time': {'layer-computes': [17.53997802734375, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 17.063140869140625], 'fb_sync': 3348.651885986328}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs32': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs1': {'time': {'layer-computes': [0.25659799575805664, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 0.08440017700195312], 'fb_sync': 4.205083847045898}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs16': {'time': {'layer-computes': [0.368654727935791, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 0.08487701416015625], 'fb_sync': 5.634516477584839}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}}, 'model': {'optimizer_time': 21.92707061767578, 'num_layers': 10, 'batch_generator': 0.9746074676513672, 'parameters': [393216000, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 393220096]}, 'DeviceType.V100': {'tp1_bs32': {'time': {'layer-computes': [30.694961547851562, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 29.860496520996094], 'fb_sync': 5860.140800476074}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs1': {'time': {'layer-computes': [3.592371940612793, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 1.1816024780273438], 'fb_sync': 58.87117385864258}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs2': {'time': {'layer-computes': [0.40028244256973267, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 0.08834898471832275], 'fb_sync': 5.315902084112167}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs32': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs1': {'time': {'layer-computes': [0.8980929851531982, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 0.29540061950683594], 'fb_sync': 14.717793464660645}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs128': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs2': {'time': {'layer-computes': [2.19881534576416, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 2.294778823852539], 'fb_sync': 378.2391309738159}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs128': {'time': {'layer-computes': [165.15731811523438, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 38.02490234375], 'fb_sync': 2524.263381958008}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs64': {'time': {'layer-computes': [41.289329528808594, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 9.5062255859375], 'fb_sync': 631.065845489502}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs128': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs16': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs64': {'time': {'layer-computes': [61.389923095703125, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 59.72099304199219], 'fb_sync': 11720.281600952148}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs64': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs128': {'time': {'layer-computes': [280.8341979980469, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 75.03509521484375], 'fb_sync': 11480.583190917969}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs16': {'time': {'layer-computes': [35.10427474975586, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 9.379386901855469], 'fb_sync': 1435.072898864746}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs8': {'time': {'layer-computes': [1.2902915477752686, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 0.2970695495605469], 'fb_sync': 19.720807671546936}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs1': {'time': {'layer-computes': [0.11226162314414978, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 0.03692507743835449], 'fb_sync': 1.8397241830825806}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs4': {'time': {'layer-computes': [0.6451457738876343, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 0.14853477478027344], 'fb_sync': 9.860403835773468}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs8': {'time': {'layer-computes': [7.673740386962891, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 7.465124130249023], 'fb_sync': 1465.0352001190186}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs16': {'time': {'layer-computes': [2.580583095550537, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 0.5941390991210938], 'fb_sync': 39.44161534309387}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs1': {'time': {'layer-computes': [4.068851470947266, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 1.2350082397460938], 'fb_sync': 109.83754396438599}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs16': {'time': {'layer-computes': [41.289329528808594, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 9.5062255859375], 'fb_sync': 631.065845489502}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs1': {'time': {'layer-computes': [1.7961859703063965, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 0.5908012390136719], 'fb_sync': 29.43558692932129}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs4': {'time': {'layer-computes': [3.8368701934814453, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 3.7325620651245117], 'fb_sync': 732.5176000595093}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs1': {'time': {'layer-computes': [0.4490464925765991, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 0.14770030975341797], 'fb_sync': 7.358896732330322}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs16': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs32': {'time': {'layer-computes': [2.580583095550537, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 0.5941390991210938], 'fb_sync': 39.44161534309387}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs16': {'time': {'layer-computes': [15.347480773925781, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 14.930248260498047], 'fb_sync': 2930.070400238037}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs4': {'time': {'layer-computes': [2.580583095550537, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 0.5941390991210938], 'fb_sync': 39.44161534309387}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs2': {'time': {'layer-computes': [3.2022595405578613, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 0.706791877746582], 'fb_sync': 42.52721667289734}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs128': {'time': {'layer-computes': [82.57865905761719, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 19.012451171875], 'fb_sync': 1262.131690979004}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs2': {'time': {'layer-computes': [0.8005648851394653, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 0.1766979694366455], 'fb_sync': 10.631804168224335}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs64': {'time': {'layer-computes': [82.57865905761719, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 19.012451171875], 'fb_sync': 1262.131690979004}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs16': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs8': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs2': {'time': {'layer-computes': [6.020665168762207, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 1.6422271728515625], 'fb_sync': 186.3451361656189}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs128': {'time': {'layer-computes': [330.31463623046875, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 76.0498046875], 'fb_sync': 5048.526763916016}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs4': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs2': {'time': {'layer-computes': [0.20014122128486633, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 0.04417449235916138], 'fb_sync': 2.6579510420560837}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs128': {'time': {'layer-computes': [122.77984619140625, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 119.44198608398438], 'fb_sync': 23440.563201904297}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs32': {'time': {'layer-computes': [41.289329528808594, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 9.5062255859375], 'fb_sync': 631.065845489502}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs8': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs8': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs4': {'time': {'layer-computes': [8.776068687438965, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 2.344846725463867], 'fb_sync': 358.7682247161865}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs64': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs8': {'time': {'layer-computes': [2.580583095550537, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 0.5941390991210938], 'fb_sync': 39.44161534309387}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs32': {'time': {'layer-computes': [70.20854949951172, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 18.758773803710938], 'fb_sync': 2870.145797729492}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp16_bs2': {'time': {'layer-computes': [1.6011297702789307, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 0.353395938873291], 'fb_sync': 21.26360833644867}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs4': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs8': {'time': {'layer-computes': [17.55213737487793, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 4.689693450927734], 'fb_sync': 717.536449432373}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp1_bs1': {'time': {'layer-computes': [1.0122060775756836, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 1.4352798461914062], 'fb_sync': 196.116304397583}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs64': {'time': {'layer-computes': [165.15731811523438, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 38.02490234375], 'fb_sync': 2524.263381958008}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs4': {'time': {'layer-computes': [1.2902915477752686, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 0.2970695495605469], 'fb_sync': 19.720807671546936}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs64': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs128': {'time': {'layer-computes': [41.289329528808594, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 9.5062255859375], 'fb_sync': 631.065845489502}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs32': {'time': {'layer-computes': [82.57865905761719, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 19.012451171875], 'fb_sync': 1262.131690979004}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs8': {'time': {'layer-computes': [0.6451457738876343, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 0.14853477478027344], 'fb_sync': 9.860403835773468}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs32': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp2_bs64': {'time': {'layer-computes': [140.41709899902344, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 37.517547607421875], 'fb_sync': 5740.291595458984}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs2': {'time': {'layer-computes': [6.404519081115723, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 1.413583755493164], 'fb_sync': 85.05443334579468}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs4': {'time': {'layer-computes': [0.32257288694381714, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 0.07426738739013672], 'fb_sync': 4.930201917886734}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp32_bs32': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp128_bs16': {'time': {'layer-computes': [1.2902915477752686, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 0.2970695495605469], 'fb_sync': 19.720807671546936}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp64_bs1': {'time': {'layer-computes': [0.22452324628829956, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 0.07385015487670898], 'fb_sync': 3.679448366165161}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}}}


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=128, gbs=128)
invalid_strategy: dp_deg(32), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(16, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 8)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 16)]
Adjusting stage:  0
valid_strategies: [(1, 32)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [265600.001]
memory_state: [1307263.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 128, gbs: 128, strategies: [(1, 32)], layer_partition: [0, 10]
data loadbalancer: [1]
execution_cost: 1329.5936584472656, fb_sync_cost: 941.9387817382812, parameter_upate_costs: 0.6852209568023682, dp_cost: 0.0, pp_cost: 0.0
cost: 2396.9674170017242


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=64, gbs=128)
invalid_strategy: dp_deg(32), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(16, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 8)]
Adjusting stage:  0
valid_strategies: [(2, 16)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [265600.001]
memory_state: [1307263.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 64, gbs: 128, strategies: [(2, 16)], layer_partition: [0, 10]
data loadbalancer: [2, 0]
execution_cost: 2489.9330139160156, fb_sync_cost: 941.9387817382812, parameter_upate_costs: 1.3704419136047363, dp_cost: 3.1169380519701084, pp_cost: 0.0
cost: 3498.734053549559


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=32, gbs=128)
invalid_strategy: dp_deg(32), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(16, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 4)]
Adjusting stage:  0
valid_strategies: [(4, 8)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [531200.0009999999]
memory_state: [1041663.9990000001]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 32, gbs: 128, strategies: [(4, 8)], layer_partition: [0, 10]
data loadbalancer: [2, 2, 0, 0]
execution_cost: 2489.9330139160156, fb_sync_cost: 941.9387817382812, parameter_upate_costs: 2.7408838272094727, dp_cost: 9.350814155910326, pp_cost: 0.0
cost: 3475.1509326022606


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=16, gbs=128)
invalid_strategy: dp_deg(32), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(16, 2)]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1062400.001]
memory_state: [510463.99900000007]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 16, gbs: 128, strategies: [(8, 4)], layer_partition: [0, 10]
data loadbalancer: [2, 2, 2, 2, 0, 0, 0, 0]
execution_cost: 2489.9330139160156, fb_sync_cost: 941.9387817382812, parameter_upate_costs: 5.481767654418945, dp_cost: 21.81856636379076, pp_cost: 0.0
cost: 3474.7658491549287


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=8, gbs=128)
invalid_strategy: dp_deg(32), batches(8), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
Adjusting stage:  0
valid_strategies: [(16, 2)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [2124800.001]
memory_state: [-551936.0010000002]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(16, 2)]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [3187200.001]
memory_state: [-1614336.0010000002]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(8, 4)]
Adjusting stage:  0
valid_strategies: [(4, 8)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1593600.001]
memory_state: [-20736.00099999993]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(4, 8)]
Adjusting stage:  0
valid_strategies: [(2, 16)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [796800.0009999999]
memory_state: [776063.9990000001]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 8, gbs: 128, strategies: [(2, 16)], layer_partition: [0, 10]
data loadbalancer: [12, 4]
execution_cost: 2031.531810760498, fb_sync_cost: 631.065845489502, parameter_upate_costs: 1.3704419136047363, dp_cost: 3.1169380519701084, pp_cost: 0.0
cost: 2674.8818959567857


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=4, gbs=128)
valid_strategies: [(32, 1)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [4249600.001]
memory_state: [-2676736.001]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(32, 1)]
Adjusting stage:  0
valid_strategies: [(16, 2)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [6374400.001]
memory_state: [-4801536.001]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(16, 2)]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [3187200.001]
memory_state: [-1614336.0010000002]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(8, 4)]
Adjusting stage:  0
valid_strategies: [(4, 8)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1593600.001]
memory_state: [-20736.00099999993]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(4, 8)]
Adjusting stage:  0
valid_strategies: [(2, 16)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1593600.001]
memory_state: [-20736.00099999993]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(2, 16)]
Adjusting stage:  0
valid_strategies: [(1, 32)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [265600.001]
memory_state: [1307263.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 4, gbs: 128, strategies: [(1, 32)], layer_partition: [0, 10]
data loadbalancer: [32]
execution_cost: 1160.8753204345703, fb_sync_cost: 631.065845489502, parameter_upate_costs: 0.6852209568023682, dp_cost: 0.0, pp_cost: 0.0
cost: 1796.52481675148


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=2, gbs=128)
valid_strategies: [(32, 1)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [12748800.001]
memory_state: [-11175936.001]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(32, 1)]
Adjusting stage:  0
valid_strategies: [(16, 2)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [6374400.001]
memory_state: [-4801536.001]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(16, 2)]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [3187200.001]
memory_state: [-1614336.0010000002]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(8, 4)]
Adjusting stage:  0
valid_strategies: [(4, 8)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [3187200.001]
memory_state: [-1614336.0010000002]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(4, 8)]
Adjusting stage:  0
valid_strategies: [(2, 16)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1593600.001]
memory_state: [-20736.00099999993]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(2, 16)]
Adjusting stage:  0
valid_strategies: [(1, 32)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [265600.001]
memory_state: [1307263.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 2, gbs: 128, strategies: [(1, 32)], layer_partition: [0, 10]
data loadbalancer: [64]
execution_cost: 1160.8753204345703, fb_sync_cost: 631.065845489502, parameter_upate_costs: 0.6852209568023682, dp_cost: 0.0, pp_cost: 0.0
cost: 1794.5756018161774


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=1, gbs=128)
valid_strategies: [(32, 1)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [12748800.001]
memory_state: [-11175936.001]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(32, 1)]
Adjusting stage:  0
valid_strategies: [(16, 2)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [6374400.001]
memory_state: [-4801536.001]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(16, 2)]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [6374400.001]
memory_state: [-4801536.001]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(8, 4)]
Adjusting stage:  0
valid_strategies: [(4, 8)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [3187200.001]
memory_state: [-1614336.0010000002]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(4, 8)]
Adjusting stage:  0
valid_strategies: [(2, 16)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1593600.001]
memory_state: [-20736.00099999993]
MEMORY EXCEEDED
TESTING NEW PARTITION
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(2, 16)]
Adjusting stage:  0
valid_strategies: [(1, 32)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [265600.001]
memory_state: [1307263.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 1, gbs: 128, strategies: [(1, 32)], layer_partition: [0, 10]
data loadbalancer: [128]
execution_cost: 1160.8753204345703, fb_sync_cost: 631.065845489502, parameter_upate_costs: 0.6852209568023682, dp_cost: 0.0, pp_cost: 0.0
cost: 1793.600994348526


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=128, gbs=128)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (2, 8)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 16), (2, 8)]
Adjusting stage:  1
valid_strategies: [(1, 16), (1, 16)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 128, gbs: 128, strategies: [(1, 16), (1, 16)], layer_partition: [0, 7, 10]
execution_cost: 2341.9904112815857, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 0.9593093395233153, dp_cost: 0.0, pp_cost: 0.08695652173913043
cost: 4351.6639964787855


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=64, gbs=128)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
Adjusting stage:  1
valid_strategies: [(2, 8), (2, 8)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 64, gbs: 128, strategies: [(2, 8), (2, 8)], layer_partition: [0, 7, 10]
execution_cost: 2357.5724363327026, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 1.9186186790466306, dp_cost: 4.165888247282608, pp_cost: 0.08695652173913043
cost: 4309.996341187021


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=32, gbs=128)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
valid_strategies: [(4, 4), (4, 4)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 32, gbs: 128, strategies: [(4, 4), (4, 4)], layer_partition: [0, 7, 10]
execution_cost: 2388.7364864349365, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 3.8372373580932613, dp_cost: 12.497664741847826, pp_cost: 0.08695652173913043
cost: 4320.223347498023


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=16, gbs=128)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
valid_strategies: [(8, 2), (8, 2)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 16, gbs: 128, strategies: [(8, 2), (8, 2)], layer_partition: [0, 7, 10]
execution_cost: 2007.7872276306152, fb_sync_cost: 1757.4007034301758, parameter_upate_costs: 7.6744747161865225, dp_cost: 29.16121773097826, pp_cost: 0.08695652173913043
cost: 3817.704299512117


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=8, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 8, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 7, 10]
execution_cost: 1841.2671089172363, fb_sync_cost: 1568.930435180664, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48832370923913, pp_cost: 0.08695652173913043
cost: 3495.9186335024624


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=4, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 4, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 7, 10]
execution_cost: 2011.1629962921143, fb_sync_cost: 1512.9565238952637, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48832370923913, pp_cost: 0.17391304347826086
cost: 3606.029136243074


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=2, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.22222222222222227]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 2, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 7, 10]
execution_cost: 2339.8754596710205, fb_sync_cost: 1465.0352001190186, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48832370923913, pp_cost: 0.34782608695652173
cost: 3885.0449739539104


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=1, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.22222222222222227]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 1, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 7, 10]
execution_cost: 3040.3659343719482, fb_sync_cost: 1465.0352001190186, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48832370923913, pp_cost: 0.6956521739130435
cost: 4584.908667274143


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (4, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 2), (4, 2), (4, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (4, 2), (4, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (4, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (2, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (2, 4), (2, 4), (2, 4)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 8), (2, 4), (2, 4)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 8), (1, 8), (2, 4)]
Adjusting stage:  3
valid_strategies: [(1, 8), (1, 8), (1, 8), (1, 8)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.1111111111111111, 0.1111111111111111]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 128, gbs: 128, strategies: [(1, 8), (1, 8), (1, 8), (1, 8)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2413.2633805274963, fb_sync_cost: 3767.755126953125, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.2539130434782609
cost: 6307.118529914358


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (4, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 2), (4, 2), (4, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (4, 2), (4, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (4, 2)]
Adjusting stage:  3
valid_strategies: [(2, 4), (2, 4), (2, 4), (2, 4)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.1111111111111111, 0.1111111111111111]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 64, gbs: 128, strategies: [(2, 4), (2, 4), (2, 4), (2, 4)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2462.307095527649, fb_sync_cost: 3767.755126953125, parameter_upate_costs: 2.192707061767578, dp_cost: 5.184909986413043, pp_cost: 0.2539130434782609
cost: 6300.06863050212


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
Adjusting stage:  3
valid_strategies: [(4, 2), (4, 2), (4, 2), (4, 2)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.38888888888888895, 0.38888888888888895, 0.11111111111111112, 0.11111111111111112]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 32, gbs: 128, strategies: [(4, 2), (4, 2), (4, 2), (4, 2)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2086.4797830581665, fb_sync_cost: 3514.8014068603516, parameter_upate_costs: 4.385414123535156, dp_cost: 15.55472995923913, pp_cost: 0.2539130434782609
cost: 5652.662686009614


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=16, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.38888888888888884, 0.38888888888888884, 0.11111111111111109, 0.11111111111111109]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 16, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 1956.027328968048, fb_sync_cost: 3137.860870361328, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 0.2539130434782609
cost: 5154.801030007237


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=8, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.38888888888888895, 0.38888888888888895, 0.11111111111111112, 0.11111111111111112]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 8, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2226.364016532898, fb_sync_cost: 3025.9130477905273, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 0.5078260869565218
cost: 5305.646948303554


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=4, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.11111111111111113, 0.11111111111111113]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 4, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2755.3205490112305, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 1.0156521739130435
cost: 5735.370229445747


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=2, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.11111111111111113, 0.11111111111111113]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 2, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 3863.790988922119, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 2.031304347826087
cost: 6842.907106595247


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=1, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.11111111111111113, 0.11111111111111113]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 1, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 6080.7318687438965, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 4.062608695652174
cost: 9060.9046832972


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3888888888888889, 0.19444444444444445, 0.19444444444444445, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [554069.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 4660.624623298645, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.6708695652173913
cost: 12322.651856160372


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.34278333506180053, 0.20911439338942708, 0.20911439338942708, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [554069.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 3914.03329372406, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 5.184909986413043, pp_cost: 0.9208695652173913
cost: 11014.30947198785


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
valid_strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3561007165712159, 0.20487704472734045, 0.20487704472734045, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [101290.001, 41460.001, 20730.001, 20730.001, 0.001, 0.001, 20730.001]
memory_state: [554069.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
execution_cost: 3548.3734011650085, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 15.55472995923913, pp_cost: 0.5008695652173913
cost: 9875.723594500501


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3882179489171986, 0.19465792534452764, 0.19465792534452764, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [554069.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 3770.0705528259277, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 2.754782608695652
cost: 9885.310348650062


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.38643964617890403, 0.1952237489430759, 0.1952237489430759, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [554069.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 4202.4677991867065, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 5.509565217391304
cost: 10120.980222773345


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3888888888888888, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [554069.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 5137.4523639678955, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 11.019130434782609
cost: 11057.57592290132


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3888888888888888, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [554069.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 7011.0650062561035, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 22.038260869565217
cost: 12940.258480689008


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3888888888888888, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [554069.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 10758.29029083252, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 44.076521739130435
cost: 16708.54741866734


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444445, 0.3888888888888889, 0.19444444444444445, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 62190.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 593169.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
execution_cost: 4661.137819290161, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.6445302963256836, dp_cost: 0.0, pp_cost: 0.6708695652173913
cost: 12323.71322891733


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20911439338942708, 0.34278333506180053, 0.20911439338942708, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305]
layer_partition: [0, 2, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 62190.001, 41460.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 593169.999, 286219.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 5, 7, 8, 8, 9, 10]
execution_cost: 3914.169430732727, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 0.9208695652173913
cost: 11015.43469697206


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20487704472734045, 0.3561007165712159, 0.20487704472734045, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 62190.001, 20730.001, 20730.001, 0.001, 0.001, 20730.001]
memory_state: [247119.999, 593169.999, 306949.999, 44805.998999999996, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
execution_cost: 3547.5000739097595, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 0.5008695652173913
cost: 9886.303971249954


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19465792534452764, 0.3882179489171986, 0.19465792534452764, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 62190.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 593169.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
execution_cost: 3770.40958404541, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 2.754782608695652
cost: 9871.97802980506


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1952237489430759, 0.38643964617890403, 0.1952237489430759, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 62190.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 593169.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
execution_cost: 4202.935814857483, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 5.509565217391304
cost: 10107.776888379636


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.3888888888888888, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 62190.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 593169.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
execution_cost: 5138.5486125946045, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 11.019130434782609
cost: 11045.000821463544


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.3888888888888888, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 62190.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 593169.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
execution_cost: 7013.2575035095215, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 22.038260869565217
cost: 12928.77962787794


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.3888888888888888, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 62190.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 593169.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
execution_cost: 10762.675285339355, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 44.076521739130435
cost: 16699.261063109687


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.3888888888888889, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 62190.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 593169.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 4661.137819290161, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.6708695652173913
cost: 12323.165052151888


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20911439338942708, 0.20911439338942708, 0.34278333506180053, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 62190.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 593169.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 3914.169430732727, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 0.9208695652173913
cost: 11015.43469697206


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
valid_strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20487704472734045, 0.20487704472734045, 0.3561007165712159, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 62190.001, 20730.001, 0.001, 0.001, 20730.001]
memory_state: [267849.999, 286219.999, 593169.999, 44805.998999999996, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
execution_cost: 3547.5000739097595, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 0.5008695652173913
cost: 9877.817531171882


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19465792534452764, 0.19465792534452764, 0.3882179489171986, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 62190.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 593169.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 3770.40958404541, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 2.754782608695652
cost: 9869.190368459951


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1952237489430759, 0.1952237489430759, 0.38643964617890403, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 62190.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 593169.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 4202.935814857483, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 5.509565217391304
cost: 10104.989227034528


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.3888888888888888, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 62190.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 593169.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 5138.5486125946045, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 11.019130434782609
cost: 11042.213160118436


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.3888888888888888, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 62190.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 593169.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 7013.2575035095215, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 22.038260869565217
cost: 12925.991966532833


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.3888888888888888, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 62190.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 593169.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 10762.675285339355, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 44.076521739130435
cost: 16696.47340176458


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.17073170731707318, 0.17073170731707318, 0.17073170731707318, 0.34146341463414637, 0.04878048780487805, 0.04878048780487805, 0.04878048780487805]
layer_partition: [0, 2, 4, 5, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 62190.001, 0.001, 0.001, 20730.001]
memory_state: [267849.999, 286219.999, 306949.999, 331025.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 2, 4, 5, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 5, 8, 8, 8, 9]
data loadbalancer: [1]
execution_cost: 4634.413838386536, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 12296.27802777


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.21130644822118014, 0.21130644822118014, 0.21130644822118014, 0.1849608425754481, 0.060373270920337174, 0.060373270920337174, 0.060373270920337174]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 41460.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 351755.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [2, 0]
execution_cost: 3896.608591079712, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 0.9278260869565218
cost: 10997.880813840782


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20976043001836134, 0.20976043001836134, 0.20976043001836134, 0.19092405564346368, 0.059931551433817516, 0.059931551433817516, 0.059931551433817516]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 82920.00099999999, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 310295.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [2, 2, 0, 0]
execution_cost: 3518.643021583557, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.4278260869565218
cost: 9849.887435367418


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20588235294117643, 0.20588235294117643, 0.20588235294117643, 0.20588235294117643, 0.05882352941176469, 0.05882352941176469, 0.05882352941176469]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 165840.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 227375.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [2, 2, 2, 2, 0, 0, 0, 0]
execution_cost: 3711.317300796509, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 2.7686956521739132
cost: 9804.413219521564


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20059862743701, 0.20059862743701, 0.20059862743701, 0.22626243702867543, 0.05731389355343144, 0.05731389355343144, 0.05731389355343144]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001]
memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(2): [0.2229967673043395, 0.2171898421535504, 0.2128884161159288, 0.16094430220665817, 0.05991490703045129, 0.05972223936548685, 0.05954384337940868]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4071.3407397270203, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 5.5373913043478264
cost: 9976.20963933613
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2047589705246348, 0.2047589705246348, 0.2047589705246348, 0.21021539940497988, 0.05850256300703852, 0.05850256300703852, 0.05850256300703852]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [6, 6, 2, 2]
execution_cost: 4077.1881341934204, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 5.711304347826087
cost: 9973.744506767936


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20047034993794183, 0.20047034993794183, 0.20047034993794183, 0.2267572216679385, 0.05727724283941196, 0.05727724283941196, 0.05727724283941196]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001]
memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(2): [0.2229174694578374, 0.21709784587860523, 0.2127870135976925, 0.16129625089754349, 0.059883944143062896, 0.059690855157607275, 0.059512069059963174]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 4878.3077001571655, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 11.074782608695653
cost: 10784.815561200017
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20382888377982383, 0.20382888377982383, 0.20382888377982383, 0.2138028768492507, 0.058236823937092536, 0.058236823937092536, 0.058236823937092536]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001]
memory_state: [267849.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
data loadbalancer: [12, 12, 4, 4]
execution_cost: 4874.451398849487, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 4.062608695652174
cost: 10765.460645901225


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.22857142857142856, 0.05714285714285714, 0.05714285714285714, 0.05714285714285714]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001]
memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(2): [0.22262671123872554, 0.2167605268435004, 0.21241520506925954, 0.16258672698352195, 0.05977041377127187, 0.05957577994694485, 0.05939556344293835]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [12, 12, 12, 12, 4, 4, 4, 4]
execution_cost: 6488.711833953857, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 22.149565217391306
cost: 12404.345262670102
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19885996432338424, 0.19885996432338424, 0.19885996432338424, 0.2329687090383749, 0.05681713266382408, 0.05681713266382408, 0.05681713266382408]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 20730.001, 0.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 44805.998999999996, 65535.999, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(2): [0.22192197054181542, 0.21594293189259253, 0.21151401437464964, 0.1657145870280505, 0.059495238494779716, 0.0592968602850793, 0.05911317675757891]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [25, 25, 7, 7]
execution_cost: 6477.0801067352295, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 22.84521739130435
cost: 12393.409187625388
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2047180194723056, 0.2047180194723056, 0.2047180194723056, 0.21037335346396388, 0.05849086270637304, 0.05849086270637304, 0.05849086270637304]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [50, 14]
execution_cost: 6512.587547302246, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 24.236521739130435
cost: 12421.821492462159


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.1946863889308981, 0.1946863889308981, 0.1946863889308981, 0.24906678555224995, 0.05562468255168518, 0.05562468255168518, 0.05562468255168518]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 995040.0009999999, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, -601824.0009999999, 65535.999, 44805.998999999996, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(2): [0.2553719463374355, 0.23924294989744382, 0.22740634218521016, 0.08858271078987726, 0.06249093100069903, 0.061970263217200824, 0.0597670570341657]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 497520.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 44805.998999999996, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(3): [0.26257797013708856, 0.24409151428199768, 0.23079836611970359, 0.0630103819391115, 0.06318915535596463, 0.06261492474885011, 0.06034628379018124]
layer_partition: [0, 3, 5, 7, 7, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 0.001, 20730.001, 20730.001, 60660.001]
memory_state: [247119.999, 286219.999, 286219.999, 393215.999, 44805.998999999996, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 7, 8, 9, 10]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 12161.463737487793, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 44.29913043478261
cost: 18098.272123953775
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19877045185262507, 0.19877045185262507, 0.19877045185262507, 0.23331397142558877, 0.0567915576721786, 0.0567915576721786, 0.0567915576721786]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 20730.001, 0.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 44805.998999999996, 65535.999, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(2): [0.221866636237531, 0.215878736582185, 0.2114432553560028, 0.1659601780095588, 0.059473632487708275, 0.059274960279150524, 0.059091004530485935]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 9688.886404037476, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 45.6904347826087
cost: 15627.086094851287
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20459330781600232, 0.20459330781600232, 0.20459330781600232, 0.21085438413827648, 0.0584552308045721, 0.0584552308045721, 0.0584552308045721]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [100, 28]
execution_cost: 9756.2894821167, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 48.47304347826087
cost: 15688.785341548091


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.1111111111111111, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 41460.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 306949.999, 286219.999, 110341.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
execution_cost: 4658.583581447601, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.6778260869565218
cost: 12320.617770831066


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.09293012755243117, 0.05669186702797304, 0.05669186702797304]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 41460.001, 20730.001, 0.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 286219.999, 110341.999, 65535.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
execution_cost: 2408.8594913482666, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 1.0978260869565217
cost: 9510.301714109337


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.09798779357278413, 0.056375762901700995, 0.056375762901700995]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 41460.001, 20730.001, 0.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 286219.999, 110341.999, 65535.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
execution_cost: 2096.7085361480713, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.8478260869565217
cost: 8428.372949931932


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.11083249740828255, 0.05557296891198233, 0.05557296891198233]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 41460.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 306949.999, 286219.999, 110341.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
execution_cost: 3755.7318806648254, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 2.7756521739130435
cost: 9848.834755911621


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.11009614959318086, 0.0556189906504262, 0.0556189906504262]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 41460.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 306949.999, 286219.999, 110341.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
execution_cost: 4174.084663391113, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 5.551304347826087
cost: 10070.48103596563


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.11111111111111112, 0.05555555555555556, 0.05555555555555556]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 41460.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 306949.999, 286219.999, 110341.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
execution_cost: 5080.265760421753, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 11.102608695652174
cost: 10978.31500747349


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.11111111111111112, 0.05555555555555556, 0.05555555555555556]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 41460.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 306949.999, 286219.999, 110341.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
execution_cost: 6896.691799163818, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 22.20521739130435
cost: 12803.894439975904


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.11111111111111112, 0.05555555555555556, 0.05555555555555556]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 20730.001, 41460.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 306949.999, 286219.999, 110341.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
execution_cost: 10529.54387664795, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 44.4104347826087
cost: 16457.977127383685


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 4), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.05555555555555555, 0.1111111111111111, 0.05555555555555555]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 110341.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)], layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
execution_cost: 4658.583581447601, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5528260869565218
cost: 12320.492770831066


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.05669186702797304, 0.09293012755243117, 0.05669186702797304]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 41460.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 286219.999, 65535.999, 110341.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 2408.8594913482666, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 0.6778260869565218
cost: 9509.881714109337


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.056375762901700995, 0.09798779357278413, 0.056375762901700995]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 41460.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 286219.999, 65535.999, 110341.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 2096.7085361480713, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 0.9278260869565218
cost: 8427.452949931932


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.05557296891198233, 0.11083249740828255, 0.05557296891198233]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 110341.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
execution_cost: 3755.7318806648254, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.8556521739130436
cost: 9847.91475591162


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.0556189906504262, 0.11009614959318086, 0.0556189906504262]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 110341.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
execution_cost: 4174.084663391113, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 3.711304347826087
cost: 10068.64103596563


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.11111111111111112, 0.05555555555555556]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 110341.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
execution_cost: 5080.265760421753, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 7.422608695652174
cost: 10974.63500747349


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.11111111111111112, 0.05555555555555556]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 110341.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
execution_cost: 6896.691799163818, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 14.845217391304349
cost: 12796.534439975905


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.11111111111111112, 0.05555555555555556]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 110341.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
execution_cost: 10529.54387664795, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 29.690434782608698
cost: 16443.257127383687


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 4)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 4)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.05555555555555555, 0.05555555555555555, 0.1111111111111111]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 81390.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 49681.998999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 4657.992780208588, fb_sync_cost: 3767.755126953125, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 8552.101842638927


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.05669186702797304, 0.05669186702797304, 0.09293012755243117]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 41460.001, 41460.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 306949.999, 286219.999, 286219.999, 65535.999, 44805.998999999996, 70411.99900000001]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 3891.8840885162354, fb_sync_cost: 3767.755126953125, parameter_upate_costs: 3.289060592651367, dp_cost: 8.271908967391305, pp_cost: 0.9278260869565218
cost: 7734.502889046047


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.056375762901700995, 0.056375762901700995, 0.09798779357278413]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 41460.001, 41460.001, 0.001, 20730.001, 60660.001]
memory_state: [247119.999, 306949.999, 286219.999, 286219.999, 65535.999, 44805.998999999996, 70411.99900000001]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 3512.975573539734, fb_sync_cost: 3514.8014068603516, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 1.4278260869565218
cost: 7091.786093539363


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.05557296891198233, 0.05557296891198233, 0.11083249740828255]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 81390.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 49681.998999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 3754.8723816871643, fb_sync_cost: 3137.860870361328, parameter_upate_costs: 4.385414123535156, dp_cost: 19.88041015625, pp_cost: 1.0156521739130435
cost: 6933.608447984612


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.0556189906504262, 0.0556189906504262, 0.11009614959318086]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 81390.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 49681.998999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 4172.646880149841, fb_sync_cost: 3025.9130477905273, parameter_upate_costs: 4.385414123535156, dp_cost: 19.88041015625, pp_cost: 2.031304347826087
cost: 7232.653916309191


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.05555555555555556, 0.11111111111111112]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 81390.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 49681.998999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 5076.533198356628, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 4.385414123535156, dp_cost: 19.88041015625, pp_cost: 4.062608695652174
cost: 8038.830461440708


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.05555555555555556, 0.11111111111111112]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 81390.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 49681.998999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 6889.226675033569, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 4.385414123535156, dp_cost: 19.88041015625, pp_cost: 8.125217391304348
cost: 9853.637331877997


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.05555555555555556, 0.11111111111111112]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 81390.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 49681.998999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 10514.613628387451, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 4.385414123535156, dp_cost: 19.88041015625, pp_cost: 16.250434782608696
cost: 13486.174895155533


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  7
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  7
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 4676.46324634552, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.7578260869565218
cost: 12338.577435728985


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  7
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.05555555555555554, 0.05555555555555554, 0.05555555555555554, 0.05555555555555554]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 3934.032082557678, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 1.0078260869565216
cost: 11035.384305318748


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=32, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444448, 0.19444444444444448, 0.19444444444444448, 0.19444444444444448, 0.05555555555555556, 0.05555555555555556, 0.05555555555555556, 0.05555555555555556]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 3586.9458317756653, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.5078260869565216
cost: 9918.270245559526


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555554, 0.05555555555555554, 0.05555555555555554, 0.05555555555555554]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 3858.4758043289185, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 3.0156521739130433
cost: 9951.818679575714


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 4376.042723655701, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 6.031304347826087
cost: 10272.919096230216


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 5488.245725631714, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 12.062608695652173
cost: 11387.254972683451


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 7712.65172958374, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 24.125217391304346
cost: 13621.774370395826


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 12161.463737487793, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 48.25043478260869
cost: 18093.73698822353


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=128, gbs=128)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (2, 8)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 16), (2, 8)]
Adjusting stage:  1
valid_strategies: [(1, 16), (1, 16)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 128, gbs: 128, strategies: [(1, 16), (1, 16)], layer_partition: [0, 3, 10]
execution_cost: 2403.553009033203, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 0.4111325740814209, dp_cost: 0.0, pp_cost: 0.0
cost: 4412.591460943222


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=64, gbs=128)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
Adjusting stage:  1
valid_strategies: [(2, 8), (2, 8)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 64, gbs: 128, strategies: [(2, 8), (2, 8)], layer_partition: [0, 3, 10]
execution_cost: 2403.553009033203, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 0.8222651481628418, dp_cost: 1.9025390625, pp_cost: 0.0
cost: 4352.530254650116


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=32, gbs=128)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
valid_strategies: [(4, 4), (4, 4)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 32, gbs: 128, strategies: [(4, 4), (4, 4)], layer_partition: [0, 3, 10]
execution_cost: 2403.553009033203, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 1.6445302963256836, dp_cost: 5.7076171874999995, pp_cost: 0.0
cost: 4325.970158958435


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=16, gbs=128)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
valid_strategies: [(8, 2), (8, 2)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 16, gbs: 128, strategies: [(8, 2), (8, 2)], layer_partition: [0, 3, 10]
execution_cost: 1950.9391784667969, fb_sync_cost: 1757.4007034301758, parameter_upate_costs: 3.289060592651367, dp_cost: 13.317773437500001, pp_cost: 0.0
cost: 3740.540435409546


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=8, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 8, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1660.5453491210938, fb_sync_cost: 1568.930435180664, parameter_upate_costs: 6.578121185302734, dp_cost: 28.5380859375, pp_cost: 0.0
cost: 3272.3888511657715


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=4, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 4, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1656.970500946045, fb_sync_cost: 1512.9565238952637, parameter_upate_costs: 6.578121185302734, dp_cost: 28.5380859375, pp_cost: 0.0
cost: 3208.941661834717


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=2, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.22222222222222227, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 2, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1639.5936012268066, fb_sync_cost: 1465.0352001190186, parameter_upate_costs: 6.578121185302734, dp_cost: 28.5380859375, pp_cost: 0.0
cost: 3141.6942234039307


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=1, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.22222222222222227, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 1, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1639.5936012268066, fb_sync_cost: 1465.0352001190186, parameter_upate_costs: 6.578121185302734, dp_cost: 28.5380859375, pp_cost: 0.0
cost: 3140.7196159362793


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=128, gbs=128)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (2, 8)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 16), (2, 8)]
Adjusting stage:  1
valid_strategies: [(1, 16), (1, 16)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 128, gbs: 128, strategies: [(1, 16), (1, 16)], layer_partition: [0, 3, 10]
execution_cost: 2418.962836265564, fb_sync_cost: 538.250732421875, parameter_upate_costs: 0.9593093395233153, dp_cost: 0.0, pp_cost: 0.08695652173913043
cost: 3083.0095904080763


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=64, gbs=128)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
Adjusting stage:  1
valid_strategies: [(2, 8), (2, 8)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 64, gbs: 128, strategies: [(2, 8), (2, 8)], layer_partition: [0, 3, 10]
execution_cost: 2434.372663497925, fb_sync_cost: 538.250732421875, parameter_upate_costs: 1.9186186790466306, dp_cost: 4.165898862092392, pp_cost: 0.08695652173913043
cost: 3041.1697479123654


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=32, gbs=128)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
Adjusting stage:  1
valid_strategies: [(4, 4), (4, 4)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 32, gbs: 128, strategies: [(4, 4), (4, 4)], layer_partition: [0, 3, 10]
execution_cost: 2465.1923179626465, fb_sync_cost: 538.250732421875, parameter_upate_costs: 3.8372373580932613, dp_cost: 12.497696586277174, pp_cost: 0.08695652173913043
cost: 3051.0523798154745


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=16, gbs=128)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
Adjusting stage:  1
valid_strategies: [(8, 2), (8, 2)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 16, gbs: 128, strategies: [(8, 2), (8, 2)], layer_partition: [0, 3, 10]
execution_cost: 2052.319049835205, fb_sync_cost: 502.11448669433594, parameter_upate_costs: 7.6744747161865225, dp_cost: 29.161292034646742, pp_cost: 0.08695652173913043
cost: 2606.949979284535


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=8, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 8, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1838.003396987915, fb_sync_cost: 448.2658386230469, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48848293138587, pp_cost: 0.08695652173913043
cost: 2371.990484237671


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=4, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 4, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 2010.8065605163574, fb_sync_cost: 432.2732925415039, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48848293138587, pp_cost: 0.17391304347826086
cost: 2524.9896283357043


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=2, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.22222222222222227, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 2, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 2340.0542736053467, fb_sync_cost: 418.581485748291, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48848293138587, pp_cost: 0.34782608695652173
cost: 2838.770232739656


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=1, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.22222222222222227, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 1, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 3040.5149459838867, fb_sync_cost: 418.581485748291, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48848293138587, pp_cost: 0.6956521739130435
cost: 3538.604123737501


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (4, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 2), (4, 2), (4, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (4, 2), (4, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (4, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (2, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (2, 4), (2, 4), (2, 4)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 8), (2, 4), (2, 4)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 8), (1, 8), (2, 4)]
Adjusting stage:  3
valid_strategies: [(1, 8), (1, 8), (1, 8), (1, 8)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 128, gbs: 128, strategies: [(1, 8), (1, 8), (1, 8), (1, 8)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2567.208230495453, fb_sync_cost: 1076.50146484375, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.2539130434782609
cost: 3769.80971777294


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (4, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 2), (4, 2), (4, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (4, 2), (4, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (4, 2)]
Adjusting stage:  3
valid_strategies: [(2, 4), (2, 4), (2, 4), (2, 4)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 64, gbs: 128, strategies: [(2, 4), (2, 4), (2, 4), (2, 4)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2615.9075498580933, fb_sync_cost: 1076.50146484375, parameter_upate_costs: 2.192707061767578, dp_cost: 5.184931216032608, pp_cost: 0.2539130434782609
cost: 3762.4154439528093


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
Adjusting stage:  3
valid_strategies: [(4, 2), (4, 2), (4, 2), (4, 2)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 32, gbs: 128, strategies: [(4, 2), (4, 2), (4, 2), (4, 2)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2176.353096961975, fb_sync_cost: 1004.2289733886719, parameter_upate_costs: 4.385414123535156, dp_cost: 15.554793648097826, pp_cost: 0.2539130434782609
cost: 3231.9636301306023


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=16, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 16, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 1949.379026889801, fb_sync_cost: 896.5316772460938, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 0.2539130434782609
cost: 2906.823683421094


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=8, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 8, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2225.6237268447876, fb_sync_cost: 864.5465850830078, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 0.5078260869565218
cost: 3143.5403445152615


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=4, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.11111111111111113, 0.11111111111111113, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 4, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2755.7079792022705, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 1.0156521739130435
cost: 3642.85037950267


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=2, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.11111111111111113, 0.11111111111111113, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 2, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 3864.1486167907715, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 2.031304347826087
cost: 4750.357454329781


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=1, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.11111111111111113, 0.11111111111111113, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 1, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 6081.029891967773, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 4.062608695652174
cost: 6968.295426386957


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.1111111111111111, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [71241.99900000001, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 4658.509373664856, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 6937.866238829572


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.09293012755243117, 0.05669186702797304, 0.05669186702797304, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 0.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [71241.99900000001, 65535.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
execution_cost: 3912.4066829681396, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5078260869565218
cost: 5992.114081245091


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
valid_strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.0979877935727841, 0.05637576290170098, 0.05637576290170098, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 0.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [71241.99900000001, 65535.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
execution_cost: 3545.354723930359, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5078260869565218
cost: 5393.020878861469


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11083249740828256, 0.05557296891198234, 0.05557296891198234, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [71241.99900000001, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 3754.4767260551453, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 0.9356521739130435
cost: 5524.364955438531


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11009614959318087, 0.055618990650426206, 0.055618990650426206, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 0.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [71241.99900000001, 65535.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
execution_cost: 4172.521114349365, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 1.871304347826087
cost: 5880.780908992602


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11111111111111113, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [71241.99900000001, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 5076.57790184021, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 3.742608695652174
cost: 6782.810570960667


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11111111111111113, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [71241.99900000001, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 6889.316082000732, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 7.485217391304348
cost: 8597.342144881539


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11111111111111113, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [71241.99900000001, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 10514.792442321777, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 14.970434782608695
cost: 12229.329115126237


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.1111111111111111, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 110341.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 4660.305559635162, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 6939.662424799878


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05669186702797304, 0.09293012755243117, 0.05669186702797304, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 110341.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3912.883162498474, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5078260869565218
cost: 5992.590560775426


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05637576290170098, 0.0979877935727841, 0.05637576290170098, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 110341.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3542.2980785369873, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5078260869565218
cost: 5389.9642334680975


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05557296891198234, 0.11083249740828256, 0.05557296891198234, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 110341.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3755.6633353233337, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.9356521739130435
cost: 5524.193412532806


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055618990650426206, 0.11009614959318087, 0.055618990650426206, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 110341.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 4174.1591691970825, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 1.871304347826087
cost: 5881.060811666406


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.11111111111111113, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 110341.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 5080.414772033691, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 3.742608695652174
cost: 6785.289288980235


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.11111111111111113, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 110341.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 6896.989822387695, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 7.485217391304348
cost: 8603.657733094587


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.11111111111111113, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 110341.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 10530.139923095703, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 14.970434782608695
cost: 12243.318443726248


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.1111111111111111, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 110341.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 4660.305559635162, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 6939.662424799878


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05669186702797304, 0.05669186702797304, 0.09293012755243117, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 110341.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3912.883162498474, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5078260869565218
cost: 5992.590560775426


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
valid_strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05637576290170098, 0.05637576290170098, 0.0979877935727841, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 110341.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3542.2980785369873, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5078260869565218
cost: 5389.9642334680975


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05557296891198234, 0.05557296891198234, 0.11083249740828256, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 110341.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3755.6633353233337, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.928695652173913
cost: 5524.186456011067


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055618990650426206, 0.055618990650426206, 0.11009614959318087, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 110341.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 4174.1591691970825, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 1.857391304347826
cost: 5881.046898622927


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.11111111111111113, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 110341.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 5080.414772033691, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 3.714782608695652
cost: 6785.261462893279


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.11111111111111113, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 110341.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 6896.989822387695, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 7.429565217391304
cost: 8603.602080920675


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.11111111111111113, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 110341.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 10530.139923095703, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 14.859130434782609
cost: 12243.207139378423


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.06451612903225806, 0.06451612903225806, 0.06451612903225806, 0.12903225806451613, 0.22580645161290322, 0.22580645161290322, 0.22580645161290322]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 372485.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [1]
execution_cost: 4685.8479380607605, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 6965.204803225476


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.060373270920337174, 0.060373270920337174, 0.060373270920337174, 0.1849608425754481, 0.21130644822118014, 0.21130644822118014, 0.21130644822118014]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 372485.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [0, 2]
execution_cost: 3938.3918046951294, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5078260869565218
cost: 6018.099202972081


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.059931551433817495, 0.059931551433817495, 0.059931551433817495, 0.19092405564346362, 0.20976043001836125, 0.20976043001836125, 0.20976043001836125]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 41460.001000000004, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 351755.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [0, 0, 2, 2]
execution_cost: 3589.377224445343, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5078260869565218
cost: 5437.043379376453


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.058823529411764705, 0.058823529411764705, 0.058823529411764705, 0.2058823529411765, 0.2058823529411765, 0.2058823529411765, 0.2058823529411765]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 82920.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 310295.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [0, 0, 0, 0, 2, 2, 2, 2]
execution_cost: 3858.4072589874268, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.928695652173913
cost: 5626.93037967516


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05731389355343146, 0.05731389355343146, 0.05731389355343146, 0.2262624370286755, 0.20059862743701007, 0.20059862743701007, 0.20059862743701007]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 248760.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 144455.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [1, 1, 1, 1, 3, 3, 3, 3]
execution_cost: 4362.829506397247, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 1.857391304347826
cost: 6069.717235823092


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05727724283941197, 0.05727724283941197, 0.05727724283941197, 0.22675722166793852, 0.20047034993794186, 0.20047034993794186, 0.20047034993794186]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 248760.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 144455.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [2, 2, 2, 2, 6, 6, 6, 6]
execution_cost: 5461.28523349762, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 3.714782608695652
cost: 7166.131924357207


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05714285714285715, 0.05714285714285715, 0.05714285714285715, 0.2285714285714286, 0.19999999999999998, 0.19999999999999998, 0.19999999999999998]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 248760.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 144455.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [4, 4, 4, 4, 12, 12, 12, 12]
execution_cost: 7654.666900634766, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 7.429565217391304
cost: 9361.279159167745


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05562468255168519, 0.05562468255168519, 0.05562468255168519, 0.24906678555225004, 0.19468638893089815, 0.19468638893089815, 0.19468638893089815]
layer_partition: [0, 1, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 995040.0009999999, 41460.001, 20730.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, -601824.0009999999, 286219.999, 306949.999, 246289.999]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(2): [0.07258544601230758, 0.0713290931633726, 0.07016580348843279, 0.0885827107898773, 0.24181039196665424, 0.22959305784627304, 0.22054318072006474]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 0.001, 20730.001, 497520.001, 41460.001, 41460.001, 81390.001]
memory_state: [5705.999000000003, 65535.999, 44805.998999999996, -104304.00099999999, 286219.999, 286219.999, 246289.999]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(3): [0.07463414759638551, 0.07318104575472333, 0.07184413152006872, 0.06301038193911154, 0.24714643507757697, 0.2333073127607782, 0.22320691460486516]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 0.001, 20730.001, 497520.001, 41460.001, 41460.001, 81390.001]
memory_state: [5705.999000000003, 65535.999, 44805.998999999996, -104304.00099999999, 286219.999, 286219.999, 246289.999]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(4): [0.07610449096290621, 0.07450622467794062, 0.07304198826013865, 0.04482035147389525, 0.2509464738945699, 0.2359343605720928, 0.22508515899710424]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05679155767217861, 0.05679155767217861, 0.05679155767217861, 0.2333139714255888, 0.1987704518526251, 0.1987704518526251, 0.1987704518526251]
layer_partition: [0, 1, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 497520.001, 41460.001, 20730.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, -104304.00099999999, 286219.999, 306949.999, 246289.999]
MEMORY EXCEEDED
TESTING NEW PARTITION
adj_stage_compute_performance(2): [0.06339046749643745, 0.06290165936130716, 0.06244905923618653, 0.16596017800955884, 0.21710494766191002, 0.21235155985950283, 0.20883053185771971]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 248760.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 144455.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [14, 14, 50, 50]
execution_cost: 12020.796537399292, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 16.250434782608696
cost: 13735.255058029838
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05845523080457212, 0.05845523080457212, 0.05845523080457212, 0.21085438413827656, 0.20459330781600238, 0.20459330781600238, 0.20459330781600238]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 124380.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 268835.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [28, 100]
execution_cost: 12125.129699707031, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 19.033043478260865
cost: 13842.370829033229


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 4), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.3888888888888889, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 62190.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 593169.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 4662.859797477722, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5008695652173913
cost: 6942.209706120699


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.34278333506180053, 0.20911439338942708, 0.20911439338942708]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 62190.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 593169.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 3916.1936044692993, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5008695652173913
cost: 5995.894046224512


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.35610071657121584, 0.20487704472734042, 0.20487704472734042]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 62190.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 593169.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 3548.6331582069397, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5008695652173913
cost: 5396.292356616311


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.3882179489171987, 0.1946579253445277, 0.1946579253445277]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 62190.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 593169.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 3770.3410387039185, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 0.9147826086956522
cost: 5544.548897703419


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.3864396461789041, 0.19522374894307593, 0.19522374894307593]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 62190.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 593169.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 4203.010320663452, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 1.8295652173913044
cost: 5915.568875357586


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.3888888888888889, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 62190.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 593169.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 5138.697624206543, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 3.659130434782609
cost: 6849.187314247463


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.3888888888888889, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 62190.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 593169.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 7013.555526733398, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 7.318260869565218
cost: 8725.7551322738


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.3888888888888889, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 62190.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 593169.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 10763.27133178711, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 14.636521739130435
cost: 12481.814590729424


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 4), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 4), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (2, 2)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.3888888888888889, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 62190.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 593169.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 4662.859797477722, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5008695652173913
cost: 6942.209706120699


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.20911439338942708, 0.34278333506180053, 0.20911439338942708]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 62190.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 593169.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 3916.1936044692993, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5008695652173913
cost: 5995.894046224512


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.20487704472734042, 0.35610071657121584, 0.20487704472734042]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 62190.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 593169.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 3548.6331582069397, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5008695652173913
cost: 5396.292356616311


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.1946579253445277, 0.3882179489171987, 0.1946579253445277]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 62190.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 593169.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 3770.3410387039185, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 0.9147826086956521
cost: 5544.548897703419


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.19522374894307593, 0.3864396461789041, 0.19522374894307593]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 62190.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 593169.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 4203.010320663452, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 1.8295652173913042
cost: 5915.568875357586


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.3888888888888889, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 62190.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 593169.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 5138.697624206543, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 3.6591304347826084
cost: 6849.187314247463


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.3888888888888889, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 62190.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 593169.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 7013.555526733398, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 7.318260869565217
cost: 8725.7551322738


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.3888888888888889, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 62190.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 593169.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 10763.27133178711, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 14.636521739130433
cost: 12481.814590729424


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 4)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 4)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 4)]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.3888888888888889]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 122850.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 4662.690997123718, fb_sync_cost: 1076.50146484375, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5008695652173913
cost: 5865.539440922945


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2)]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.20911439338942708, 0.20911439338942708, 0.34278333506180053]
layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 20730.001, 122850.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 306949.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)], layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
execution_cost: 3916.178345680237, fb_sync_cost: 1076.50146484375, parameter_upate_costs: 2.192707061767578, dp_cost: 5.184931216032608, pp_cost: 0.5008695652173913
cost: 5062.933196296693


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.20487704472734042, 0.20487704472734042, 0.35610071657121584]
layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 20730.001, 122850.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 306949.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
execution_cost: 3548.5759377479553, fb_sync_cost: 1004.2289733886719, parameter_upate_costs: 4.385414123535156, dp_cost: 15.554793648097826, pp_cost: 0.5008695652173913
cost: 4604.433427438322


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.1946579253445277, 0.1946579253445277, 0.3882179489171987]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 122850.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 3770.095467567444, fb_sync_cost: 896.5316772460938, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 1.0017391304347827
cost: 4728.287950185692


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.19522374894307593, 0.19522374894307593, 0.3864396461789041]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 122850.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 4202.59952545166, fb_sync_cost: 864.5465850830078, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 2.0034782608695654
cost: 5122.011795296047


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.3888888888888889]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 122850.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 5137.631177902222, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 4.006956521739131
cost: 6027.764882550447


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.3888888888888889]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 122850.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 7011.422634124756, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 8.013913043478261
cost: 7903.614080359417


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.3888888888888889]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 122850.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 10759.005546569824, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 16.027826086956523
cost: 11658.236298380312


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  7
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
Adjusting stage:  7
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 4678.185224533081, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5878260869565217
cost: 6957.622089697797


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
Adjusting stage:  7
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 3936.0562562942505, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5878260869565217
cost: 6015.843654571202


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=32, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 3586.643636226654, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5878260869565217
cost: 5434.389791157764


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 3858.4072589874268, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 1.1756521739130434
cost: 5627.1773361969


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 4376.11722946167, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 2.351304347826087
cost: 6083.498871930993


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 5488.394737243652, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 4.702608695652174
cost: 7194.229254190196


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 7712.949752807617, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 9.405217391304348
cost: 9421.53766351451


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 12162.059783935547, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 18.810434782608695
cost: 13879.078304566092
Average time: 107.24401473999023 ms
len(costs): 183
rank, cost, node_sequence, device_groups, strategies(dp_deg, tp_deg), batches(number of batch), layer_partition
1, 1793.600994348526, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(1, 32)], 1, [0, 10]
2, 1794.5756018161774, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(1, 32)], 2, [0, 10]
3, 1796.52481675148, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(1, 32)], 4, [0, 10]
4, 2371.990484237671, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 8, [0, 3, 10]
5, 2396.9674170017242, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(1, 32)], 128, [0, 10]
6, 2524.9896283357043, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 4, [0, 3, 10]
7, 2606.949979284535, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(8, 2), (8, 2)], 16, [0, 3, 10]
8, 2674.8818959567857, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(2, 16)], 8, [0, 10]
9, 2838.770232739656, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 2, [0, 3, 10]
10, 2906.823683421094, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 16, [0, 2, 3, 6, 10]
11, 3041.1697479123654, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(2, 8), (2, 8)], 64, [0, 3, 10]
12, 3051.0523798154745, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(4, 4), (4, 4)], 32, [0, 3, 10]
13, 3083.0095904080763, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(1, 16), (1, 16)], 128, [0, 3, 10]
14, 3140.7196159362793, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 1, [0, 3, 10]
15, 3141.6942234039307, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 2, [0, 3, 10]
16, 3143.5403445152615, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 8, [0, 2, 3, 6, 10]
17, 3208.941661834717, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 4, [0, 3, 10]
18, 3231.9636301306023, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(4, 2), (4, 2), (4, 2), (4, 2)], 32, [0, 2, 3, 6, 10]
19, 3272.3888511657715, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 8, [0, 3, 10]
20, 3474.7658491549287, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(8, 4)], 16, [0, 10]
21, 3475.1509326022606, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(4, 8)], 32, [0, 10]
22, 3495.9186335024624, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(16, 1), (16, 1)], 8, [0, 7, 10]
23, 3498.734053549559, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(2, 16)], 64, [0, 10]
24, 3538.604123737501, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 1, [0, 3, 10]
25, 3606.029136243074, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(16, 1), (16, 1)], 4, [0, 7, 10]
26, 3642.85037950267, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 4, [0, 2, 3, 6, 10]
27, 3740.540435409546, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(8, 2), (8, 2)], 16, [0, 3, 10]
28, 3762.4154439528093, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(2, 4), (2, 4), (2, 4), (2, 4)], 64, [0, 2, 3, 6, 10]
29, 3769.80971777294, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(1, 8), (1, 8), (1, 8), (1, 8)], 128, [0, 2, 3, 6, 10]
30, 3817.704299512117, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(8, 2), (8, 2)], 16, [0, 7, 10]
31, 3885.0449739539104, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(16, 1), (16, 1)], 2, [0, 7, 10]
32, 4309.996341187021, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(2, 8), (2, 8)], 64, [0, 7, 10]
33, 4320.223347498023, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(4, 4), (4, 4)], 32, [0, 7, 10]
34, 4325.970158958435, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(4, 4), (4, 4)], 32, [0, 3, 10]
35, 4351.6639964787855, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(1, 16), (1, 16)], 128, [0, 7, 10]
36, 4352.530254650116, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(2, 8), (2, 8)], 64, [0, 3, 10]
37, 4412.591460943222, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(1, 16), (1, 16)], 128, [0, 3, 10]
38, 4584.908667274143, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(16, 1), (16, 1)], 1, [0, 7, 10]
39, 4604.433427438322, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], 32, [0, 1, 2, 3, 3, 5, 6, 10]
40, 4728.287950185692, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 16, [0, 1, 2, 3, 3, 4, 6, 10]
41, 4750.357454329781, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 2, [0, 2, 3, 6, 10]
42, 5062.933196296693, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)], 64, [0, 1, 2, 3, 3, 5, 6, 10]
43, 5122.011795296047, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 8, [0, 1, 2, 3, 3, 4, 6, 10]
44, 5154.801030007237, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 16, [0, 4, 7, 8, 10]
45, 5305.646948303554, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 8, [0, 4, 7, 8, 10]
46, 5389.9642334680975, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 4, 6, 8, 10]
47, 5389.9642334680975, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 4, 6, 8, 10]
48, 5393.020878861469, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 2, 2, 3, 4, 6, 8, 10]
49, 5396.292356616311, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 3, 6, 8, 10]
50, 5396.292356616311, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)], 32, [0, 1, 2, 3, 3, 5, 8, 10]
51, 5434.389791157764, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 3, 4, 6, 8, 10]
52, 5437.043379376453, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 4, 6, 8, 10]
53, 5524.186456011067, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 4, 6, 8, 10]
54, 5524.193412532806, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 4, 6, 8, 10]
55, 5524.364955438531, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 3, 3, 4, 6, 8, 10]
56, 5544.548897703419, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 3, 6, 8, 10]
57, 5544.548897703419, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 16, [0, 1, 2, 3, 3, 5, 8, 10]
58, 5626.93037967516, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 4, 6, 8, 10]
59, 5627.1773361969, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 3, 4, 6, 8, 10]
60, 5652.662686009614, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(4, 2), (4, 2), (4, 2), (4, 2)], 32, [0, 4, 7, 8, 10]
61, 5735.370229445747, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 4, [0, 4, 7, 8, 10]
62, 5865.539440922945, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)], 128, [0, 1, 2, 3, 3, 4, 6, 10]
63, 5880.780908992602, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 2, 2, 3, 4, 6, 8, 10]
64, 5881.046898622927, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 4, 6, 8, 10]
65, 5881.060811666406, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 4, 6, 8, 10]
66, 5915.568875357586, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 3, 6, 8, 10]
67, 5915.568875357586, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 8, [0, 1, 2, 3, 3, 5, 8, 10]
68, 5992.114081245091, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 2, 3, 4, 6, 8, 10]
69, 5992.590560775426, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 4, 6, 8, 10]
70, 5992.590560775426, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 4, 6, 8, 10]
71, 5995.894046224512, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 3, 6, 8, 10]
72, 5995.894046224512, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 64, [0, 1, 2, 3, 3, 5, 8, 10]
73, 6015.843654571202, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 3, 4, 6, 8, 10]
74, 6018.099202972081, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 4, 6, 8, 10]
75, 6027.764882550447, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 4, [0, 1, 2, 3, 3, 4, 6, 10]
76, 6069.717235823092, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 4, 6, 8, 10]
77, 6083.498871930993, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 3, 4, 6, 8, 10]
78, 6300.06863050212, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(2, 4), (2, 4), (2, 4), (2, 4)], 64, [0, 4, 7, 8, 10]
79, 6307.118529914358, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(1, 8), (1, 8), (1, 8), (1, 8)], 128, [0, 4, 7, 8, 10]
80, 6782.810570960667, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 2, 3, 3, 4, 6, 8, 10]
81, 6785.261462893279, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 4, 6, 8, 10]
82, 6785.289288980235, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 4, 6, 8, 10]
83, 6842.907106595247, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 2, [0, 4, 7, 8, 10]
84, 6849.187314247463, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 3, 6, 8, 10]
85, 6849.187314247463, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 4, [0, 1, 2, 3, 3, 5, 8, 10]
86, 6933.608447984612, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 16, [0, 2, 4, 6, 7, 8, 8, 10]
87, 6937.866238829572, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 2, 3, 3, 4, 6, 8, 10]
88, 6939.662424799878, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 4, 6, 8, 10]
89, 6939.662424799878, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 4, 6, 8, 10]
90, 6942.209706120699, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 3, 6, 8, 10]
91, 6942.209706120699, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)], 128, [0, 1, 2, 3, 3, 5, 8, 10]
92, 6957.622089697797, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 3, 4, 6, 8, 10]
93, 6965.204803225476, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 4, 6, 8, 10]
94, 6968.295426386957, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 1, [0, 2, 3, 6, 10]
95, 7091.786093539363, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], 32, [0, 3, 4, 6, 8, 8, 9, 10]
96, 7166.131924357207, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 4, 6, 8, 10]
97, 7194.229254190196, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 3, 4, 6, 8, 10]
98, 7232.653916309191, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 8, [0, 2, 4, 6, 7, 8, 8, 10]
99, 7734.502889046047, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)], 64, [0, 3, 4, 6, 8, 8, 9, 10]
100, 7903.614080359417, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 2, [0, 1, 2, 3, 3, 4, 6, 10]
101, 8038.830461440708, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 4, [0, 2, 4, 6, 7, 8, 8, 10]
102, 8427.452949931932, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)], 32, [0, 2, 4, 6, 8, 8, 9, 10]
103, 8428.372949931932, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], 32, [0, 2, 4, 6, 8, 9, 9, 10]
104, 8552.101842638927, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)], 128, [0, 2, 4, 6, 7, 8, 8, 10]
105, 8597.342144881539, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 2, 3, 3, 4, 6, 8, 10]
106, 8603.602080920675, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 4, 6, 8, 10]
107, 8603.657733094587, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 4, 6, 8, 10]
108, 8725.7551322738, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 3, 6, 8, 10]
109, 8725.7551322738, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 2, [0, 1, 2, 3, 3, 5, 8, 10]
110, 9060.9046832972, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 1, [0, 4, 7, 8, 10]
111, 9361.279159167745, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 4, 6, 8, 10]
112, 9421.53766351451, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 3, 4, 6, 8, 10]
113, 9509.881714109337, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 64, [0, 2, 4, 6, 8, 8, 9, 10]
114, 9510.301714109337, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)], 64, [0, 2, 4, 6, 8, 9, 9, 10]
115, 9804.413219521564, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 6, 8, 8, 9, 10]
116, 9847.91475591162, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 16, [0, 2, 4, 6, 7, 8, 9, 10]
117, 9848.834755911621, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 5, 7, 8, 9, 10]
118, 9849.887435367418, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 32, [0, 2, 4, 6, 8, 8, 9, 10]
119, 9853.637331877997, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 2, [0, 2, 4, 6, 7, 8, 8, 10]
120, 9869.190368459951, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 7, 8, 8, 9, 10]
121, 9871.97802980506, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 3, 6, 7, 8, 8, 9, 10]
122, 9875.723594500501, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 4, 6, 7, 8, 8, 8, 9]
123, 9877.817531171882, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 2, 4, 7, 8, 8, 8, 9]
124, 9885.310348650062, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 4, 6, 7, 8, 8, 9, 10]
125, 9886.303971249954, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 3, 6, 7, 8, 8, 8, 9]
126, 9918.270245559526, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 2, 4, 6, 7, 8, 8, 9, 10]
127, 9951.818679575714, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 6, 7, 8, 8, 9, 10]
128, 9973.744506767936, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 8, [0, 2, 4, 6, 8, 8, 9, 10]
129, 9976.20963933613, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 3, 5, 7, 8, 8, 9, 10]
130, 10068.64103596563, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 8, [0, 2, 4, 6, 7, 8, 9, 10]
131, 10070.48103596563, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 8, [0, 2, 4, 5, 7, 8, 9, 10]
132, 10104.989227034528, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 2, 4, 7, 8, 8, 9, 10]
133, 10107.776888379636, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 3, 6, 7, 8, 8, 9, 10]
134, 10120.980222773345, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 4, 6, 7, 8, 8, 9, 10]
135, 10272.919096230216, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 2, 4, 6, 7, 8, 8, 9, 10]
136, 10765.460645901225, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 4, [0, 2, 4, 6, 8, 8, 8, 9]
137, 10784.815561200017, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 3, 5, 7, 8, 8, 9, 10]
138, 10974.63500747349, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 4, [0, 2, 4, 6, 7, 8, 9, 10]
139, 10978.31500747349, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 4, [0, 2, 4, 5, 7, 8, 9, 10]
140, 10997.880813840782, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 4, 6, 8, 8, 9, 10]
141, 11014.30947198785, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 4, 6, 7, 8, 8, 9, 10]
142, 11015.43469697206, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 5, 7, 8, 8, 9, 10]
143, 11015.43469697206, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 4, 7, 8, 8, 9, 10]
144, 11035.384305318748, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 4, 6, 7, 8, 8, 9, 10]
145, 11042.213160118436, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 2, 4, 7, 8, 8, 9, 10]
146, 11045.000821463544, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 3, 6, 7, 8, 8, 9, 10]
147, 11057.57592290132, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 4, 6, 7, 8, 8, 9, 10]
148, 11387.254972683451, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 2, 4, 6, 7, 8, 8, 9, 10]
149, 11658.236298380312, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 1, [0, 1, 2, 3, 3, 4, 6, 10]
150, 12229.329115126237, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 2, 3, 3, 4, 6, 8, 10]
151, 12243.207139378423, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 4, 6, 8, 10]
152, 12243.318443726248, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 4, 6, 8, 10]
153, 12296.27802777, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)], 128, [0, 2, 4, 5, 8, 8, 8, 9]
154, 12320.492770831066, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)], 128, [0, 2, 4, 6, 7, 8, 9, 10]
155, 12320.617770831066, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)], 128, [0, 2, 4, 5, 7, 8, 9, 10]
156, 12322.651856160372, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 4, 6, 7, 8, 8, 9, 10]
157, 12323.165052151888, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 2, 4, 7, 8, 8, 9, 10]
158, 12323.71322891733, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 3, 6, 7, 8, 8, 9, 10]
159, 12338.577435728985, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 2, 4, 6, 7, 8, 8, 9, 10]
160, 12393.409187625388, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 2, [0, 3, 5, 7, 8, 8, 9, 10]
161, 12404.345262670102, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 3, 5, 7, 8, 8, 9, 10]
162, 12421.821492462159, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)], 2, [0, 2, 4, 6, 8, 8, 9, 10]
163, 12481.814590729424, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 6, 8, 10]
164, 12481.814590729424, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 5, 8, 10]
165, 12796.534439975905, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 2, [0, 2, 4, 6, 7, 8, 9, 10]
166, 12803.894439975904, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 2, [0, 2, 4, 5, 7, 8, 9, 10]
167, 12925.991966532833, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 2, 4, 7, 8, 8, 9, 10]
168, 12928.77962787794, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 3, 6, 7, 8, 8, 9, 10]
169, 12940.258480689008, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 4, 6, 7, 8, 8, 9, 10]
170, 13486.174895155533, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 1, [0, 2, 4, 6, 7, 8, 8, 10]
171, 13621.774370395826, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 2, 4, 6, 7, 8, 8, 9, 10]
172, 13735.255058029838, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 4, 6, 8, 10]
173, 13842.370829033229, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 4, 6, 8, 10]
174, 13879.078304566092, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 4, 6, 8, 10]
175, 15627.086094851287, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 1, [0, 3, 5, 7, 8, 8, 9, 10]
176, 15688.785341548091, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)], 1, [0, 2, 4, 6, 8, 8, 9, 10]
177, 16443.257127383687, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 1, [0, 2, 4, 6, 7, 8, 9, 10]
178, 16457.977127383685, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 1, [0, 2, 4, 5, 7, 8, 9, 10]
179, 16696.47340176458, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 2, 4, 7, 8, 8, 9, 10]
180, 16699.261063109687, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 3, 6, 7, 8, 8, 9, 10]
181, 16708.54741866734, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 4, 6, 7, 8, 8, 9, 10]
182, 18093.73698822353, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 2, 4, 6, 7, 8, 8, 9, 10]
183, 18098.272123953775, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 3, 5, 7, 7, 8, 9, 10]
