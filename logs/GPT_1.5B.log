{'DeviceType.A100': {'tp32_bs32': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs4': {'time': {'layer-computes': [2.507448196411133, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 63.25173377990723, 0.6699562072753906], 'fb_sync': 102.50520706176758}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp8_bs8': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs2': {'time': {'layer-computes': [0.45746564865112305, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 4.793345928192139, 0.10097026824951172], 'fb_sync': 6.075316667556763}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp32_bs4': {'time': {'layer-computes': [0.368654727935791, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 0.08487701416015625], 'fb_sync': 5.634516477584839}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp4_bs64': {'time': {'layer-computes': [47.18780517578125, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 10.8642578125], 'fb_sync': 721.2181091308594}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs4': {'time': {'layer-computes': [0.09216368198394775, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 1.1194944381713867, 0.021219253540039062], 'fb_sync': 1.4086291193962097}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs8': {'time': {'layer-computes': [5.014896392822266, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 126.50346755981445, 1.3399124145507812], 'fb_sync': 205.01041412353516}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp1_bs1': {'time': {'layer-computes': [0.2892017364501953, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 29.507994651794434, 0.4100799560546875], 'fb_sync': 56.03322982788086}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp8_bs4': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs128': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs32': {'time': {'layer-computes': [20.059585571289062, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 506.0138702392578, 5.359649658203125], 'fb_sync': 820.0416564941406}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp32_bs8': {'time': {'layer-computes': [0.737309455871582, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 0.1697540283203125], 'fb_sync': 11.269032955169678}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs32': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs8': {'time': {'layer-computes': [0.1843273639678955, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 0.042438507080078125], 'fb_sync': 2.8172582387924194}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs64': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs64': {'time': {'layer-computes': [40.119171142578125, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 1012.0277404785156, 10.71929931640625], 'fb_sync': 1640.0833129882812}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp64_bs1': {'time': {'layer-computes': [0.06414949893951416, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.6385594606399536, 0.02110004425048828], 'fb_sync': 1.0512709617614746}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp4_bs2': {'time': {'layer-computes': [1.8298625946044922, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 19.173383712768555, 0.4038810729980469], 'fb_sync': 24.30126667022705}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp4_bs32': {'time': {'layer-computes': [23.593902587890625, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 5.43212890625], 'fb_sync': 360.6090545654297}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs128': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs64': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp8_bs2': {'time': {'layer-computes': [0.9149312973022461, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 9.586691856384277, 0.20194053649902344], 'fb_sync': 12.150633335113525}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp128_bs64': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs8': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs128': {'time': {'layer-computes': [35.0799560546875, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 3730.1025390625, 34.12628173828125], 'fb_sync': 6697.303771972656}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp2_bs2': {'time': {'layer-computes': [1.7201900482177734, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 32.2415828704834, 0.469207763671875], 'fb_sync': 53.24146747589111}, 'memory': [4279, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 8833]}, 'tp16_bs4': {'time': {'layer-computes': [0.737309455871582, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 0.1697540283203125], 'fb_sync': 11.269032955169678}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs16': {'time': {'layer-computes': [4.3849945068359375, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 466.2628173828125, 4.265785217285156], 'fb_sync': 837.162971496582}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp8_bs64': {'time': {'layer-computes': [23.593902587890625, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 5.43212890625], 'fb_sync': 360.6090545654297}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs2': {'time': {'layer-computes': [0.22873282432556152, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 2.3966729640960693, 0.05048513412475586], 'fb_sync': 3.0376583337783813}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp128_bs2': {'time': {'layer-computes': [0.05718320608139038, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.5991682410240173, 0.012621283531188965], 'fb_sync': 0.7594145834445953}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp4_bs4': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp4_bs128': {'time': {'layer-computes': [94.3756103515625, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 1146.3623046875, 21.728515625], 'fb_sync': 1442.4362182617188}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp8_bs32': {'time': {'layer-computes': [11.796951293945312, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 2.716064453125], 'fb_sync': 180.30452728271484}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs16': {'time': {'layer-computes': [2.949237823486328, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 35.823822021484375, 0.67901611328125], 'fb_sync': 45.07613182067871}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp4_bs8': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs32': {'time': {'layer-computes': [0.737309455871582, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 0.1697540283203125], 'fb_sync': 11.269032955169678}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs16': {'time': {'layer-computes': [1.474618911743164, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 17.911911010742188, 0.339508056640625], 'fb_sync': 22.538065910339355}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs4': {'time': {'layer-computes': [0.1843273639678955, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 2.2389888763427734, 0.042438507080078125], 'fb_sync': 2.8172582387924194}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs128': {'time': {'layer-computes': [23.593902587890625, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 286.590576171875, 5.43212890625], 'fb_sync': 360.6090545654297}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs8': {'time': {'layer-computes': [0.368654727935791, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 0.08487701416015625], 'fb_sync': 5.634516477584839}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs16': {'time': {'layer-computes': [10.029792785644531, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 253.0069351196289, 2.6798248291015625], 'fb_sync': 410.0208282470703}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp64_bs16': {'time': {'layer-computes': [0.737309455871582, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 8.955955505371094, 0.1697540283203125], 'fb_sync': 11.269032955169678}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs8': {'time': {'layer-computes': [2.1924972534179688, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 233.13140869140625, 2.132892608642578], 'fb_sync': 418.581485748291}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp2_bs1': {'time': {'layer-computes': [1.1625289916992188, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 16.83783531188965, 0.3528594970703125], 'fb_sync': 31.382155418395996}, 'memory': [4378, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 6232]}, 'tp32_bs1': {'time': {'layer-computes': [0.12829899787902832, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 1.2771189212799072, 0.04220008850097656], 'fb_sync': 2.102541923522949}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp128_bs1': {'time': {'layer-computes': [0.03207474946975708, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.3192797303199768, 0.01055002212524414], 'fb_sync': 0.5256354808807373}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp4_bs16': {'time': {'layer-computes': [11.796951293945312, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 2.716064453125], 'fb_sync': 180.30452728271484}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs4': {'time': {'layer-computes': [1.0962486267089844, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 116.56570434570312, 1.066446304321289], 'fb_sync': 209.2907428741455}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp8_bs1': {'time': {'layer-computes': [0.5131959915161133, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 5.108475685119629, 0.16880035400390625], 'fb_sync': 8.410167694091797}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp2_bs128': {'time': {'layer-computes': [80.23834228515625, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 2024.0554809570312, 21.4385986328125], 'fb_sync': 3280.1666259765625}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp4_bs1': {'time': {'layer-computes': [1.0263919830322266, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 10.216951370239258, 0.3376007080078125], 'fb_sync': 16.820335388183594}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp1_bs32': {'time': {'layer-computes': [8.769989013671875, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 932.525634765625, 8.531570434570312], 'fb_sync': 1674.325942993164}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp8_bs128': {'time': {'layer-computes': [47.18780517578125, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 573.18115234375, 10.8642578125], 'fb_sync': 721.2181091308594}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs64': {'time': {'layer-computes': [11.796951293945312, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 2.716064453125], 'fb_sync': 180.30452728271484}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs128': {'time': {'layer-computes': [11.796951293945312, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 143.2952880859375, 2.716064453125], 'fb_sync': 180.30452728271484}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs2': {'time': {'layer-computes': [0.11436641216278076, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 1.1983364820480347, 0.02524256706237793], 'fb_sync': 1.5188291668891907}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp1_bs2': {'time': {'layer-computes': [0.6282329559326172, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 58.86340141296387, 0.6556510925292969], 'fb_sync': 108.06832313537598}, 'memory': [8078, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 14554]}, 'tp8_bs16': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs64': {'time': {'layer-computes': [17.53997802734375, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 1865.05126953125, 17.063140869140625], 'fb_sync': 3348.651885986328}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp16_bs32': {'time': {'layer-computes': [5.898475646972656, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 71.64764404296875, 1.3580322265625], 'fb_sync': 90.15226364135742}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs1': {'time': {'layer-computes': [0.25659799575805664, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 2.5542378425598145, 0.08440017700195312], 'fb_sync': 4.205083847045898}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp128_bs16': {'time': {'layer-computes': [0.368654727935791, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 4.477977752685547, 0.08487701416015625], 'fb_sync': 5.634516477584839}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}}, 'model': {'optimizer_time': 21.92707061767578, 'num_layers': 10, 'batch_generator': 0.9746074676513672, 'parameters': [393216000, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 202383360, 393220096]}, 'DeviceType.V100': {'tp1_bs32': {'time': {'layer-computes': [30.694961547851562, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 3263.8397216796875, 29.860496520996094], 'fb_sync': 5860.140800476074}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp4_bs1': {'time': {'layer-computes': [3.592371940612793, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 35.7593297958374, 1.1816024780273438], 'fb_sync': 58.87117385864258}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp64_bs2': {'time': {'layer-computes': [0.40028244256973267, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 4.194177687168121, 0.08834898471832275], 'fb_sync': 5.315902084112167}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp16_bs32': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs1': {'time': {'layer-computes': [0.8980929851531982, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 8.93983244895935, 0.29540061950683594], 'fb_sync': 14.717793464660645}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp128_bs128': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs2': {'time': {'layer-computes': [2.19881534576416, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 206.02190494537354, 2.294778823852539], 'fb_sync': 378.2391309738159}, 'memory': [8078, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 4838.5, 14554]}, 'tp8_bs128': {'time': {'layer-computes': [165.15731811523438, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 38.02490234375], 'fb_sync': 2524.263381958008}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs64': {'time': {'layer-computes': [41.289329528808594, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 9.5062255859375], 'fb_sync': 631.065845489502}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs128': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp8_bs16': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs64': {'time': {'layer-computes': [61.389923095703125, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 6527.679443359375, 59.72099304199219], 'fb_sync': 11720.281600952148}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp128_bs64': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs128': {'time': {'layer-computes': [280.8341979980469, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 7084.194183349609, 75.03509521484375], 'fb_sync': 11480.583190917969}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp2_bs16': {'time': {'layer-computes': [35.10427474975586, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 885.5242729187012, 9.379386901855469], 'fb_sync': 1435.072898864746}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp64_bs8': {'time': {'layer-computes': [1.2902915477752686, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 0.2970695495605469], 'fb_sync': 19.720807671546936}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs1': {'time': {'layer-computes': [0.11226162314414978, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 1.1174790561199188, 0.03692507743835449], 'fb_sync': 1.8397241830825806}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp64_bs4': {'time': {'layer-computes': [0.6451457738876343, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 0.14853477478027344], 'fb_sync': 9.860403835773468}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs8': {'time': {'layer-computes': [7.673740386962891, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 815.9599304199219, 7.465124130249023], 'fb_sync': 1465.0352001190186}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp64_bs16': {'time': {'layer-computes': [2.580583095550537, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 0.5941390991210938], 'fb_sync': 39.44161534309387}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs1': {'time': {'layer-computes': [4.068851470947266, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 58.93242359161377, 1.2350082397460938], 'fb_sync': 109.83754396438599}, 'memory': [4378, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 2119.5, 6232]}, 'tp4_bs16': {'time': {'layer-computes': [41.289329528808594, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 9.5062255859375], 'fb_sync': 631.065845489502}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp8_bs1': {'time': {'layer-computes': [1.7961859703063965, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 17.8796648979187, 0.5908012390136719], 'fb_sync': 29.43558692932129}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp1_bs4': {'time': {'layer-computes': [3.8368701934814453, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 407.97996520996094, 3.7325620651245117], 'fb_sync': 732.5176000595093}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp32_bs1': {'time': {'layer-computes': [0.4490464925765991, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 4.469916224479675, 0.14770030975341797], 'fb_sync': 7.358896732330322}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}, 'tp32_bs16': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs32': {'time': {'layer-computes': [2.580583095550537, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 0.5941390991210938], 'fb_sync': 39.44161534309387}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp1_bs16': {'time': {'layer-computes': [15.347480773925781, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 1631.9198608398438, 14.930248260498047], 'fb_sync': 2930.070400238037}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp16_bs4': {'time': {'layer-computes': [2.580583095550537, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 0.5941390991210938], 'fb_sync': 39.44161534309387}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp8_bs2': {'time': {'layer-computes': [3.2022595405578613, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 33.55342149734497, 0.706791877746582], 'fb_sync': 42.52721667289734}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp16_bs128': {'time': {'layer-computes': [82.57865905761719, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 19.012451171875], 'fb_sync': 1262.131690979004}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs2': {'time': {'layer-computes': [0.8005648851394653, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 8.388355374336243, 0.1766979694366455], 'fb_sync': 10.631804168224335}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp8_bs64': {'time': {'layer-computes': [82.57865905761719, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 19.012451171875], 'fb_sync': 1262.131690979004}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs16': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp16_bs8': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs2': {'time': {'layer-computes': [6.020665168762207, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 112.8455400466919, 1.6422271728515625], 'fb_sync': 186.3451361656189}, 'memory': [4279, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 2607.5, 8833]}, 'tp4_bs128': {'time': {'layer-computes': [330.31463623046875, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 4012.26806640625, 76.0498046875], 'fb_sync': 5048.526763916016}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp4_bs4': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs2': {'time': {'layer-computes': [0.20014122128486633, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 2.0970888435840607, 0.04417449235916138], 'fb_sync': 2.6579510420560837}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp1_bs128': {'time': {'layer-computes': [122.77984619140625, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 13055.35888671875, 119.44198608398438], 'fb_sync': 23440.563201904297}, 'memory': [9078, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 6259, 26084]}, 'tp8_bs32': {'time': {'layer-computes': [41.289329528808594, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 9.5062255859375], 'fb_sync': 631.065845489502}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp4_bs8': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp8_bs8': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs4': {'time': {'layer-computes': [8.776068687438965, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 221.3810682296753, 2.344846725463867], 'fb_sync': 358.7682247161865}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp32_bs64': {'time': {'layer-computes': [20.644664764404297, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 250.76675415039062, 4.75311279296875], 'fb_sync': 315.532922744751}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs8': {'time': {'layer-computes': [2.580583095550537, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 31.345844268798828, 0.5941390991210938], 'fb_sync': 39.44161534309387}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs32': {'time': {'layer-computes': [70.20854949951172, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 1771.0485458374023, 18.758773803710938], 'fb_sync': 2870.145797729492}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp16_bs2': {'time': {'layer-computes': [1.6011297702789307, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 16.776710748672485, 0.353395938873291], 'fb_sync': 21.26360833644867}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp8_bs4': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs8': {'time': {'layer-computes': [17.55213737487793, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 442.7621364593506, 4.689693450927734], 'fb_sync': 717.536449432373}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp1_bs1': {'time': {'layer-computes': [1.0122060775756836, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 103.27798128128052, 1.4352798461914062], 'fb_sync': 196.116304397583}, 'memory': [7820, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 4146, 12132]}, 'tp4_bs64': {'time': {'layer-computes': [165.15731811523438, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 2006.134033203125, 38.02490234375], 'fb_sync': 2524.263381958008}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs4': {'time': {'layer-computes': [1.2902915477752686, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 0.2970695495605469], 'fb_sync': 19.720807671546936}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs64': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs128': {'time': {'layer-computes': [41.289329528808594, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 501.53350830078125, 9.5062255859375], 'fb_sync': 631.065845489502}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp4_bs32': {'time': {'layer-computes': [82.57865905761719, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 1003.0670166015625, 19.012451171875], 'fb_sync': 1262.131690979004}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs8': {'time': {'layer-computes': [0.6451457738876343, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 7.836461067199707, 0.14853477478027344], 'fb_sync': 9.860403835773468}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs32': {'time': {'layer-computes': [5.161166191101074, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 62.691688537597656, 1.1882781982421875], 'fb_sync': 78.88323068618774}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp2_bs64': {'time': {'layer-computes': [140.41709899902344, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 3542.0970916748047, 37.517547607421875], 'fb_sync': 5740.291595458984}, 'memory': [4174, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 4042, 11930]}, 'tp4_bs2': {'time': {'layer-computes': [6.404519081115723, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 67.10684299468994, 1.413583755493164], 'fb_sync': 85.05443334579468}, 'memory': [2681.25, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 1425.5, 4679.25]}, 'tp128_bs4': {'time': {'layer-computes': [0.32257288694381714, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 3.9182305335998535, 0.07426738739013672], 'fb_sync': 4.930201917886734}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp32_bs32': {'time': {'layer-computes': [10.322332382202148, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 125.38337707519531, 2.376556396484375], 'fb_sync': 157.7664613723755}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp128_bs16': {'time': {'layer-computes': [1.2902915477752686, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 15.672922134399414, 0.2970695495605469], 'fb_sync': 19.720807671546936}, 'memory': [2591.75, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 6305.75]}, 'tp64_bs1': {'time': {'layer-computes': [0.22452324628829956, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 2.2349581122398376, 0.07385015487670898], 'fb_sync': 3.679448366165161}, 'memory': [2257.25, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 1140.5, 3067.75]}}}


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=128, gbs=128)
invalid_strategy: dp_deg(32), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(16, 2)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 4)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 8)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 16)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(1, 32)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [72245.001]
memory_state: [1500618.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 128, gbs: 128, strategies: [(1, 32)], layer_partition: [0, 10]
data loadbalancer: [1]
execution_cost: 1329.5936584472656, fb_sync_cost: 941.9387817382812, parameter_upate_costs: 0.6852209568023682, dp_cost: 0.0, pp_cost: 0.0
cost: 2396.9674170017242


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=64, gbs=128)
invalid_strategy: dp_deg(32), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(16, 2)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 4)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 8)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(2, 16)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [93822.501]
memory_state: [1479041.499]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 64, gbs: 128, strategies: [(2, 16)], layer_partition: [0, 10]
data loadbalancer: [2, 0]
execution_cost: 2489.9330139160156, fb_sync_cost: 941.9387817382812, parameter_upate_costs: 1.3704419136047363, dp_cost: 3.1169380519701084, pp_cost: 0.0
cost: 3498.734053549559


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=32, gbs=128)
invalid_strategy: dp_deg(32), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(16, 2)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 4)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(4, 8)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [187645.001]
memory_state: [1385218.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 32, gbs: 128, strategies: [(4, 8)], layer_partition: [0, 10]
data loadbalancer: [2, 2, 0, 0]
execution_cost: 2489.9330139160156, fb_sync_cost: 941.9387817382812, parameter_upate_costs: 2.7408838272094727, dp_cost: 9.350814155910326, pp_cost: 0.0
cost: 3475.1509326022606


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=16, gbs=128)
invalid_strategy: dp_deg(32), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
sorted_stage_id:  [0]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(16, 2)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [375290.001]
memory_state: [1197573.999]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 16, gbs: 128, strategies: [(8, 4)], layer_partition: [0, 10]
data loadbalancer: [2, 2, 2, 2, 0, 0, 0, 0]
execution_cost: 2489.9330139160156, fb_sync_cost: 941.9387817382812, parameter_upate_costs: 5.481767654418945, dp_cost: 21.81856636379076, pp_cost: 0.0
cost: 3474.7658491549287


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=8, gbs=128)
invalid_strategy: dp_deg(32), batches(8), mbs(0)
DFS STEP
prev_strategies:  [(32, 1)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(16, 2)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1358880.001]
memory_state: [213983.99900000007]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 8, gbs: 128, strategies: [(16, 2)], layer_partition: [0, 10]
data loadbalancer: [2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0]
execution_cost: 2080.9764862060547, fb_sync_cost: 878.7003517150879, parameter_upate_costs: 10.96353530883789, dp_cost: 46.75407077955163, pp_cost: 0.0
cost: 3025.191303750743


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=4, gbs=128)
valid_strategies: [(32, 1)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [4907200.001]
memory_state: [-3334336.001]
MEMORY EXCEEDED
Failures: [0]
Number of failures: 1
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(32, 1)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(16, 2)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [3564160.001]
memory_state: [-1991296.0010000002]
MEMORY EXCEEDED
Failures: [0]
Number of failures: 1
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(16, 2)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1259250.001]
memory_state: [313613.99900000007]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 4, gbs: 128, strategies: [(8, 4)], layer_partition: [0, 10]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 2178.6913871765137, fb_sync_cost: 631.065845489502, parameter_upate_costs: 5.481767654418945, dp_cost: 21.81856636379076, pp_cost: 0.0
cost: 2840.955996554831


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=2, gbs=128)
valid_strategies: [(32, 1)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [13406400.001]
memory_state: [-11833536.001]
MEMORY EXCEEDED
Failures: [0]
Number of failures: 1
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(32, 1)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(16, 2)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [4655360.001]
memory_state: [-3082496.001]
MEMORY EXCEEDED
Failures: [0]
Number of failures: 1
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(16, 2)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1526010.001]
memory_state: [46853.99900000007]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 2, gbs: 128, strategies: [(8, 4)], layer_partition: [0, 10]
data loadbalancer: [12, 12, 12, 12, 4, 4, 4, 4]
execution_cost: 2031.531810760498, fb_sync_cost: 631.065845489502, parameter_upate_costs: 5.481767654418945, dp_cost: 21.81856636379076, pp_cost: 0.0
cost: 2691.8472052035127


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[32], num_stage=1, batches=1, gbs=128)
valid_strategies: [(32, 1)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [16633120.001]
memory_state: [-15060256.001]
MEMORY EXCEEDED
Failures: [0]
Number of failures: 1
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(32, 1)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(16, 2)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [5812800.001]
memory_state: [-4239936.001]
MEMORY EXCEEDED
Failures: [0]
Number of failures: 1
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(16, 2)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(8, 4)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [2479260.001]
memory_state: [-906396.0010000002]
MEMORY EXCEEDED
Failures: [0]
Number of failures: 1
Even with the reallocation of layers, memory issues persist.
layer_partition: None
DFS STEP
prev_strategies:  [(8, 4)]
sorted_stage_id:  [0]
Adjusting stage:  0
valid_strategies: [(4, 8)]
stage_memory_capacity: [1572864]
stage_compute_performance: [1.0]
layer_partition: [0, 10]
stage_memory_demand: [1392630.001]
memory_state: [180233.99900000007]
layer_partition: [0, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [32], num_stage: 1, batches: 1, gbs: 128, strategies: [(4, 8)], layer_partition: [0, 10]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 1819.123387336731, fb_sync_cost: 631.065845489502, parameter_upate_costs: 2.7408838272094727, dp_cost: 9.350814155910326, pp_cost: 0.0
cost: 2463.2555382770042


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=128, gbs=128)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (2, 8)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 16), (2, 8)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(1, 16), (1, 16)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [45501.251, 26743.751]
memory_state: [1265218.749, 235400.249]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 128, gbs: 128, strategies: [(1, 16), (1, 16)], layer_partition: [0, 7, 10]
execution_cost: 2341.9904112815857, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 0.9593093395233153, dp_cost: 0.0, pp_cost: 0.08695652173913043
cost: 4351.6639964787855


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=64, gbs=128)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(2, 8), (2, 8)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [45501.251, 26743.751]
memory_state: [1265218.749, 235400.249]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 64, gbs: 128, strategies: [(2, 8), (2, 8)], layer_partition: [0, 7, 10]
execution_cost: 2357.5724363327026, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 1.9186186790466306, dp_cost: 4.165888247282608, pp_cost: 0.08695652173913043
cost: 4309.996341187021


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=32, gbs=128)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(4, 4), (4, 4)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [45501.251, 26743.751]
memory_state: [1265218.749, 235400.249]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 32, gbs: 128, strategies: [(4, 4), (4, 4)], layer_partition: [0, 7, 10]
execution_cost: 2388.7364864349365, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 3.8372373580932613, dp_cost: 12.497664741847826, pp_cost: 0.08695652173913043
cost: 4320.223347498023


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=16, gbs=128)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(8, 2), (8, 2)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [85475.001, 52355.001]
memory_state: [1225244.999, 209788.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 16, gbs: 128, strategies: [(8, 2), (8, 2)], layer_partition: [0, 7, 10]
execution_cost: 2007.7872276306152, fb_sync_cost: 1757.4007034301758, parameter_upate_costs: 7.6744747161865225, dp_cost: 29.16121773097826, pp_cost: 0.08695652173913043
cost: 3817.704299512117


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=8, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [163480.001, 102120.001]
memory_state: [1147239.999, 160023.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 8, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 7, 10]
execution_cost: 1841.2671089172363, fb_sync_cost: 1568.930435180664, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48832370923913, pp_cost: 0.08695652173913043
cost: 3495.9186335024624


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=4, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.2222222222222222]
layer_partition: [0, 7, 10]
stage_memory_demand: [185545.001, 121155.001]
memory_state: [1125174.999, 140988.999]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 4, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 7, 10]
execution_cost: 2011.1629962921143, fb_sync_cost: 1512.9565238952637, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48832370923913, pp_cost: 0.17391304347826086
cost: 3606.029136243074


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=2, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.22222222222222227]
layer_partition: [0, 7, 10]
stage_memory_demand: [233160.001, 193010.001]
memory_state: [1077559.999, 69133.99900000001]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 2, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 7, 10]
execution_cost: 2339.8754596710205, fb_sync_cost: 1465.0352001190186, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48832370923913, pp_cost: 0.34782608695652173
cost: 3885.0449739539104


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=1, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [1310720, 262144]
stage_compute_performance: [0.7777777777777778, 0.22222222222222227]
layer_partition: [0, 7, 10]
stage_memory_demand: [233160.001, 193010.001]
memory_state: [1077559.999, 69133.99900000001]
layer_partition: [0, 7, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [16, 16], num_stage: 2, batches: 1, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 7, 10]
execution_cost: 3040.3659343719482, fb_sync_cost: 1465.0352001190186, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48832370923913, pp_cost: 0.6956521739130435
cost: 4584.908667274143


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (4, 2)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 2), (4, 2), (4, 2)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (4, 2), (4, 2)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (4, 2)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (2, 4)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (2, 4), (2, 4), (2, 4)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 8), (2, 4), (2, 4)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 8), (1, 8), (2, 4)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(1, 8), (1, 8), (1, 8), (1, 8)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.1111111111111111, 0.1111111111111111]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [28393.751, 17107.501, 5702.501, 21041.251]
memory_state: [626966.249, 638252.499, 125369.499, 110030.749]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 128, gbs: 128, strategies: [(1, 8), (1, 8), (1, 8), (1, 8)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2413.2633805274963, fb_sync_cost: 3767.755126953125, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.2539130434782609
cost: 6307.118529914358


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (4, 2)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 2), (4, 2), (4, 2)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (4, 2), (4, 2)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (4, 2)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(2, 4), (2, 4), (2, 4), (2, 4)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.1111111111111111, 0.1111111111111111]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [28393.751, 17107.501, 5702.501, 21041.251]
memory_state: [626966.249, 638252.499, 125369.499, 110030.749]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 64, gbs: 128, strategies: [(2, 4), (2, 4), (2, 4), (2, 4)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2462.307095527649, fb_sync_cost: 3767.755126953125, parameter_upate_costs: 2.192707061767578, dp_cost: 5.184909986413043, pp_cost: 0.2539130434782609
cost: 6300.06863050212


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(4, 2), (4, 2), (4, 2), (4, 2)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.38888888888888895, 0.38888888888888895, 0.11111111111111112, 0.11111111111111112]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [53682.501, 31792.501, 10597.501, 41757.501]
memory_state: [601677.499, 623567.499, 120474.499, 89314.49900000001]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 32, gbs: 128, strategies: [(4, 2), (4, 2), (4, 2), (4, 2)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2086.4797830581665, fb_sync_cost: 3514.8014068603516, parameter_upate_costs: 4.385414123535156, dp_cost: 15.55472995923913, pp_cost: 0.2539130434782609
cost: 5652.662686009614


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=16, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.38888888888888884, 0.38888888888888884, 0.11111111111111109, 0.11111111111111109]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [101290.001, 62190.001, 20730.001, 81390.001]
memory_state: [554069.999, 593169.999, 110341.999, 49681.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 16, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 1956.027328968048, fb_sync_cost: 3137.860870361328, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 0.2539130434782609
cost: 5154.801030007237


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=8, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.38888888888888895, 0.38888888888888895, 0.11111111111111112, 0.11111111111111112]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [112967.501, 72577.501, 24192.501, 96962.501]
memory_state: [542392.499, 582782.499, 106879.499, 34109.498999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 8, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2226.364016532898, fb_sync_cost: 3025.9130477905273, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 0.5078260869565218
cost: 5305.646948303554


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=4, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.11111111111111113, 0.11111111111111113]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 161715.001]
memory_state: [516084.999, 561474.999, 99776.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.40204008617295806, 0.3962864373611778, 0.11230000282987185, 0.0810512316046673]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 161715.001]
memory_state: [516084.999, 561474.999, 99776.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.4117210461281256, 0.40161589181847795, 0.11315303103648375, 0.05912371930170077]
layer_partition: [0, 4, 8, 9, 10]
stage_memory_demand: [139275.001, 125180.001, 31295.001, 130420.001]
memory_state: [516084.999, 530179.999, 99776.999, 651.9989999999962]
layer_partition: [0, 4, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 4, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 8, 9, 10]
execution_cost: 2627.557158470154, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 4.695652173913043
cost: 5611.286838904671
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [3, 2, 0, 1]
Adjusting stage:  3
valid_strategies: [(8, 1), (8, 1), (8, 1), (4, 2)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3924727528617519, 0.3924727528617519, 0.11213507224621483, 0.10291942203028148]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 79860.001]
memory_state: [516084.999, 561474.999, 99776.999, 51211.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 4, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (4, 2)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 2898.277759552002, fb_sync_cost: 2870.145797729492, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 1.0156521739130435
cost: 5818.402837477974


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=2, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.11111111111111113, 0.11111111111111113]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 161715.001]
memory_state: [516084.999, 561474.999, 99776.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.40204008617295806, 0.3962864373611778, 0.11230000282987185, 0.0810512316046673]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 161715.001]
memory_state: [516084.999, 561474.999, 99776.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.4117210461281256, 0.40161589181847795, 0.11315303103648375, 0.05912371930170077]
layer_partition: [0, 4, 8, 9, 10]
stage_memory_demand: [139275.001, 125180.001, 31295.001, 130420.001]
memory_state: [516084.999, 530179.999, 99776.999, 651.9989999999962]
layer_partition: [0, 4, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 2, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 8, 9, 10]
execution_cost: 3390.0630474090576, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 9.391304347826086
cost: 6376.539165082185
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [3, 2, 0, 1]
Adjusting stage:  3
valid_strategies: [(8, 1), (8, 1), (8, 1), (4, 2)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3924727528617519, 0.3924727528617519, 0.11213507224621483, 0.10291942203028148]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 79860.001]
memory_state: [516084.999, 561474.999, 99776.999, 51211.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 2, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (4, 2)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 4006.7481994628906, fb_sync_cost: 2870.145797729492, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 2.031304347826087
cost: 6925.939714627473


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=1, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3888888888888889, 0.3888888888888889, 0.11111111111111113, 0.11111111111111113]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 161715.001]
memory_state: [516084.999, 561474.999, 99776.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.40204008617295806, 0.3962864373611778, 0.11230000282987185, 0.0810512316046673]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 161715.001]
memory_state: [516084.999, 561474.999, 99776.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.4117210461281256, 0.40161589181847795, 0.11315303103648375, 0.05912371930170077]
layer_partition: [0, 4, 8, 9, 10]
stage_memory_demand: [139275.001, 125180.001, 31295.001, 130420.001]
memory_state: [516084.999, 530179.999, 99776.999, 651.9989999999962]
layer_partition: [0, 4, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 1, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 4, 8, 9, 10]
execution_cost: 4915.074825286865, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 18.782608695652172
cost: 7909.967639840167
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [3, 2, 0, 1]
Adjusting stage:  3
valid_strategies: [(8, 1), (8, 1), (8, 1), (4, 2)]
stage_memory_capacity: [655360, 655360, 131072, 131072]
stage_compute_performance: [0.3924727528617519, 0.3924727528617519, 0.11213507224621483, 0.10291942203028148]
layer_partition: [0, 4, 7, 8, 10]
stage_memory_demand: [139275.001, 93885.001, 31295.001, 79860.001]
memory_state: [516084.999, 561474.999, 99776.999, 51211.998999999996]
layer_partition: [0, 4, 7, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 1, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (4, 2)], layer_partition: [0, 4, 7, 8, 10]
execution_cost: 6223.689079284668, fb_sync_cost: 2870.145797729492, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 4.062608695652174
cost: 9143.937291329426


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3888888888888889, 0.19444444444444445, 0.19444444444444445, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [28393.751, 11405.001, 5702.501, 5702.501, 0.001, 5702.501, 15338.751]
memory_state: [626966.249, 316274.999, 321977.499, 59833.498999999996, 65535.999, 59833.498999999996, 50197.248999999996]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 4660.624623298645, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.6708695652173913
cost: 12322.651856160372


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.34278333506180053, 0.20911439338942708, 0.20911439338942708, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [28393.751, 21195.001, 10597.501, 10597.501, 0.001, 10597.501, 31160.001]
memory_state: [626966.249, 306484.999, 317082.499, 54938.498999999996, 65535.999, 54938.498999999996, 34375.998999999996]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 3914.03329372406, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 5.184909986413043, pp_cost: 0.9208695652173913
cost: 11014.30947198785


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3561007165712159, 0.20487704472734045, 0.20487704472734045, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [53682.501, 41460.001, 20730.001, 20730.001, 0.001, 0.001, 20730.001]
memory_state: [601677.499, 286219.999, 306949.999, 44805.998999999996, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
execution_cost: 3548.3734011650085, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 15.55472995923913, pp_cost: 0.5008695652173913
cost: 9875.723594500501


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3882179489171986, 0.19465792534452764, 0.19465792534452764, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [101290.001, 48385.001, 24192.501, 24192.501, 0.001, 24192.501, 72770.001]
memory_state: [554069.999, 279294.999, 303487.499, 41343.498999999996, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.392549741119274, 0.19593707033178817, 0.19567341078813463, 0.055846884913923804, 0.05583332005549019, 0.05582055405754987, 0.04507898254015442]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [101290.001, 48385.001, 24192.501, 24192.501, 0.001, 0.001, 24192.501]
memory_state: [554069.999, 279294.999, 303487.499, 41343.498999999996, 65535.999, 65535.999, 41343.498999999996]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
execution_cost: 3767.775774002075, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 0.9147826086956522
cost: 9881.17556982621
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 6, 4, 5, 1, 2, 0]
Adjusting stage:  3
valid_strategies: [(8, 1), (4, 1), (4, 1), (2, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.38979324149288025, 0.19544779913951343, 0.19544779913951343, 0.0517844752513669, 0.05584222832557526, 0.05584222832557526, 0.05584222832557526]
layer_partition: [0, 4, 5, 7, 7, 7, 8, 9]
stage_memory_demand: [101290.001, 24192.501, 48385.001, 0.001, 0.001, 24192.501, 24192.501]
memory_state: [554069.999, 303487.499, 279294.999, 65535.999, 65535.999, 41343.498999999996, 41343.498999999996]
layer_partition: [0, 4, 5, 7, 7, 7, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (2, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 5, 7, 7, 7, 8, 9]
execution_cost: 3767.775774002075, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 1.0747826086956522
cost: 9881.33556982621


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.38643964617890403, 0.1952237489430759, 0.1952237489430759, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [112967.501, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [542392.499, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.39894381779834476, 0.19895536098366876, 0.19818382689818737, 0.056449089228997454, 0.05640945847323565, 0.0563721688335209, 0.02522567783506081]
layer_partition: [0, 4, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [112967.501, 62590.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [542392.499, 265089.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.4046542472048876, 0.2006262375248623, 0.19950518443494583, 0.056748184470030175, 0.056690865681847474, 0.05663695646358774, 0.011408304009587384]
layer_partition: [0, 4, 6, 8, 8, 8, 8, 9]
stage_memory_demand: [112967.501, 62590.001, 62590.001, 0.001, 0.001, 0.001, 31295.001]
memory_state: [542392.499, 265089.999, 265089.999, 65535.999, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 4, 6, 8, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 8, 8, 8, 8, 9]
execution_cost: 3907.320976257324, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 1.8295652173913044
cost: 9822.153399843963
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [6, 3, 4, 5, 1, 2, 0]
Adjusting stage:  6
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.38821926175728205, 0.19612278512718317, 0.19612278512718317, 0.05603508146490949, 0.05603508146490949, 0.05603508146490949, 0.05142992359362299]
layer_partition: [0, 4, 6, 7, 8, 9, 9, 10]
stage_memory_demand: [112967.501, 62590.001, 31295.001, 31295.001, 31295.001, 0.001, 59650.001]
memory_state: [542392.499, 265089.999, 296384.999, 34240.998999999996, 34240.998999999996, 65535.999, 5885.999000000003]
layer_partition: [0, 4, 6, 7, 8, 9, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 4, 6, 7, 8, 9, 9, 10]
execution_cost: 4203.42493057251, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294369904891305, pp_cost: 9.189565217391305
cost: 10005.768149142059


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3888888888888888, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [516084.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.4014191256194352, 0.19812980818872275, 0.19737105682960662, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 4, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [516084.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.407141159789946, 0.199779792163748, 0.19867741366169162, 0.05651561221995425, 0.05645912011305966, 0.05640597401028232, 0.01136276373754282]
layer_partition: [0, 4, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [516084.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.407141159789946, 0.199779792163748, 0.19867741366169162, 0.05651561221995425, 0.05645912011305966, 0.05640597401028232, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3687127975365733, 0.20086410987472655, 0.20086410987472655, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [81500.001, 62590.001, 31295.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [573859.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
execution_cost: 5163.719177246094, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 15.55472995923913, pp_cost: 4.006956521739131
cost: 11051.705508197289


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3888888888888888, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [516084.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.4014191256194352, 0.19812980818872275, 0.19737105682960662, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 4, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [516084.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.407141159789946, 0.199779792163748, 0.19867741366169162, 0.05651561221995425, 0.05645912011305966, 0.05640597401028232, 0.01136276373754282]
layer_partition: [0, 4, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [516084.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.407141159789946, 0.199779792163748, 0.19867741366169162, 0.05651561221995425, 0.05645912011305966, 0.05640597401028232, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3687127975365733, 0.20086410987472655, 0.20086410987472655, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [81500.001, 62590.001, 31295.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [573859.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
execution_cost: 7063.5986328125, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 15.55472995923913, pp_cost: 8.013913043478261
cost: 12953.64270535013


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3888888888888888, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [516084.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.4014191256194352, 0.19812980818872275, 0.19737105682960662, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 4, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [516084.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.407141159789946, 0.199779792163748, 0.19867741366169162, 0.05651561221995425, 0.05645912011305966, 0.05640597401028232, 0.01136276373754282]
layer_partition: [0, 4, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [139275.001, 62590.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [516084.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.407141159789946, 0.199779792163748, 0.19867741366169162, 0.05651561221995425, 0.05645912011305966, 0.05640597401028232, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [655360, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.3687127975365733, 0.20086410987472655, 0.20086410987472655, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [81500.001, 62590.001, 31295.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [573859.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 4, 6, 7, 8, 8, 8, 9]
execution_cost: 10863.357543945312, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 15.55472995923913, pp_cost: 16.027826086956523
cost: 16760.44092205877


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444445, 0.3888888888888889, 0.19444444444444445, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [22691.251, 17107.501, 5702.501, 5702.501, 0.001, 5702.501, 15338.751]
memory_state: [304988.749, 638252.499, 321977.499, 59833.498999999996, 65535.999, 59833.498999999996, 50197.248999999996]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
execution_cost: 4661.137819290161, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.6445302963256836, dp_cost: 0.0, pp_cost: 0.6708695652173913
cost: 12323.71322891733


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20911439338942708, 0.34278333506180053, 0.20911439338942708, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305]
layer_partition: [0, 2, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [32487.501, 17107.501, 21195.001, 10597.501, 0.001, 10597.501, 31160.001]
memory_state: [295192.499, 638252.499, 306484.999, 54938.498999999996, 65535.999, 54938.498999999996, 34375.998999999996]
layer_partition: [0, 2, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 5, 7, 8, 8, 9, 10]
execution_cost: 3914.169430732727, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 0.9208695652173913
cost: 11015.43469697206


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20487704472734045, 0.3561007165712159, 0.20487704472734045, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 31792.501, 20730.001, 20730.001, 0.001, 0.001, 20730.001]
memory_state: [247119.999, 623567.499, 306949.999, 44805.998999999996, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
execution_cost: 3547.5000739097595, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 0.5008695652173913
cost: 9886.303971249954


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19465792534452764, 0.3882179489171986, 0.19465792534452764, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [88775.001, 62190.001, 24192.501, 24192.501, 0.001, 24192.501, 72770.001]
memory_state: [238904.999, 593169.999, 303487.499, 41343.498999999996, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19682994671919996, 0.3916568647318622, 0.19567341078813463, 0.055846884913923804, 0.05583332005549019, 0.05582055405754987, 0.04507898254015442]
layer_partition: [0, 2, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 62190.001, 48385.001, 24192.501, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 593169.999, 279294.999, 41343.498999999996, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19682994671919996, 0.3916568647318622, 0.19567341078813463, 0.055846884913923804, 0.05583332005549019, 0.05582055405754987, 0.03653794892453559]
layer_partition: [0, 2, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 62190.001, 48385.001, 24192.501, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 593169.999, 279294.999, 41343.498999999996, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19682994671919996, 0.3916568647318622, 0.19567341078813463, 0.055846884913923804, 0.05583332005549019, 0.05582055405754987, 0.029615169562063465]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20168916544810203, 0.36611976573453625, 0.20168916544810203, 0.05762547584231486, 0.05762547584231486, 0.05762547584231486, 0.05762547584231486]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [88775.001, 39112.501, 24192.501, 24192.501, 0.001, 0.001, 24192.501]
memory_state: [238904.999, 616247.499, 303487.499, 41343.498999999996, 65535.999, 65535.999, 41343.498999999996]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
execution_cost: 3776.3155698776245, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 1.0017391304347827
cost: 9876.130972159013


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1952237489430759, 0.38643964617890403, 0.1952237489430759, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 72577.501, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 582782.499, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20154067652830795, 0.39635850225370556, 0.19818382689818737, 0.056449089228997454, 0.05640945847323565, 0.0563721688335209, 0.02522567783506081]
layer_partition: [0, 3, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 72577.501, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 582782.499, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2044255032996894, 0.40084741386498035, 0.19950673809462494, 0.05674853614790939, 0.056691196562037936, 0.056637267802383574, 0.011408304009587384]
layer_partition: [0, 3, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 72577.501, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 582782.499, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2044255032996894, 0.40084741386498035, 0.19950673809462494, 0.05674853614790939, 0.056691196562037936, 0.056637267802383574, 0.005159401512465001]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20086410987472655, 0.3687127975365733, 0.20086410987472655, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 60630.001, 31295.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 594729.999, 296384.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
execution_cost: 4212.3682498931885, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 2.0034782608695654
cost: 10113.70323645882


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.3888888888888888, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 561474.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2007095628097176, 0.39883937099844036, 0.19737105682960662, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 3, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 561474.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.203570579894973, 0.40334272731662796, 0.19867897648648705, 0.05651596637388861, 0.05645945341265396, 0.05640628770970491, 0.01136276373754282]
layer_partition: [0, 3, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 561474.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.203570579894973, 0.40334272731662796, 0.19867897648648705, 0.05651596637388861, 0.05645945341265396, 0.05640628770970491, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20086410987472655, 0.3687127975365733, 0.20086410987472655, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 60630.001, 31295.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 594729.999, 296384.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
execution_cost: 5160.896778106689, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 4.006956521739131
cost: 11060.336813062586


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.3888888888888888, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 561474.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2007095628097176, 0.39883937099844036, 0.19737105682960662, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 3, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 561474.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.203570579894973, 0.40334272731662796, 0.19867897648648705, 0.05651596637388861, 0.05645945341265396, 0.05640628770970491, 0.01136276373754282]
layer_partition: [0, 3, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 561474.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.203570579894973, 0.40334272731662796, 0.19867897648648705, 0.05651596637388861, 0.05645945341265396, 0.05640628770970491, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20086410987472655, 0.3687127975365733, 0.20086410987472655, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 60630.001, 31295.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 594729.999, 296384.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
execution_cost: 7057.953834533691, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 8.013913043478261
cost: 12959.451611076023


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.3888888888888888, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 3, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 561474.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2007095628097176, 0.39883937099844036, 0.19737105682960662, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 3, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 561474.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.203570579894973, 0.40334272731662796, 0.19867897648648705, 0.05651596637388861, 0.05645945341265396, 0.05640628770970491, 0.01136276373754282]
layer_partition: [0, 3, 6, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 93885.001, 62590.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 561474.999, 265089.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.203570579894973, 0.40334272731662796, 0.19867897648648705, 0.05651596637388861, 0.05645945341265396, 0.05640628770970491, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 655360, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20086410987472655, 0.3687127975365733, 0.20086410987472655, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 60630.001, 31295.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 594729.999, 296384.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 6, 7, 8, 8, 8, 9]
execution_cost: 10852.067947387695, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 16.027826086956523
cost: 16760.605029505852


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.3888888888888889, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [16988.751, 11405.001, 17107.501, 5702.501, 0.001, 5702.501, 15338.751]
memory_state: [310691.249, 316274.999, 638252.499, 59833.498999999996, 65535.999, 59833.498999999996, 50197.248999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 4661.137819290161, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.6708695652173913
cost: 12323.165052151888


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20911439338942708, 0.20911439338942708, 0.34278333506180053, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [32487.501, 21195.001, 17107.501, 10597.501, 0.001, 10597.501, 31160.001]
memory_state: [295192.499, 306484.999, 638252.499, 54938.498999999996, 65535.999, 54938.498999999996, 34375.998999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
execution_cost: 3914.169430732727, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 0.9208695652173913
cost: 11015.43469697206


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
valid_strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20487704472734045, 0.20487704472734045, 0.3561007165712159, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583, 0.05853629849352583]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 31792.501, 20730.001, 0.001, 0.001, 20730.001]
memory_state: [267849.999, 286219.999, 623567.499, 44805.998999999996, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
execution_cost: 3547.5000739097595, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 0.5008695652173913
cost: 9877.817531171882


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19465792534452764, 0.19465792534452764, 0.3882179489171986, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647, 0.05561655009843647]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 62190.001, 24192.501, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 593169.999, 41343.498999999996, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19682994671919996, 0.19638224597365878, 0.39094802954633806, 0.055846884913923804, 0.05583332005549019, 0.05582055405754987, 0.04507898254015442]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 62190.001, 24192.501, 0.001, 0.001, 24192.501]
memory_state: [263097.499, 279294.999, 593169.999, 41343.498999999996, 65535.999, 65535.999, 41343.498999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
execution_cost: 3768.1148052215576, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 0.9147826086956522
cost: 9865.055589636098
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 6, 4, 5, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19544779913951343, 0.19544779913951343, 0.38979324149288025, 0.0517844752513669, 0.05584222832557526, 0.05584222832557526, 0.05584222832557526]
layer_partition: [0, 2, 4, 7, 7, 7, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 62190.001, 0.001, 0.001, 24192.501, 24192.501]
memory_state: [263097.499, 279294.999, 593169.999, 65535.999, 65535.999, 41343.498999999996, 41343.498999999996]
layer_partition: [0, 2, 4, 7, 7, 7, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 7, 7, 8, 9]
execution_cost: 3768.1148052215576, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 1.0747826086956522
cost: 9865.215589636098


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1952237489430759, 0.1952237489430759, 0.38643964617890403, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598, 0.05577821398373598]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 72577.501, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 582782.499, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20154067652830795, 0.20023461231410045, 0.3943077168377925, 0.056449089228997454, 0.05640945847323565, 0.0563721688335209, 0.02522567783506081]
layer_partition: [0, 3, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 72577.501, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 582782.499, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2044255032996894, 0.2025023458711834, 0.3978470872499191, 0.05674881209357303, 0.05669145618869955, 0.05663751209580012, 0.011408304009587384]
layer_partition: [0, 3, 5, 8, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 72577.501, 0.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 582782.499, 65535.999, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 8, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 8, 8, 8, 8, 9]
execution_cost: 3907.7889919281006, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 1.8295652173913044
cost: 9808.950065450254
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [6, 3, 4, 5, 0, 1, 2]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19612278512718317, 0.19612278512718317, 0.38821926175728205, 0.05603508146490949, 0.05603508146490949, 0.05603508146490949, 0.05142992359362299]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 72577.501, 31295.001, 0.001, 0.001, 20210.001]
memory_state: [250994.999, 265089.999, 582782.499, 34240.998999999996, 65535.999, 65535.999, 45325.998999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
execution_cost: 4477.460622787476, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 1.8295652173913044
cost: 10255.98482994743


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.3888888888888888, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 93885.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 561474.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2007095628097176, 0.19941968549922018, 0.39679074232882683, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 3, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 93885.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 561474.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.203570579894973, 0.20167136365831398, 0.40034556228337637, 0.05651624459181538, 0.0564597152477294, 0.056406534147184544, 0.01136276373754282]
layer_partition: [0, 3, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 93885.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 561474.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.203570579894973, 0.20167136365831398, 0.40034556228337637, 0.05651624459181538, 0.0564597152477294, 0.056406534147184544, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
valid_strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20086410987472655, 0.20086410987472655, 0.3687127975365733, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 594729.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
execution_cost: 5160.896778106689, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 4.006956521739131
cost: 11051.850372984514


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.3888888888888888, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 93885.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 561474.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2007095628097176, 0.19941968549922018, 0.39679074232882683, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 3, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 93885.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 561474.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.203570579894973, 0.20167136365831398, 0.40034556228337637, 0.05651624459181538, 0.0564597152477294, 0.056406534147184544, 0.01136276373754282]
layer_partition: [0, 3, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 93885.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 561474.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.203570579894973, 0.20167136365831398, 0.40034556228337637, 0.05651624459181538, 0.0564597152477294, 0.056406534147184544, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
valid_strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20086410987472655, 0.20086410987472655, 0.3687127975365733, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 594729.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
execution_cost: 7057.953834533691, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 8.013913043478261
cost: 12950.965170997952


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.3888888888888888, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 93885.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 561474.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2007095628097176, 0.19941968549922018, 0.39679074232882683, 0.05621957685302933, 0.056180516776707344, 0.05614375435193371, 0.025124980638514174]
layer_partition: [0, 3, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 93885.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 561474.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.203570579894973, 0.20167136365831398, 0.40034556228337637, 0.05651624459181538, 0.0564597152477294, 0.056406534147184544, 0.01136276373754282]
layer_partition: [0, 3, 5, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 93885.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 561474.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.203570579894973, 0.20167136365831398, 0.40034556228337637, 0.05651624459181538, 0.0564597152477294, 0.056406534147184544, 0.005138805940303938]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
valid_strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 655360, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.20086410987472655, 0.20086410987472655, 0.3687127975365733, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331, 0.05738974567849331]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 60630.001, 31295.001, 0.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 594729.999, 34240.998999999996, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 7, 8, 8, 8, 9]
execution_cost: 10852.067947387695, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 16.027826086956523
cost: 16752.11858942778


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 0, 1, 2, 4, 5, 6]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.17073170731707318, 0.17073170731707318, 0.17073170731707318, 0.34146341463414637, 0.04878048780487805, 0.04878048780487805, 0.04878048780487805]
layer_partition: [0, 2, 4, 5, 8, 8, 8, 9]
stage_memory_demand: [16988.751, 11405.001, 5702.501, 17107.501, 0.001, 0.001, 5702.501]
memory_state: [310691.249, 316274.999, 321977.499, 376108.499, 65535.999, 65535.999, 59833.498999999996]
layer_partition: [0, 2, 4, 5, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 5, 8, 8, 8, 9]
data loadbalancer: [1]
execution_cost: 4634.413838386536, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 12296.27802777


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 0, 1, 2, 4, 5, 6]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.21130644822118014, 0.21130644822118014, 0.21130644822118014, 0.1849608425754481, 0.060373270920337174, 0.060373270920337174, 0.060373270920337174]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [32487.501, 21195.001, 21195.001, 14255.001, 0.001, 10597.501, 31160.001]
memory_state: [295192.499, 306484.999, 306484.999, 378960.999, 65535.999, 54938.498999999996, 34375.998999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [2, 0]
execution_cost: 3896.608591079712, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 0.9278260869565218
cost: 10997.880813840782


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 0, 1, 2, 4, 5, 6]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20976043001836134, 0.20976043001836134, 0.20976043001836134, 0.19092405564346368, 0.059931551433817516, 0.059931551433817516, 0.059931551433817516]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 52150.001000000004, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 341065.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [2, 2, 0, 0]
execution_cost: 3518.643021583557, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.4278260869565218
cost: 9849.887435367418


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20588235294117643, 0.20588235294117643, 0.20588235294117643, 0.20588235294117643, 0.05882352941176469, 0.05882352941176469, 0.05882352941176469]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 193540.001, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 199675.999, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20832036284935113, 0.2077870481819379, 0.20737039609802133, 0.2070448866574615, 0.05908302354486404, 0.05906680516154533, 0.047678341260108954]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 193540.001, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 199675.999, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20832036284935113, 0.2077870481819379, 0.20737039609802133, 0.2070448866574615, 0.05908302354486404, 0.05906680516154533, 0.03864481183036194]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 193540.001, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 199675.999, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20832036284935113, 0.2077870481819379, 0.20737039609802133, 0.2070448866574615, 0.05908302354486404, 0.05906680516154533, 0.031322848948471774]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 0, 1, 2, 4, 5, 6]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2062896530835851, 0.2062896530835851, 0.2062896530835851, 0.2043113381061716, 0.058939900881024306, 0.058939900881024306, 0.058939900881024306]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 136930.001, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 256285.999, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20873762151479375, 0.20820100269639272, 0.2077820160143342, 0.20546538590131236, 0.0592005419109119, 0.05918421760125146, 0.047772664036722055]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 136930.001, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 256285.999, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20873762151479375, 0.20820100269639272, 0.2077820160143342, 0.20546538590131236, 0.0592005419109119, 0.05918421760125146, 0.03872126344040527]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 136930.001, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 256285.999, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20873762151479375, 0.20820100269639272, 0.2077820160143342, 0.20546538590131236, 0.0592005419109119, 0.05918421760125146, 0.03138481540968179]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19421091112879071, 0.20942898407154698, 0.20942898407154698, 0.20742056295250347, 0.05983685259187056, 0.05983685259187056, 0.05983685259187056]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [41080.001, 48385.001, 48385.001, 136930.001, 0.001, 0.001, 24192.501]
memory_state: [286599.999, 279294.999, 279294.999, 256285.999, 65535.999, 65535.999, 41343.498999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
data loadbalancer: [3, 3, 1, 1]
execution_cost: 3715.428113937378, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 4.385414123535156, dp_cost: 12.587466032608695, pp_cost: 1.1895652173913043
cost: 9801.01037437439


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20059862743701, 0.20059862743701, 0.20059862743701, 0.22626243702867543, 0.05731389355343144, 0.05731389355343144, 0.05731389355343144]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 525220.0009999999, 0.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 265089.999, -132004.00099999993, 65535.999, 65535.999, 34240.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.22590743279361133, 0.2193458906641221, 0.21448548908672269, 0.15245613122566687, 0.06025291189199496, 0.060035206829879145, 0.0598336280686608]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 262610.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 130605.99900000001, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.23644100145695093, 0.22709572136016037, 0.22028101364181898, 0.15562804778255937, 0.061301544950110476, 0.061012537794141446, 0.027059737441628897]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 262610.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, 130605.99900000001, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4067.6081776618958, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 1.8573913043478263
cost: 9968.797077271005
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [6, 4, 5, 3, 0, 1, 2]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20154796978882072, 0.20154796978882072, 0.20154796978882072, 0.22733323455525709, 0.05758513422537736, 0.05758513422537736, 0.05285258762752592]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 525220.0009999999, 0.001, 0.001, 20210.001]
memory_state: [250994.999, 265089.999, 265089.999, -132004.00099999993, 65535.999, 65535.999, 45325.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.22712411578358765, 0.22045264946615045, 0.21552141652217796, 0.1531776369708205, 0.060536137694853484, 0.060316205974622804, 0.05517239738624332]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 262610.001, 0.001, 31295.001, 59650.001]
memory_state: [219699.999, 265089.999, 265089.999, 130605.99900000001, 65535.999, 34240.998999999996, 5885.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4072.2978711128235, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 5.5373913043478264
cost: 9857.317565704843
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
sorted_stage_id:  [6, 5, 4, 3, 0, 1, 2]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20286403853612214, 0.20286403853612214, 0.20286403853612214, 0.22881767602859268, 0.05796115386746348, 0.05796115386746348, 0.046667900628113775]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 525220.0009999999, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -132004.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.22881309152364399, 0.221987040768062, 0.21695662274482624, 0.15417785692348984, 0.060928424491464836, 0.060705407931232414, 0.048711391568695306]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 262610.001, 0.001, 31295.001, 31528.751]
memory_state: [219699.999, 265089.999, 265089.999, 130605.99900000001, 65535.999, 34240.998999999996, 34007.248999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4077.1144032478333, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 5.5373913043478264
cost: 9170.369266296884
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)]
sorted_stage_id:  [6, 5, 4, 3, 0, 1, 2]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20383499618558215, 0.20383499618558215, 0.20383499618558215, 0.2299128542300858, 0.05823857033873776, 0.05345232208859714, 0.046891264785832824]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 525220.0009999999, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -132004.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.23006154065115134, 0.22311961515549122, 0.21801515359453136, 0.15491579042140036, 0.06121765603920239, 0.055979795609370234, 0.04895460108532214]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 262610.001, 0.001, 20210.001, 31528.751]
memory_state: [219699.999, 265089.999, 265089.999, 130605.99900000001, 65535.999, 45325.998999999996, 34007.248999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4355.37177324295, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 5.5373913043478264
cost: 9448.626636292001
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (1, 4)]
sorted_stage_id:  [6, 5, 4, 3, 0, 1, 2]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2051812018080951, 0.2051812018080951, 0.2051812018080951, 0.23143128817344433, 0.058623200516598604, 0.047200952942835855, 0.047200952942835855]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 525220.0009999999, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -132004.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.2317948899600746, 0.22468995784985188, 0.21948179630380663, 0.15593891457566214, 0.06161829523923854, 0.049428537101963405, 0.04929173203371999]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 262610.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 130605.99900000001, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4816.036522388458, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 2.8173913043478263
cost: 9906.57138543751
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 3, 0, 1, 2]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20617452147801718, 0.20617452147801718, 0.20617452147801718, 0.23255168930547931, 0.05406582350791084, 0.047429461376279174, 0.047429461376279174]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 525220.0009999999, 20210.001, 0.001, 31528.751]
memory_state: [250994.999, 265089.999, 265089.999, -132004.00099999993, 45325.998999999996, 65535.999, 34007.248999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.23307636484169558, 0.22584920099874758, 0.22056361032261596, 0.1566938433400388, 0.056825427397862324, 0.049679787324332744, 0.049540713791757424]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 262610.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 130605.99900000001, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4816.036522388458, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 3.137391304347826
cost: 9906.89138543751
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 3, 0, 1, 2]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20755191112133053, 0.20755191112133053, 0.20755191112133053, 0.23410529683219083, 0.047746323267939164, 0.047746323267939164, 0.047746323267939164]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 525220.0009999999, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -132004.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.23485585781485518, 0.22745668623949789, 0.22206263651030062, 0.1577406675326709, 0.05017983905883059, 0.050028132262649655, 0.04988588295677704]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 262610.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 130605.99900000001, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4816.036522388458, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 3.7773913043478267
cost: 9907.531385437509
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.21200887412006214, 0.21200887412006214, 0.21200887412006214, 0.21765849885041785, 0.04877162626313193, 0.04877162626313193, 0.04877162626313193]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 185140.001, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, 208075.999, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
data loadbalancer: [6, 6, 2, 2]
execution_cost: 4821.883916854858, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 3.9513043478260874
cost: 9905.066252869316


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20047034993794183, 0.20047034993794183, 0.20047034993794183, 0.2267572216679385, 0.05727724283941196, 0.05727724283941196, 0.05727724283941196]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 637440.0009999999, 0.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 265089.999, -244224.00099999993, 65535.999, 65535.999, 34240.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.23778043395537246, 0.22810744921011267, 0.22094227532473504, 0.1258912380489942, 0.0616099254609555, 0.06128898600750783, 0.06099181984690814]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 318720.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 74495.99900000001, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.24903442467232892, 0.23615986230940578, 0.2268402119060177, 0.12845824813011092, 0.06269715900826704, 0.06229933531755849, 0.027583529269703613]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 318720.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, 74495.99900000001, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 4870.8425760269165, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 3.7147826086956526
cost: 10769.990437069768
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [6, 4, 5, 3, 0, 1, 2]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20141847565013118, 0.20141847565013118, 0.20141847565013118, 0.22782967129629775, 0.05754813590003749, 0.05754813590003749, 0.05281862995323373]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 637440.0009999999, 0.001, 0.001, 20210.001]
memory_state: [250994.999, 265089.999, 265089.999, -244224.00099999993, 65535.999, 65535.999, 45325.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.23911622577707248, 0.22928287284475377, 0.2220145225867574, 0.12648664140799742, 0.06189774320360893, 0.06157357665263832, 0.056237894475889394]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 318720.001, 0.001, 31295.001, 59650.001]
memory_state: [219699.999, 265089.999, 265089.999, 74495.99900000001, 65535.999, 34240.998999999996, 5885.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 4880.221962928772, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 11.074782608695653
cost: 10666.880618954534
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
sorted_stage_id:  [6, 5, 4, 3, 0, 1, 2]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20273284828371116, 0.20273284828371116, 0.20273284828371116, 0.2293163923336942, 0.0579236709382032, 0.0579236709382032, 0.046637720938765816]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 637440.0009999999, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -244224.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.24097075301957904, 0.2309120476541209, 0.2234993437975841, 0.12731204026698242, 0.06229617006179988, 0.061967538184991545, 0.04964896038369432]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 318720.001, 0.001, 31295.001, 31528.751]
memory_state: [219699.999, 265089.999, 265089.999, 74495.99900000001, 65535.999, 34240.998999999996, 34007.248999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 4889.8550271987915, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 11.074782608695653
cost: 9984.748851681585
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)]
sorted_stage_id:  [6, 5, 4, 3, 0, 1, 2]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20370254751956812, 0.20370254751956812, 0.20370254751956812, 0.2304132443352222, 0.05820072786273376, 0.05341758963887815, 0.04686079560446155]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 637440.0009999999, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -244224.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.242342481112481, 0.23211484550034758, 0.22459437111982058, 0.12792099135314047, 0.06258985635751776, 0.057141351613267506, 0.04990073774006319]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 318720.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 74495.99900000001, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 5619.270920753479, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 4.354782608695652
cost: 10707.444745236273
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (1, 4)]
sorted_stage_id:  [6, 4, 5, 3, 0, 1, 2]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (2, 2), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20468156774999183, 0.20468156774999183, 0.20468156774999183, 0.23152063955589353, 0.05367432133690422, 0.05367432133690422, 0.047086014520322725]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 637440.0009999999, 20210.001, 0.001, 31528.751]
memory_state: [250994.999, 265089.999, 265089.999, -244224.00099999993, 45325.998999999996, 65535.999, 34007.248999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.24372980589252696, 0.2333294555223228, 0.22569919909152175, 0.128535795831315, 0.057717870804868676, 0.05743544972154931, 0.050155028919627774]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 318720.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 74495.99900000001, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (2, 2), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 5619.270920753479, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 4.994782608695653
cost: 10708.084745236272
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (2, 2), (1, 4)]
sorted_stage_id:  [6, 4, 5, 3, 0, 1, 2]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20603901600361016, 0.20603901600361016, 0.20603901600361016, 0.23305608454635604, 0.047398288990774945, 0.054030289461263724, 0.047398288990774945]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 637440.0009999999, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -244224.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.24565630382861753, 0.23501314357175818, 0.22722926183879835, 0.1293882452897429, 0.050963414468224326, 0.057843090830393074, 0.05050744747796521]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 318720.001, 0.001, 20210.001, 31528.751]
memory_state: [219699.999, 265089.999, 265089.999, 74495.99900000001, 65535.999, 45325.998999999996, 34007.248999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 5168.112397193909, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 12.994782608695653
cost: 10264.926221676702
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)]
sorted_stage_id:  [6, 5, 4, 3, 0, 1, 2]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20741458965982032, 0.20741458965982032, 0.20741458965982032, 0.23461203165064545, 0.0477147331232979, 0.0477147331232979, 0.0477147331232979]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 637440.0009999999, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -244224.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.24761323191266493, 0.23671969133906923, 0.2287782212727847, 0.13025207712652817, 0.05129751299731122, 0.05107416040673321, 0.05086473174714514]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 318720.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 74495.99900000001, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [6, 6, 6, 6, 2, 2, 2, 2]
execution_cost: 5619.270920753479, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 7.554782608695653
cost: 10710.644745236272
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.21101191851974463, 0.21101191851974463, 0.21101191851974463, 0.22133740023682957, 0.0485422814013122, 0.0485422814013122, 0.0485422814013122]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 242520.001, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, 150695.999, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
data loadbalancer: [12, 12, 4, 4]
execution_cost: 5622.87974357605, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 7.902608695652175
cost: 10706.114954067729


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.22857142857142856, 0.05714285714285714, 0.05714285714285714, 0.05714285714285714]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 751080.0009999999, 0.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 265089.999, -357864.00099999993, 65535.999, 65535.999, 34240.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.24471062484252282, 0.23311898136483172, 0.22453257878876423, 0.10769844552341978, 0.06233493730979138, 0.06195033877890736, 0.06159422902808882]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 375540.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 17675.99900000001, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.25641368620610594, 0.24134777322961623, 0.2304808217782457, 0.10986592619991825, 0.0634448529607009, 0.06297981517817285, 0.027855968611948913]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 375540.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, 17675.99900000001, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [12, 12, 12, 12, 4, 4, 4, 4]
execution_cost: 6473.781585693359, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 7.429565217391305
cost: 12374.695014409604
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 6, 4, 5, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19885996432338424, 0.19885996432338424, 0.19885996432338424, 0.2329687090383749, 0.05681713266382408, 0.05681713266382408, 0.05681713266382408]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 379450.001, 31295.001, 0.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 13765.99900000001, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20756617592572552, 0.2057305648384258, 0.2042819726082041, 0.2379814572651218, 0.05773769040458671, 0.05768223620467176, 0.025695528446060486]
layer_partition: [0, 3, 5, 6, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 31295.001, 379450.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 296384.999, 13765.99900000001, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 6, 8, 8, 8, 9]
data loadbalancer: [25, 25, 7, 7]
execution_cost: 6392.235279083252, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 8.125217391304348
cost: 12293.84435997341
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 6, 4, 5, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2047180194723056, 0.2047180194723056, 0.2047180194723056, 0.21037335346396388, 0.05849086270637304, 0.05849086270637304, 0.05849086270637304]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 111190.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 282025.999, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.21396479650867453, 0.211954213916955, 0.2103808044442829, 0.2149272648126209, 0.05947409326948757, 0.05941301048059276, 0.026452472274497044]
layer_partition: [0, 3, 5, 6, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 31295.001, 111190.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 296384.999, 282025.999, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 6, 8, 8, 8, 9]
data loadbalancer: [50, 14]
execution_cost: 6497.657299041748, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 9.516521739130434
cost: 12400.657684279731
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [6, 4, 5, 0, 1, 3, 2]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20570684869706934, 0.20570684869706934, 0.20570684869706934, 0.21138949908980048, 0.05877338534201982, 0.05877338534201982, 0.05394318413495187]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 111190.001, 0.001, 31295.001, 59650.001]
memory_state: [250994.999, 265089.999, 265089.999, 282025.999, 65535.999, 34240.998999999996, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [50, 14]
execution_cost: 6516.416072845459, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 24.236521739130435
cost: 12305.800812988282


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.1946863889308981, 0.1946863889308981, 0.1946863889308981, 0.24906678555224995, 0.05562468255168518, 0.05562468255168518, 0.05562468255168518]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 1276300.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, -883084.0009999999, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [3, 6]
Number of failures: 2
adj_stage_compute_performance(2): [0.27811850697414797, 0.254757513922038, 0.23793759892451882, 0.06906161604942455, 0.06452207432180145, 0.06381028298019215, 0.025156243298422573]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 638150.0009999999, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, -244934.00099999993, 65535.999, 65535.999, 34240.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.28737483818545506, 0.2606851019263374, 0.2419479248287675, 0.03829901925337688, 0.06532961760163036, 0.06455316795190058, 0.025428895806928687]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 0.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, 393215.999, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 8867.76351928711, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 14.85913043478261
cost: 14775.131905753095
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [6, 4, 5, 0, 1, 2, 3]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19558047133786488, 0.19558047133786488, 0.19558047133786488, 0.25021060578716675, 0.0558801346679614, 0.0558801346679614, 0.0512877108633157]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 1276300.001, 0.001, 31295.001, 59650.001]
memory_state: [250994.999, 265089.999, 265089.999, -883084.0009999999, 65535.999, 34240.998999999996, 5885.999000000003]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.2642193069105918, 0.24590386007424048, 0.23248108190760788, 0.06937877625895725, 0.06361214157404467, 0.06302336342201287, 0.0555660808633373]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 638150.0009999999, 0.001, 31295.001, 59650.001]
memory_state: [219699.999, 265089.999, 265089.999, -244934.00099999993, 65535.999, 34240.998999999996, 5885.999000000003]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.27304861923621193, 0.2517734373954216, 0.23655474971257623, 0.03847490458109068, 0.06444658578820427, 0.06379321879871973, 0.056198586546681875]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 0.001, 0.001, 31295.001, 20210.001]
memory_state: [219699.999, 265089.999, 265089.999, 393215.999, 65535.999, 34240.998999999996, 45325.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 12409.860610961914, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 14.85913043478261
cost: 18197.379792410808
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
sorted_stage_id:  [5, 6, 4, 0, 1, 2, 3]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19648280364251633, 0.19648280364251633, 0.19648280364251633, 0.25136498030638005, 0.056137943897861815, 0.051524332434104564, 0.051524332434104564]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 1276300.001, 31295.001, 0.001, 59650.001]
memory_state: [250994.999, 265089.999, 265089.999, -883084.0009999999, 34240.998999999996, 65535.999, 5885.999000000003]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.2658351890174607, 0.24721290169062482, 0.2335966200517891, 0.06969886297644702, 0.06389688431973832, 0.058099945253020854, 0.05584510711140365]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 638150.0009999999, 0.001, 20210.001, 59650.001]
memory_state: [219699.999, 265089.999, 265089.999, -244934.00099999993, 65535.999, 45325.998999999996, 5885.999000000003]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2747625639694384, 0.25312766614255694, 0.2376910785573861, 0.038652412841932965, 0.06473386972011129, 0.05880839566403179, 0.056483267724993236]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 0.001, 0.001, 20210.001, 20210.001]
memory_state: [219699.999, 265089.999, 265089.999, 393215.999, 65535.999, 45325.998999999996, 45325.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (2, 2)], layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 12688.117980957031, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 17.41913043478261
cost: 18478.197162405926
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 4, 0, 1, 2, 3]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19773334929416578, 0.19773334929416578, 0.19773334929416578, 0.25296483218792704, 0.056495242655475945, 0.04548761013688057, 0.05185226713721905]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 1276300.001, 31295.001, 0.001, 59650.001]
memory_state: [250994.999, 265089.999, 265089.999, -883084.0009999999, 34240.998999999996, 65535.999, 5885.999000000003]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.268079752320263, 0.24902625335677112, 0.23513932891773062, 0.07014247233260572, 0.06429039052457557, 0.051278846003716724, 0.0562318202429204]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 638150.0009999999, 0.001, 0.001, 20210.001]
memory_state: [219699.999, 265089.999, 265089.999, -244934.00099999993, 65535.999, 65535.999, 45325.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2771441210591729, 0.2550035755039518, 0.23926229494801896, 0.03889842219190735, 0.06513081251523278, 0.05190253923007002, 0.05687780123512278]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 0.001, 0.001, 0.001, 20210.001]
memory_state: [219699.999, 265089.999, 265089.999, 393215.999, 65535.999, 65535.999, 45325.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (2, 2)], layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 9146.020889282227, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 22.53913043478261
cost: 14941.220070731122
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (2, 2)]
sorted_stage_id:  [6, 4, 5, 0, 1, 2, 3]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.1989999154994159, 0.1989999154994159, 0.1989999154994159, 0.2545851795330243, 0.05685711871411884, 0.045778977627304526, 0.045778977627304526]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 1276300.001, 31295.001, 0.001, 31528.751]
memory_state: [250994.999, 265089.999, 265089.999, -883084.0009999999, 34240.998999999996, 65535.999, 34007.248999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.2689104339642029, 0.2502467491473415, 0.23656562115586816, 0.07059176470198242, 0.06472482287128697, 0.051630536516821694, 0.05127116831520713]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 638150.0009999999, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, -244934.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.28098607824104666, 0.2582115361710301, 0.24205436005510375, 0.03914758313092794, 0.06584180379960988, 0.05245908660351998, 0.052047944162991945]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 0.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 393215.999, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 9616.191864013672, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 22.53913043478261
cost: 14719.626213919599
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 0, 1, 2, 3]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19993415095580466, 0.19993415095580466, 0.19993415095580466, 0.2557803684897329, 0.05242939060214132, 0.04599389402035587, 0.04599389402035587]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 1276300.001, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -883084.0009999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.27057844093708927, 0.2515998954388724, 0.23771992463541586, 0.07092316850860281, 0.05967611547521922, 0.05190325408455663, 0.051538046733106614]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 638150.0009999999, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, -244934.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2827860762116142, 0.25962366548301796, 0.24323455069755587, 0.039331367431042104, 0.06070394240744596, 0.05273940871590279, 0.05232162989957494]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 0.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 393215.999, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 9616.191864013672, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 25.09913043478261
cost: 14722.186213919598
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 0, 1, 2, 3]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2012291605305546, 0.2012291605305546, 0.2012291605305546, 0.2574371040931491, 0.04629180477172901, 0.04629180477172901, 0.04629180477172901]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 1276300.001, 0.001, 0.001, 10335.001]
memory_state: [250994.999, 265089.999, 265089.999, -883084.0009999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.27289592645334193, 0.25347475253787155, 0.23931657593221867, 0.07138255066943511, 0.05267924057039996, 0.05228104409086414, 0.05190767141250809]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 638150.0009999999, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, -244934.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2852876653180864, 0.2615799423676907, 0.24486650257868098, 0.03958612379541364, 0.053584001875213644, 0.05312769373979762, 0.05270063775333335]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 0.001, 0.001, 0.001, 10335.001]
memory_state: [219699.999, 265089.999, 265089.999, 393215.999, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 9616.191864013672, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 30.219130434782613
cost: 14727.306213919599
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 0, 1, 2, 3]
Adjusting stage:  0
valid_strategies: [(2, 2), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.18779718408127127, 0.20461299130103036, 0.20461299130103036, 0.26176611680679257, 0.04707023883662513, 0.04707023883662513, 0.04707023883662513]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 1276300.001, 0.001, 0.001, 10335.001]
memory_state: [286599.999, 265089.999, 265089.999, -883084.0009999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.25622814086270845, 0.2602047160215081, 0.24479660573884388, 0.072582905880347, 0.053752155356867316, 0.05332611231867223, 0.05292723404224042]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [61290.001, 62590.001, 62590.001, 638150.0009999999, 0.001, 0.001, 10335.001]
memory_state: [266389.999, 265089.999, 265089.999, -244934.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.26808039104144654, 0.2688932166519731, 0.2506618484084494, 0.04025179642173483, 0.05469781377137022, 0.054209535508764985, 0.05375329439035121]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
stage_memory_demand: [61290.001, 62590.001, 62590.001, 0.001, 0.001, 0.001, 10335.001]
memory_state: [266389.999, 265089.999, 265089.999, 393215.999, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(2, 2), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 9806.54525756836, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 4.385414123535156, dp_cost: 12.587466032608695, pp_cost: 33.001739130434785
cost: 14906.021248238605
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 1, 2, 0, 3]
Adjusting stage:  1
valid_strategies: [(2, 2), (2, 2), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19100915724674114, 0.19100915724674114, 0.2081125721950709, 0.2662432113219521, 0.04787530066316492, 0.04787530066316492, 0.04787530066316492]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [41080.001, 40420.001, 62590.001, 1276300.001, 0.001, 0.001, 10335.001]
memory_state: [286599.999, 287259.999, 265089.999, -883084.0009999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.26226739279534506, 0.24371768296090465, 0.25059123157153257, 0.07382432143777415, 0.05487571519130426, 0.05441896037080677, 0.05399200735207531]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [61290.001, 40420.001, 62590.001, 638150.0009999999, 0.001, 0.001, 10335.001]
memory_state: [266389.999, 287259.999, 265089.999, -244934.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2746283467555423, 0.2519293339298404, 0.2567974378167883, 0.040940239598351455, 0.055864541198909726, 0.05534105714028594, 0.05485274653714535]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
stage_memory_demand: [61290.001, 40420.001, 62590.001, 0.001, 0.001, 0.001, 10335.001]
memory_state: [266389.999, 287259.999, 265089.999, 393215.999, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(2, 2), (2, 2), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 9965.54946899414, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 4.385414123535156, dp_cost: 12.587466032608695, pp_cost: 35.78434782608696
cost: 15067.808068360038
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 2, 0, 1, 3]
Adjusting stage:  2
valid_strategies: [(2, 2), (2, 2), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19433291370800712, 0.19433291370800712, 0.19433291370800712, 0.2708761179671368, 0.048708380302947274, 0.048708380302947274, 0.048708380302947274]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 1276300.001, 0.001, 0.001, 10335.001]
memory_state: [286599.999, 287259.999, 287259.999, -883084.0009999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.2686083666958754, 0.248811778555228, 0.2342915621665568, 0.07510894081892985, 0.056054379170705, 0.0555636371783317, 0.05510567870626842]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 638150.0009999999, 0.001, 0.001, 10335.001]
memory_state: [266389.999, 287259.999, 287259.999, -244934.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2815109460412032, 0.2572680146183266, 0.2400971334459354, 0.041652642018487895, 0.0570890368027808, 0.05652664177669364, 0.05600296636033547]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 0.001, 0.001, 10335.001, 10335.001]
memory_state: [266389.999, 287259.999, 287259.999, 393215.999, 65535.999, 55200.998999999996, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 14136.821746826172, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 3.289060592651367, dp_cost: 8.271908967391305, pp_cost: 38.56695652173913
cost: 19236.45104429162
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [5, 6, 4, 0, 1, 2, 3]
Adjusting stage:  0
valid_strategies: [(1, 4), (2, 2), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.17464524586662136, 0.19908172611554953, 0.19908172611554953, 0.27749537687374703, 0.04989864167617753, 0.04989864167617753, 0.04989864167617753]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [23293.751, 40420.001, 40420.001, 1276300.001, 0.001, 0.001, 10335.001]
memory_state: [304386.249, 287259.999, 287259.999, -883084.0009999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.24368567542441416, 0.2587586712700378, 0.2423150543430601, 0.07694433896776953, 0.05774897473420479, 0.057206803869461816, 0.056702077179940885]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [33628.751, 40420.001, 40420.001, 638150.0009999999, 0.001, 10335.001, 31528.751]
memory_state: [294051.249, 287259.999, 287259.999, -244934.00099999993, 65535.999, 55200.998999999996, 34007.248999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2557101141307975, 0.2681316640376409, 0.24861404553990696, 0.04267048598248834, 0.05885322463930402, 0.058231754481724685, 0.05765456738152177]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
stage_memory_demand: [33628.751, 40420.001, 40420.001, 0.001, 0.001, 10335.001, 10335.001]
memory_state: [294051.249, 287259.999, 287259.999, 393215.999, 65535.999, 55200.998999999996, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (2, 2), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 14459.747314453125, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 2.192707061767578, dp_cost: 4.195822010869565, pp_cost: 44.13217391304348
cost: 19559.76938882247
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [5, 6, 4, 1, 2, 0, 3]
Adjusting stage:  1
valid_strategies: [(1, 4), (1, 4), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.17901986116822455, 0.17901986116822455, 0.2040684405320403, 0.28444624184446105, 0.05114853176234987, 0.05114853176234987, 0.05114853176234987]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [23293.751, 20670.001, 40420.001, 1276300.001, 0.001, 0.001, 10335.001]
memory_state: [304386.249, 307009.999, 287259.999, -883084.0009999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.25232079280863073, 0.23398209713943036, 0.2510463752349944, 0.07887168534900005, 0.05956523763086676, 0.05896360268374569, 0.058404973232510045]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [33628.751, 20670.001, 40420.001, 638150.0009999999, 0.001, 0.001, 10335.001]
memory_state: [294051.249, 307009.999, 287259.999, -244934.00099999993, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.26511864684957775, 0.2425745924997298, 0.25790616882132333, 0.04373932103711328, 0.060745932949740546, 0.060056227502269355, 0.05941744881529384]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
stage_memory_demand: [33628.751, 20670.001, 40420.001, 0.001, 0.001, 0.001, 10335.001]
memory_state: [294051.249, 307009.999, 287259.999, 393215.999, 65535.999, 65535.999, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 7, 8]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 10716.148376464844, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 2.192707061767578, dp_cost: 4.195822010869565, pp_cost: 49.697391304347825
cost: 15821.735668225496
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [6, 4, 5, 2, 0, 1, 3]
Adjusting stage:  2
valid_strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.18361926284635685, 0.18361926284635685, 0.18361926284635685, 0.2917542718783379, 0.05246264652753053, 0.05246264652753053, 0.05246264652753053]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [23293.751, 20670.001, 20670.001, 1276300.001, 0.001, 0.001, 10335.001]
memory_state: [304386.249, 307009.999, 307009.999, -883084.0009999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.26161446437340297, 0.24139348619972434, 0.22641498384885128, 0.080898067000645, 0.061519941977793896, 0.06084903120370032, 0.06022781752398403]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [33628.751, 20670.001, 20670.001, 638150.0009999999, 0.001, 10335.001, 31528.751]
memory_state: [294051.249, 307009.999, 307009.999, -244934.00099999993, 65535.999, 55200.998999999996, 34007.248999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2752633856524174, 0.2503748427518629, 0.23260936415943803, 0.044863077391663383, 0.06278519737755568, 0.062016071699695724, 0.06130587475027109]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
stage_memory_demand: [33628.751, 20670.001, 20670.001, 0.001, 0.001, 10335.001, 10335.001]
memory_state: [294051.249, 307009.999, 307009.999, 393215.999, 65535.999, 55200.998999999996, 55200.998999999996]
layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 7, 7, 8, 9]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 14997.085571289062, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 1.6445302963256836, dp_cost: 0.0, pp_cost: 55.262608695652176
cost: 20103.494081664707
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [5, 6, 4, 0, 1, 2, 3]
Adjusting stage:  3
valid_strategies: [(1, 4), (1, 4), (1, 4), (4, 2), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.18814762068288302, 0.18814762068288302, 0.18814762068288302, 0.27428774879459417, 0.05375646305225229, 0.05375646305225229, 0.05375646305225229]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [23293.751, 20670.001, 20670.001, 427660.001, 0.001, 0.001, 10335.001]
memory_state: [304386.249, 307009.999, 307009.999, -34444.00099999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.20437094462169622, 0.2001648976745965, 0.19704930734341153, 0.2269767994669523, 0.05564041790104139, 0.055500865690019975, 0.05537165067981496]
layer_partition: [0, 3, 5, 6, 8, 8, 8, 9]
stage_memory_demand: [33628.751, 20670.001, 10335.001, 427660.001, 0.001, 0.001, 10335.001]
memory_state: [294051.249, 307009.999, 317344.999, -34444.00099999999, 65535.999, 65535.999, 55200.998999999996]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.2181437268299465, 0.21006506895338875, 0.2042555729784546, 0.18782635288184785, 0.05715322049745632, 0.0569005626433885, 0.05666718574284372]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [33628.751, 20670.001, 20670.001, 213830.001, 0.001, 10335.001, 31528.751]
memory_state: [294051.249, 307009.999, 307009.999, 179385.999, 65535.999, 55200.998999999996, 34007.248999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (4, 2), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 11852.129697799683, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 1.6445302963256836, dp_cost: 3.146866508152174, pp_cost: 78.41391304347826
cost: 16984.836379031305
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (4, 2), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [6, 5, 4, 3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(1, 4), (1, 4), (1, 4), (2, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19466073414905452, 0.19466073414905452, 0.19466073414905452, 0.2491657397107898, 0.055617352614015576, 0.055617352614015576, 0.055617352614015576]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [23293.751, 20670.001, 20670.001, 124020.001, 0.001, 10335.001, 31528.751]
memory_state: [304386.249, 307009.999, 307009.999, 269195.999, 65535.999, 55200.998999999996, 34007.248999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (2, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
data loadbalancer: [100, 28]
execution_cost: 11705.696105957031, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 1.096353530883789, dp_cost: 2.0979110054347827, pp_cost: 81.19652173913045
cost: 16839.588263616148


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.1111111111111111, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [16988.751, 11405.001, 5702.501, 11405.001, 5702.501, 5702.501, 15338.751]
memory_state: [310691.249, 316274.999, 321977.499, 316274.999, 125369.499, 59833.498999999996, 50197.248999999996]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
execution_cost: 4658.583581447601, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.6778260869565218
cost: 12320.617770831066


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.09293012755243117, 0.05669186702797304, 0.05669186702797304]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [32487.501, 21195.001, 21195.001, 21195.001, 5702.501, 0.001, 31160.001]
memory_state: [295192.499, 306484.999, 306484.999, 306484.999, 125369.499, 65535.999, 34375.998999999996]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
execution_cost: 2408.8594913482666, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 1.0978260869565217
cost: 9510.301714109337


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.09798779357278413, 0.056375762901700995, 0.056375762901700995]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 41460.001, 10597.501, 0.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 286219.999, 120474.499, 65535.999, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
execution_cost: 2096.7085361480713, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.8478260869565217
cost: 8428.372949931932


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.11083249740828255, 0.05557296891198233, 0.05557296891198233]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 24192.501, 48385.001, 20730.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 303487.499, 279294.999, 110341.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19667390983159458, 0.1962273019387355, 0.1958726732460163, 0.19559108057443444, 0.11132373155028326, 0.0557903748854387, 0.04504365860258964]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 20730.001, 0.001, 24192.501]
memory_state: [263097.499, 279294.999, 279294.999, 303487.499, 110341.999, 65535.999, 41343.498999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9]
execution_cost: 3753.437101840973, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 0.9356521739130435
cost: 9844.699977087768
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [6, 5, 4, 0, 1, 2, 3]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19529402507249022, 0.19529402507249022, 0.19529402507249022, 0.19529402507249022, 0.11128187447689099, 0.055798292877854344, 0.05174373235529376]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 24192.501, 48385.001, 20730.001, 24192.501, 59650.001]
memory_state: [263097.499, 279294.999, 303487.499, 279294.999, 110341.999, 41343.498999999996, 5885.999000000003]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2)], layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
execution_cost: 3755.7819485664368, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 2.7756521739130435
cost: 9537.350323691162


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.11009614959318086, 0.0556189906504262, 0.0556189906504262]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 62590.001, 24192.501, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 296384.999, 265089.999, 106879.499, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20302004144724112, 0.2012981085019017, 0.19993111980050368, 0.19884591023133463, 0.11197264745806879, 0.05645645468344928, 0.025153669138061868]
layer_partition: [0, 3, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 24192.501, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 106879.499, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20589922437820815, 0.20355630978320052, 0.20170926805069775, 0.20025046585176987, 0.11260168899226615, 0.056737062192218926, 0.01137573810146513]
layer_partition: [0, 3, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 24192.501, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 106879.499, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20589922437820815, 0.20355630978320052, 0.20170926805069775, 0.20025046585176987, 0.11260168899226615, 0.056737062192218926, 0.00514467359186615]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.10291942203028147, 0.05606753612310741, 0.05606753612310741]
layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 62590.001, 20210.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 296384.999, 265089.999, 110861.999, 65535.999, 34240.998999999996]
layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
execution_cost: 4185.7112646102905, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 2.031304347826087
cost: 10078.587637184806


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.11111111111111112, 0.05555555555555556, 0.05555555555555556]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 62590.001, 31295.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 296384.999, 265089.999, 99776.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2027786656069955, 0.20106279654411735, 0.1997001946412435, 0.19861812842425547, 0.11300505174060521, 0.05639111759797942, 0.02512498063851418]
layer_partition: [0, 3, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 99776.999, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.11363993987399874, 0.05667108552686816, 0.011362763737542823]
layer_partition: [0, 3, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 99776.999, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.11363993987399874, 0.05667108552686816, 0.0051388059403039395]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.10291942203028147, 0.05606753612310741, 0.05606753612310741]
layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 62590.001, 20210.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 296384.999, 265089.999, 110861.999, 65535.999, 34240.998999999996]
layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
execution_cost: 5107.582807540894, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 4.062608695652174
cost: 10998.592054592631


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.11111111111111112, 0.05555555555555556, 0.05555555555555556]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 62590.001, 31295.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 296384.999, 265089.999, 99776.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2027786656069955, 0.20106279654411735, 0.1997001946412435, 0.19861812842425547, 0.11300505174060521, 0.05639111759797942, 0.02512498063851418]
layer_partition: [0, 3, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 99776.999, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.11363993987399874, 0.05667108552686816, 0.011362763737542823]
layer_partition: [0, 3, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 99776.999, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.11363993987399874, 0.05667108552686816, 0.0051388059403039395]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.10291942203028147, 0.05606753612310741, 0.05606753612310741]
layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 62590.001, 20210.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 296384.999, 265089.999, 110861.999, 65535.999, 34240.998999999996]
layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
execution_cost: 6951.3258934021, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 8.125217391304348
cost: 12844.448534214185


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.11111111111111112, 0.05555555555555556, 0.05555555555555556]
layer_partition: [0, 2, 4, 5, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 62590.001, 31295.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 296384.999, 265089.999, 99776.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2027786656069955, 0.20106279654411735, 0.1997001946412435, 0.19861812842425547, 0.11300505174060521, 0.05639111759797942, 0.02512498063851418]
layer_partition: [0, 3, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 99776.999, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.11363993987399874, 0.05667108552686816, 0.011362763737542823]
layer_partition: [0, 3, 5, 7, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 99776.999, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.11363993987399874, 0.05667108552686816, 0.0051388059403039395]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 131072, 65536, 65536]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.10291942203028147, 0.05606753612310741, 0.05606753612310741]
layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
stage_memory_demand: [76685.001, 62590.001, 31295.001, 62590.001, 20210.001, 0.001, 31295.001]
memory_state: [250994.999, 265089.999, 296384.999, 265089.999, 110861.999, 65535.999, 34240.998999999996]
layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 8, 8, 9]
execution_cost: 10638.812065124512, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 16.250434782608696
cost: 16539.085315860248


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 4), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.05555555555555555, 0.1111111111111111, 0.05555555555555555]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [16988.751, 11405.001, 11405.001, 5702.501, 5702.501, 5702.501, 15338.751]
memory_state: [310691.249, 316274.999, 316274.999, 321977.499, 59833.498999999996, 125369.499, 50197.248999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)], layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
execution_cost: 4658.583581447601, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5528260869565218
cost: 12320.492770831066


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.05669186702797304, 0.09293012755243117, 0.05669186702797304]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [32487.501, 21195.001, 21195.001, 21195.001, 0.001, 5702.501, 31160.001]
memory_state: [295192.499, 306484.999, 306484.999, 306484.999, 65535.999, 125369.499, 34375.998999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 2408.8594913482666, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 0.6778260869565218
cost: 9509.881714109337


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.056375762901700995, 0.09798779357278413, 0.056375762901700995]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 41460.001, 0.001, 10597.501, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 286219.999, 65535.999, 120474.499, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 2096.7085361480713, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 0.9278260869565218
cost: 8427.452949931932


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.05557296891198233, 0.11083249740828255, 0.05557296891198233]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 24192.501, 20730.001, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 303487.499, 41343.498999999996, 110341.999, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19667390983159458, 0.1962273019387355, 0.1958726732460163, 0.19559108057443444, 0.05581928060160658, 0.11129482583411537, 0.04504365860258964]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 24192.501, 20730.001, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 303487.499, 41343.498999999996, 110341.999, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19667390983159458, 0.1962273019387355, 0.1958726732460163, 0.19559108057443444, 0.05581928060160658, 0.11129482583411537, 0.0365093177497879]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 24192.501, 20730.001, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 303487.499, 41343.498999999996, 110341.999, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19667390983159458, 0.1962273019387355, 0.1958726732460163, 0.19559108057443444, 0.05581928060160658, 0.11129482583411537, 0.029591963084418395]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1964607054511319, 0.1964607054511319, 0.1964607054511319, 0.1964607054511319, 0.05613163012889483, 0.1018939179376827, 0.05613163012889483]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 48385.001, 0.001, 13037.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 279294.999, 65535.999, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.198674351840531, 0.19821359423368368, 0.19784874063990923, 0.19755982919729417, 0.05638030085407228, 0.1023184769154876, 0.04549647128511825]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 48385.001, 0.001, 13037.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 279294.999, 65535.999, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.198674351840531, 0.19821359423368368, 0.19784874063990923, 0.19755982919729417, 0.05638030085407228, 0.1023184769154876, 0.03687633682906448]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 48385.001, 0.001, 13037.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 279294.999, 65535.999, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.198674351840531, 0.19821359423368368, 0.19784874063990923, 0.19755982919729417, 0.05638030085407228, 0.1023184769154876, 0.029889443719900634]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.18482345856725121, 0.19930594494075732, 0.19930594494075732, 0.19930594494075732, 0.056944555697359234, 0.10336959521575834, 0.056944555697359234]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 48385.001, 48385.001, 48385.001, 0.001, 13037.501, 72770.001]
memory_state: [286599.999, 279294.999, 279294.999, 279294.999, 65535.999, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.18693796203137994, 0.20113925717090034, 0.20075180378350135, 0.20044623504452108, 0.05720149868560792, 0.10380785157255089, 0.04615537331054759]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 48385.001, 48385.001, 48385.001, 0.001, 13037.501, 72770.001]
memory_state: [286599.999, 279294.999, 279294.999, 279294.999, 65535.999, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.18693796203137994, 0.20113925717090034, 0.20075180378350135, 0.20044623504452108, 0.05720149868560792, 0.10380785157255089, 0.03741039787469622]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 48385.001, 48385.001, 48385.001, 0.001, 13037.501, 72770.001]
memory_state: [286599.999, 279294.999, 279294.999, 279294.999, 65535.999, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.18693796203137994, 0.20113925717090034, 0.20075180378350135, 0.20044623504452108, 0.05720149868560792, 0.10380785157255089, 0.030322317181285766]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
valid_strategies: [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.18753949677377155, 0.18753949677377155, 0.20223480778880737, 0.20223480778880737, 0.05778137365394496, 0.10488864356695227, 0.05778137365394496]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 48385.001, 24192.501, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 279294.999, 303487.499, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.1897185370076543, 0.18928482014249642, 0.20374228139993664, 0.20341872206087358, 0.05804703156250592, 0.10534131042371407, 0.04683364087636117]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 48385.001, 24192.501, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 279294.999, 303487.499, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.1897185370076543, 0.18928482014249642, 0.20374228139993664, 0.20341872206087358, 0.05804703156250592, 0.10534131042371407, 0.03796015530666112]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 48385.001, 24192.501, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 279294.999, 303487.499, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.1897185370076543, 0.18928482014249642, 0.20374228139993664, 0.20341872206087358, 0.05804703156250592, 0.10534131042371407, 0.03076791306296133]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
valid_strategies: [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19033655159701915, 0.19033655159701915, 0.19033655159701915, 0.20525103559300473, 0.058643153026572775, 0.1064530035627922, 0.058643153026572775]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 24192.501, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 303487.499, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.1925831298449711, 0.19212888557194877, 0.19176648669080704, 0.20648123885067093, 0.05891800242388041, 0.10692084746580448, 0.04753214046368539]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 24192.501, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 303487.499, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.1925831298449711, 0.19212888557194877, 0.19176648669080704, 0.20648123885067093, 0.05891800242388041, 0.10692084746580448, 0.03852631143546744]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 24192.501, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 303487.499, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.1925831298449711, 0.19212888557194877, 0.19176648669080704, 0.20648123885067093, 0.05891800242388041, 0.10692084746580448, 0.031226800609928735]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19321830288310066, 0.19321830288310066, 0.19321830288310066, 0.19321830288310066, 0.05953102758475012, 0.10806473329809713, 0.05953102758475012]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19553560947065163, 0.19505952141326835, 0.1946812451170049, 0.19438068526448254, 0.05981558242367893, 0.10854857960102342, 0.0482517910287615]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19553560947065163, 0.19505952141326835, 0.1946812451170049, 0.19438068526448254, 0.05981558242367893, 0.10854857960102342, 0.03910961110437283]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 24192.501, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 41343.498999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19553560947065163, 0.19505952141326835, 0.1946812451170049, 0.19438068526448254, 0.05981558242367893, 0.10854857960102342, 0.03169958354133539]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1940577575795118, 0.1940577575795118, 0.1940577575795118, 0.1940577575795118, 0.05544507359414623, 0.10853423047579663, 0.05978966561201006]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 20210.001, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 45325.998999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19639588641869762, 0.19591330074305757, 0.19553031990117598, 0.19522638563074038, 0.05571005224530927, 0.10902234046315833, 0.048461425374912694]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 20210.001, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 45325.998999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19639588641869762, 0.19591330074305757, 0.19553031990117598, 0.19522638563074038, 0.05571005224530927, 0.10902234046315833, 0.03927952640859866]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 20210.001, 13037.501, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 45325.998999999996, 118034.499, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19639588641869762, 0.19591330074305757, 0.19553031990117598, 0.19522638563074038, 0.05571005224530927, 0.10902234046315833, 0.031837305298958694]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19626681959999057, 0.19626681959999057, 0.19626681959999057, 0.19626681959999057, 0.05607623417142588, 0.09838620445212203, 0.06047028297648981]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19866021631526148, 0.19816023813167039, 0.197764704891315, 0.1974517981498601, 0.0563440735183436, 0.09882808299101561, 0.049013087393423464]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19866021631526148, 0.19816023813167039, 0.197764704891315, 0.1974517981498601, 0.0563440735183436, 0.09882808299101561, 0.0397266660182382]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 72770.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, -7234.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19866021631526148, 0.19816023813167039, 0.197764704891315, 0.1974517981498601, 0.0563440735183436, 0.09882808299101561, 0.0321997261722469]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.05632372336075597, 0.09882042622790466, 0.05632372336075597]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 59650.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 2470.5498218536377, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 2.711304347826087
cost: 8237.513146166593


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.0556189906504262, 0.11009614959318086, 0.0556189906504262]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 24192.501, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 106879.499, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20302004144724112, 0.2012981085019017, 0.19993111980050368, 0.19884591023133463, 0.056566970371682596, 0.11186213176983546, 0.025153669138061868]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 24192.501, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 106879.499, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20589922437820815, 0.20355630978320052, 0.20170926805069775, 0.20025046585176987, 0.056884753103762994, 0.11245396267349514, 0.01137573810146513]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 24192.501, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 106879.499, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20589922437820815, 0.20355630978320052, 0.20170926805069775, 0.20025046585176987, 0.056884753103762994, 0.11245396267349514, 0.00514467359186615]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.05606753612310741, 0.10291942203028147, 0.05606753612310741]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20472734480843877, 0.20296213709436292, 0.20156390263177942, 0.2004563504741685, 0.057022585709217005, 0.10456841105875885, 0.025356523671760823]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 20210.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20765482869252613, 0.20525265508931836, 0.2033633136373425, 0.2018745129300041, 0.05734274496839094, 0.10512105357288516, 0.011467478993634308]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 20210.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20765482869252613, 0.20525265508931836, 0.2033633136373425, 0.2018745129300041, 0.05734274496839094, 0.10512105357288516, 0.0051861633783773405]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1830612889655655, 0.19945303285515112, 0.19945303285515112, 0.19945303285515112, 0.05698658081575747, 0.104606450837466, 0.05698658081575747]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19112044204403306, 0.20652926215425615, 0.20503259692534997, 0.20385248543046428, 0.05797770704092559, 0.10631585138668886, 0.02577216131371854]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.193899503795366, 0.20894117792697384, 0.2069176533191551, 0.20533087179553308, 0.05830988607664459, 0.10688860321156231, 0.011655450972357165]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.193899503795366, 0.20894117792697384, 0.2069176533191551, 0.20533087179553308, 0.05830988607664459, 0.10688860321156231, 0.00527117364024525]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
valid_strategies: [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1861119890244354, 0.1861119890244354, 0.20277689986445338, 0.20277689986445338, 0.05793625710412954, 0.1063497080139631, 0.05793625710412954]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 62590.001, 31295.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 265089.999, 296384.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19445122386228164, 0.19280374342975534, 0.2086274662493809, 0.20736814624801883, 0.05896568336416817, 0.1081231447989253, 0.026201652084166215]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 20210.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 307469.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19732728656109644, 0.19508397313457868, 0.21060457823980472, 0.20891080165740783, 0.059310597288601996, 0.10871716729758601, 0.011849688023611695]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 20210.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 307469.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19732728656109644, 0.19508397313457868, 0.21060457823980472, 0.20891080165740783, 0.059310597288601996, 0.10871716729758601, 0.005359017278982189]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
valid_strategies: [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.18926609156541166, 0.18926609156541166, 0.18926609156541166, 0.20621342826042782, 0.05891812236012225, 0.10815205232309238, 0.05891812236012225]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 31295.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 296384.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19790052079945752, 0.1961640038046511, 0.1947767271813288, 0.21100998795185721, 0.05998827074588578, 0.10999346728618971, 0.026645700304002255]
layer_partition: [0, 3, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 20210.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 307469.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20087876147646327, 0.19851371521138875, 0.1966379163033294, 0.21262134851200962, 0.060346696817475176, 0.11061002035983947, 0.012050508676278745]
layer_partition: [0, 3, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 20210.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 307469.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20087876147646327, 0.19851371521138875, 0.1966379163033294, 0.21262134851200962, 0.060346696817475176, 0.11061002035983947, 0.00544983834916351]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19252894440986165, 0.19252894440986165, 0.19252894440986165, 0.19252894440986165, 0.05993384134888753, 0.1100165396627781, 0.05993384134888753]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2014748126691745, 0.19964266654100565, 0.19818575055681636, 0.19702721622794836, 0.061047356621967655, 0.11193022969388305, 0.027105058862686434]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2045607845632613, 0.20206497615905414, 0.20009511508461666, 0.1985373105905116, 0.06142014139426519, 0.11257068288641904, 0.01225825342435411]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2045607845632613, 0.20206497615905414, 0.20009511508461666, 0.1985373105905116, 0.06142014139426519, 0.11257068288641904, 0.005543790839080148]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19348195360971165, 0.19348195360971165, 0.19348195360971165, 0.19348195360971165, 0.05528055817420333, 0.11056111634840667, 0.06023051103854337]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 20210.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 45325.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20251749280482817, 0.20065723473524535, 0.19917997097410606, 0.19800684975202487, 0.05630721528212314, 0.11249364737507923, 0.0272392276264419]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20563525819680784, 0.20310085327983401, 0.2011033925769994, 0.1995259740082879, 0.05665094934129887, 0.11314047989383495, 0.012318931201003799]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20563525819680784, 0.20310085327983401, 0.2011033925769994, 0.1995259740082879, 0.05665094934129887, 0.11314047989383495, 0.005571232342423356]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19614380785722008, 0.19614380785722008, 0.19614380785722008, 0.19614380785722008, 0.05604108795920574, 0.09832454013973903, 0.061059140472174964]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20543419215233288, 0.20349344015117202, 0.2019581093048703, 0.2007435075390622, 0.05708075281975349, 0.10003976829723223, 0.02761397499901884]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 10335.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20864173676785042, 0.2059969131079176, 0.20392078753363957, 0.20228767744969278, 0.05742884672448486, 0.1006138913519013, 0.012488410569649732]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 10335.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20864173676785042, 0.2059969131079176, 0.20392078753363957, 0.20228767744969278, 0.05742884672448486, 0.1006138913519013, 0.005647879327828776]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.05632372336075597, 0.09882042622790466, 0.05632372336075597]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 59650.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 2917.044162750244, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 5.422608695652174
cost: 8678.921931669815


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.11111111111111112, 0.05555555555555556]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2027786656069955, 0.20106279654411735, 0.1997001946412435, 0.19861812842425547, 0.056502525870302606, 0.11289364346828203, 0.02512498063851418]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.05681996993699937, 0.11349101906257242, 0.011362763737542823]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.05681996993699937, 0.11349101906257242, 0.0051388059403039395]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.05606753612310741, 0.10291942203028147, 0.05606753612310741]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20472734480843877, 0.20296213709436292, 0.20156390263177942, 0.2004563504741685, 0.057022585709217005, 0.10456841105875885, 0.025356523671760823]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 20210.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20765482869252613, 0.20525265508931836, 0.2033633136373425, 0.2018745129300041, 0.05734274496839094, 0.10512105357288516, 0.011467478993634308]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 20210.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20765482869252613, 0.20525265508931836, 0.2033633136373425, 0.2018745129300041, 0.05734274496839094, 0.10512105357288516, 0.0051861633783773405]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1830612889655655, 0.19945303285515112, 0.19945303285515112, 0.19945303285515112, 0.05698658081575747, 0.104606450837466, 0.05698658081575747]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19112044204403306, 0.20652926215425615, 0.20503259692534997, 0.20385248543046428, 0.05797770704092559, 0.10631585138668886, 0.02577216131371854]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.193899503795366, 0.20894117792697384, 0.2069176533191551, 0.20533087179553308, 0.05830988607664459, 0.10688860321156231, 0.011655450972357165]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.193899503795366, 0.20894117792697384, 0.2069176533191551, 0.20533087179553308, 0.05830988607664459, 0.10688860321156231, 0.00527117364024525]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
valid_strategies: [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1861119890244354, 0.1861119890244354, 0.20277689986445338, 0.20277689986445338, 0.05793625710412954, 0.1063497080139631, 0.05793625710412954]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 62590.001, 31295.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 265089.999, 296384.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19445122386228164, 0.19280374342975534, 0.2086274662493809, 0.20736814624801883, 0.05896568336416817, 0.1081231447989253, 0.026201652084166215]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 20210.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 307469.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19732728656109644, 0.19508397313457868, 0.21060457823980472, 0.20891080165740783, 0.059310597288601996, 0.10871716729758601, 0.011849688023611695]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 20210.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 307469.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19732728656109644, 0.19508397313457868, 0.21060457823980472, 0.20891080165740783, 0.059310597288601996, 0.10871716729758601, 0.005359017278982189]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
valid_strategies: [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.18926609156541166, 0.18926609156541166, 0.18926609156541166, 0.20621342826042782, 0.05891812236012225, 0.10815205232309238, 0.05891812236012225]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 31295.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 296384.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19790052079945752, 0.1961640038046511, 0.1947767271813288, 0.21100998795185721, 0.05998827074588578, 0.10999346728618971, 0.026645700304002255]
layer_partition: [0, 3, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 20210.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 307469.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20087876147646327, 0.19851371521138875, 0.1966379163033294, 0.21262134851200962, 0.060346696817475176, 0.11061002035983947, 0.012050508676278745]
layer_partition: [0, 3, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 20210.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 307469.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20087876147646327, 0.19851371521138875, 0.1966379163033294, 0.21262134851200962, 0.060346696817475176, 0.11061002035983947, 0.00544983834916351]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19252894440986165, 0.19252894440986165, 0.19252894440986165, 0.19252894440986165, 0.05993384134888753, 0.1100165396627781, 0.05993384134888753]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2014748126691745, 0.19964266654100565, 0.19818575055681636, 0.19702721622794836, 0.061047356621967655, 0.11193022969388305, 0.027105058862686434]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2045607845632613, 0.20206497615905414, 0.20009511508461666, 0.1985373105905116, 0.06142014139426519, 0.11257068288641904, 0.01225825342435411]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2045607845632613, 0.20206497615905414, 0.20009511508461666, 0.1985373105905116, 0.06142014139426519, 0.11257068288641904, 0.005543790839080148]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19348195360971165, 0.19348195360971165, 0.19348195360971165, 0.19348195360971165, 0.05528055817420333, 0.11056111634840667, 0.06023051103854337]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 20210.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 45325.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20251749280482817, 0.20065723473524535, 0.19917997097410606, 0.19800684975202487, 0.05630721528212314, 0.11249364737507923, 0.0272392276264419]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20563525819680784, 0.20310085327983401, 0.2011033925769994, 0.1995259740082879, 0.05665094934129887, 0.11314047989383495, 0.012318931201003799]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20563525819680784, 0.20310085327983401, 0.2011033925769994, 0.1995259740082879, 0.05665094934129887, 0.11314047989383495, 0.005571232342423356]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19614380785722008, 0.19614380785722008, 0.19614380785722008, 0.19614380785722008, 0.05604108795920574, 0.09832454013973903, 0.061059140472174964]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20543419215233288, 0.20349344015117202, 0.2019581093048703, 0.2007435075390622, 0.05708075281975349, 0.10003976829723223, 0.02761397499901884]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 10335.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20864173676785042, 0.2059969131079176, 0.20392078753363957, 0.20228767744969278, 0.05742884672448486, 0.1006138913519013, 0.012488410569649732]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 10335.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20864173676785042, 0.2059969131079176, 0.20392078753363957, 0.20228767744969278, 0.05742884672448486, 0.1006138913519013, 0.005647879327828776]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.05632372336075597, 0.09882042622790466, 0.05632372336075597]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 59650.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 3810.032844543457, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 10.845217391304349
cost: 9573.434792288075


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.11111111111111112, 0.05555555555555556]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2027786656069955, 0.20106279654411735, 0.1997001946412435, 0.19861812842425547, 0.056502525870302606, 0.11289364346828203, 0.02512498063851418]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.05681996993699937, 0.11349101906257242, 0.011362763737542823]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.05681996993699937, 0.11349101906257242, 0.0051388059403039395]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.05606753612310741, 0.10291942203028147, 0.05606753612310741]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20472734480843877, 0.20296213709436292, 0.20156390263177942, 0.2004563504741685, 0.057022585709217005, 0.10456841105875885, 0.025356523671760823]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 20210.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20765482869252613, 0.20525265508931836, 0.2033633136373425, 0.2018745129300041, 0.05734274496839094, 0.10512105357288516, 0.011467478993634308]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 20210.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20765482869252613, 0.20525265508931836, 0.2033633136373425, 0.2018745129300041, 0.05734274496839094, 0.10512105357288516, 0.0051861633783773405]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1830612889655655, 0.19945303285515112, 0.19945303285515112, 0.19945303285515112, 0.05698658081575747, 0.104606450837466, 0.05698658081575747]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19112044204403306, 0.20652926215425615, 0.20503259692534997, 0.20385248543046428, 0.05797770704092559, 0.10631585138668886, 0.02577216131371854]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.193899503795366, 0.20894117792697384, 0.2069176533191551, 0.20533087179553308, 0.05830988607664459, 0.10688860321156231, 0.011655450972357165]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.193899503795366, 0.20894117792697384, 0.2069176533191551, 0.20533087179553308, 0.05830988607664459, 0.10688860321156231, 0.00527117364024525]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
valid_strategies: [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1861119890244354, 0.1861119890244354, 0.20277689986445338, 0.20277689986445338, 0.05793625710412954, 0.1063497080139631, 0.05793625710412954]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 62590.001, 31295.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 265089.999, 296384.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19445122386228164, 0.19280374342975534, 0.2086274662493809, 0.20736814624801883, 0.05896568336416817, 0.1081231447989253, 0.026201652084166215]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 20210.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 307469.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19732728656109644, 0.19508397313457868, 0.21060457823980472, 0.20891080165740783, 0.059310597288601996, 0.10871716729758601, 0.011849688023611695]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 20210.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 307469.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19732728656109644, 0.19508397313457868, 0.21060457823980472, 0.20891080165740783, 0.059310597288601996, 0.10871716729758601, 0.005359017278982189]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
valid_strategies: [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.18926609156541166, 0.18926609156541166, 0.18926609156541166, 0.20621342826042782, 0.05891812236012225, 0.10815205232309238, 0.05891812236012225]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 31295.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 296384.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19790052079945752, 0.1961640038046511, 0.1947767271813288, 0.21100998795185721, 0.05998827074588578, 0.10999346728618971, 0.026645700304002255]
layer_partition: [0, 3, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 20210.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 307469.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20087876147646327, 0.19851371521138875, 0.1966379163033294, 0.21262134851200962, 0.060346696817475176, 0.11061002035983947, 0.012050508676278745]
layer_partition: [0, 3, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 20210.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 307469.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20087876147646327, 0.19851371521138875, 0.1966379163033294, 0.21262134851200962, 0.060346696817475176, 0.11061002035983947, 0.00544983834916351]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19252894440986165, 0.19252894440986165, 0.19252894440986165, 0.19252894440986165, 0.05993384134888753, 0.1100165396627781, 0.05993384134888753]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2014748126691745, 0.19964266654100565, 0.19818575055681636, 0.19702721622794836, 0.061047356621967655, 0.11193022969388305, 0.027105058862686434]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2045607845632613, 0.20206497615905414, 0.20009511508461666, 0.1985373105905116, 0.06142014139426519, 0.11257068288641904, 0.01225825342435411]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2045607845632613, 0.20206497615905414, 0.20009511508461666, 0.1985373105905116, 0.06142014139426519, 0.11257068288641904, 0.005543790839080148]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19348195360971165, 0.19348195360971165, 0.19348195360971165, 0.19348195360971165, 0.05528055817420333, 0.11056111634840667, 0.06023051103854337]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 20210.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 45325.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20251749280482817, 0.20065723473524535, 0.19917997097410606, 0.19800684975202487, 0.05630721528212314, 0.11249364737507923, 0.0272392276264419]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20563525819680784, 0.20310085327983401, 0.2011033925769994, 0.1995259740082879, 0.05665094934129887, 0.11314047989383495, 0.012318931201003799]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20563525819680784, 0.20310085327983401, 0.2011033925769994, 0.1995259740082879, 0.05665094934129887, 0.11314047989383495, 0.005571232342423356]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19614380785722008, 0.19614380785722008, 0.19614380785722008, 0.19614380785722008, 0.05604108795920574, 0.09832454013973903, 0.061059140472174964]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20543419215233288, 0.20349344015117202, 0.2019581093048703, 0.2007435075390622, 0.05708075281975349, 0.10003976829723223, 0.02761397499901884]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 10335.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20864173676785042, 0.2059969131079176, 0.20392078753363957, 0.20228767744969278, 0.05742884672448486, 0.1006138913519013, 0.012488410569649732]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 10335.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20864173676785042, 0.2059969131079176, 0.20392078753363957, 0.20228767744969278, 0.05742884672448486, 0.1006138913519013, 0.005647879327828776]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.05632372336075597, 0.09882042622790466, 0.05632372336075597]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 59650.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 5596.010208129883, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 21.690434782608698
cost: 11368.308158330503


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.11111111111111112, 0.05555555555555556]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2027786656069955, 0.20106279654411735, 0.1997001946412435, 0.19861812842425547, 0.056502525870302606, 0.11289364346828203, 0.02512498063851418]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.05681996993699937, 0.11349101906257242, 0.011362763737542823]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 99776.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2056510518714085, 0.20331643905581465, 0.20147533527149442, 0.20002075315834325, 0.05681996993699937, 0.11349101906257242, 0.0051388059403039395]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.05606753612310741, 0.10291942203028147, 0.05606753612310741]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20472734480843877, 0.20296213709436292, 0.20156390263177942, 0.2004563504741685, 0.057022585709217005, 0.10456841105875885, 0.025356523671760823]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 20210.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20765482869252613, 0.20525265508931836, 0.2033633136373425, 0.2018745129300041, 0.05734274496839094, 0.10512105357288516, 0.011467478993634308]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 20210.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20765482869252613, 0.20525265508931836, 0.2033633136373425, 0.2018745129300041, 0.05734274496839094, 0.10512105357288516, 0.0051861633783773405]
layer_partition: None
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1830612889655655, 0.19945303285515112, 0.19945303285515112, 0.19945303285515112, 0.05698658081575747, 0.104606450837466, 0.05698658081575747]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19112044204403306, 0.20652926215425615, 0.20503259692534997, 0.20385248543046428, 0.05797770704092559, 0.10631585138668886, 0.02577216131371854]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.193899503795366, 0.20894117792697384, 0.2069176533191551, 0.20533087179553308, 0.05830988607664459, 0.10688860321156231, 0.011655450972357165]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 62590.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [286599.999, 265089.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.193899503795366, 0.20894117792697384, 0.2069176533191551, 0.20533087179553308, 0.05830988607664459, 0.10688860321156231, 0.00527117364024525]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
valid_strategies: [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.1861119890244354, 0.1861119890244354, 0.20277689986445338, 0.20277689986445338, 0.05793625710412954, 0.1063497080139631, 0.05793625710412954]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 62590.001, 31295.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 265089.999, 296384.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19445122386228164, 0.19280374342975534, 0.2086274662493809, 0.20736814624801883, 0.05896568336416817, 0.1081231447989253, 0.026201652084166215]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 20210.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 307469.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.19732728656109644, 0.19508397313457868, 0.21060457823980472, 0.20891080165740783, 0.059310597288601996, 0.10871716729758601, 0.011849688023611695]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 20210.001, 62590.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 307469.999, 265089.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.19732728656109644, 0.19508397313457868, 0.21060457823980472, 0.20891080165740783, 0.059310597288601996, 0.10871716729758601, 0.005359017278982189]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
valid_strategies: [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.18926609156541166, 0.18926609156541166, 0.18926609156541166, 0.20621342826042782, 0.05891812236012225, 0.10815205232309238, 0.05891812236012225]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 31295.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 296384.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.19790052079945752, 0.1961640038046511, 0.1947767271813288, 0.21100998795185721, 0.05998827074588578, 0.10999346728618971, 0.026645700304002255]
layer_partition: [0, 3, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 20210.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 307469.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20087876147646327, 0.19851371521138875, 0.1966379163033294, 0.21262134851200962, 0.060346696817475176, 0.11061002035983947, 0.012050508676278745]
layer_partition: [0, 3, 5, 6, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 20210.001, 62590.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 307469.999, 265089.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20087876147646327, 0.19851371521138875, 0.1966379163033294, 0.21262134851200962, 0.060346696817475176, 0.11061002035983947, 0.00544983834916351]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19252894440986165, 0.19252894440986165, 0.19252894440986165, 0.19252894440986165, 0.05993384134888753, 0.1100165396627781, 0.05993384134888753]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 31295.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 34240.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.2014748126691745, 0.19964266654100565, 0.19818575055681636, 0.19702721622794836, 0.061047356621967655, 0.11193022969388305, 0.027105058862686434]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.2045607845632613, 0.20206497615905414, 0.20009511508461666, 0.1985373105905116, 0.06142014139426519, 0.11257068288641904, 0.01225825342435411]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.2045607845632613, 0.20206497615905414, 0.20009511508461666, 0.1985373105905116, 0.06142014139426519, 0.11257068288641904, 0.005543790839080148]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19348195360971165, 0.19348195360971165, 0.19348195360971165, 0.19348195360971165, 0.05528055817420333, 0.11056111634840667, 0.06023051103854337]
layer_partition: [0, 2, 4, 6, 7, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 20210.001, 20210.001, 20210.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 307469.999, 45325.998999999996, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20251749280482817, 0.20065723473524535, 0.19917997097410606, 0.19800684975202487, 0.05630721528212314, 0.11249364737507923, 0.0272392276264419]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20563525819680784, 0.20310085327983401, 0.2011033925769994, 0.1995259740082879, 0.05665094934129887, 0.11314047989383495, 0.012318931201003799]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 20210.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 110861.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20563525819680784, 0.20310085327983401, 0.2011033925769994, 0.1995259740082879, 0.05665094934129887, 0.11314047989383495, 0.005571232342423356]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19614380785722008, 0.19614380785722008, 0.19614380785722008, 0.19614380785722008, 0.05604108795920574, 0.09832454013973903, 0.061059140472174964]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 130420.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.20543419215233288, 0.20349344015117202, 0.2019581093048703, 0.2007435075390622, 0.05708075281975349, 0.10003976829723223, 0.02761397499901884]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 10335.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(3): [0.20864173676785042, 0.2059969131079176, 0.20392078753363957, 0.20228767744969278, 0.05742884672448486, 0.1006138913519013, 0.012488410569649732]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [61290.001, 40420.001, 40420.001, 20210.001, 0.001, 10335.001, 130420.001]
memory_state: [266389.999, 287259.999, 287259.999, 307469.999, 65535.999, 120736.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(4): [0.20864173676785042, 0.2059969131079176, 0.20392078753363957, 0.20228767744969278, 0.05742884672448486, 0.1006138913519013, 0.005647879327828776]
layer_partition: None
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 131072, 65536]
stage_compute_performance: [0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.19713303176264588, 0.05632372336075597, 0.09882042622790466, 0.05632372336075597]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [41080.001, 40420.001, 40420.001, 40420.001, 0.001, 10335.001, 59650.001]
memory_state: [286599.999, 287259.999, 287259.999, 287259.999, 65535.999, 120736.999, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
execution_cost: 9167.964935302734, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 43.380869565217395
cost: 14960.97871281831


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 4)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 4)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.05555555555555555, 0.05555555555555555, 0.1111111111111111]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [16988.751, 11405.001, 11405.001, 5702.501, 5702.501, 0.001, 21041.251]
memory_state: [310691.249, 316274.999, 316274.999, 321977.499, 59833.498999999996, 65535.999, 110030.749]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 4657.992780208588, fb_sync_cost: 3767.755126953125, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 8552.101842638927


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.05669186702797304, 0.05669186702797304, 0.09293012755243117]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [43085.001, 10597.501, 21195.001, 21195.001, 0.001, 10597.501, 15338.751]
memory_state: [284594.999, 317082.499, 306484.999, 306484.999, 65535.999, 54938.498999999996, 115733.249]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 3891.8840885162354, fb_sync_cost: 3767.755126953125, parameter_upate_costs: 3.289060592651367, dp_cost: 8.271908967391305, pp_cost: 0.9278260869565218
cost: 7734.502889046047


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.1973151701559535, 0.056375762901700995, 0.056375762901700995, 0.09798779357278413]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 20730.001, 41460.001, 41460.001, 0.001, 20730.001, 31160.001]
memory_state: [247119.999, 306949.999, 286219.999, 286219.999, 65535.999, 44805.998999999996, 99911.999]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 3512.975573539734, fb_sync_cost: 3514.8014068603516, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 1.4278260869565218
cost: 7091.786093539363


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.19450539119193816, 0.05557296891198233, 0.05557296891198233, 0.11083249740828255]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 24192.501, 0.001, 81390.001]
memory_state: [263097.499, 279294.999, 279294.999, 303487.499, 41343.498999999996, 65535.999, 49681.998999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 3754.8723816871643, fb_sync_cost: 3137.860870361328, parameter_upate_costs: 4.385414123535156, dp_cost: 19.88041015625, pp_cost: 1.0156521739130435
cost: 6933.608447984612


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.19466646727649167, 0.0556189906504262, 0.0556189906504262, 0.11009614959318086]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 96962.501]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34109.498999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
execution_cost: 4172.646880149841, fb_sync_cost: 3025.9130477905273, parameter_upate_costs: 4.385414123535156, dp_cost: 19.88041015625, pp_cost: 2.031304347826087
cost: 7232.653916309191


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.05555555555555556, 0.11111111111111112]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 161715.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.201020043086479, 0.19958163088353395, 0.1984578713499831, 0.1975799342143965, 0.056255441664919865, 0.0562116987830846, 0.08105123160466729]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 31295.001, 62590.001, 62590.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 296384.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 651.9989999999962]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 4901.684641838074, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 11.422608695652174
cost: 7878.469928729845
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 5, 4, 0, 2, 3, 1]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.05606753612310741, 0.05606753612310741, 0.10291942203028147]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 31295.001, 62590.001, 62590.001, 0.001, 31295.001, 59650.001]
memory_state: [219699.999, 296384.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 71421.99900000001]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 4902.641773223877, fb_sync_cost: 2870.145797729492, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 11.422608695652174
cost: 7819.502457607104


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.05555555555555556, 0.11111111111111112]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 161715.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.201020043086479, 0.19958163088353395, 0.1984578713499831, 0.1975799342143965, 0.056255441664919865, 0.0562116987830846, 0.08105123160466729]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 31295.001, 62590.001, 62590.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 296384.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 651.9989999999962]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 6539.52956199646, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 22.84521739130435
cost: 9525.788242648581
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 5, 4, 0, 2, 3, 1]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.05606753612310741, 0.05606753612310741, 0.10291942203028147]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 31295.001, 62590.001, 62590.001, 0.001, 31295.001, 59650.001]
memory_state: [219699.999, 296384.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 71421.99900000001]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 6541.443824768066, fb_sync_cost: 2870.145797729492, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 22.84521739130435
cost: 9467.777902911643


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555556, 0.05555555555555556, 0.11111111111111112]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 161715.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, -30643.00099999999]
MEMORY EXCEEDED
Failures: [6]
Number of failures: 1
adj_stage_compute_performance(2): [0.201020043086479, 0.19958163088353395, 0.1984578713499831, 0.1975799342143965, 0.056255441664919865, 0.0562116987830846, 0.08105123160466729]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 31295.001, 62590.001, 62590.001, 0.001, 31295.001, 130420.001]
memory_state: [219699.999, 296384.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 651.9989999999962]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 9815.219402313232, fb_sync_cost: 2930.070400238037, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 45.6904347826087
cost: 12823.348692889007
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 5, 4, 0, 2, 3, 1]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 131072]
stage_compute_performance: [0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.19623637643087588, 0.05606753612310741, 0.05606753612310741, 0.10291942203028147]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [107980.001, 31295.001, 62590.001, 62590.001, 0.001, 31295.001, 59650.001]
memory_state: [219699.999, 296384.999, 265089.999, 265089.999, 65535.999, 34240.998999999996, 71421.99900000001]
layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], layer_partition: [0, 3, 4, 6, 8, 8, 9, 10]
execution_cost: 9819.047927856445, fb_sync_cost: 2870.145797729492, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 45.6904347826087
cost: 12767.252615923675


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6, 7]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 7, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 7, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 7, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 7, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 7, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [6, 7, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [7, 0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  7
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6, 7]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 7, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 7, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 7, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 7, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 7, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [6, 7, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [7, 0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  7
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [16988.751, 11405.001, 11405.001, 5702.501, 5702.501, 0.001, 5702.501, 15338.751]
memory_state: [310691.249, 316274.999, 316274.999, 321977.499, 59833.498999999996, 65535.999, 59833.498999999996, 50197.248999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 4676.46324634552, fb_sync_cost: 7535.51025390625, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.7578260869565218
cost: 12338.577435728985


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6, 7]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 7, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 7, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 7, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 7, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 7, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [6, 7, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [7, 0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  7
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.05555555555555554, 0.05555555555555554, 0.05555555555555554, 0.05555555555555554]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [32487.501, 21195.001, 21195.001, 10597.501, 10597.501, 0.001, 10597.501, 31160.001]
memory_state: [295192.499, 306484.999, 306484.999, 317082.499, 54938.498999999996, 65535.999, 54938.498999999996, 34375.998999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 3934.032082557678, fb_sync_cost: 7029.602813720703, parameter_upate_costs: 2.192707061767578, dp_cost: 6.1739979619565215, pp_cost: 1.0078260869565216
cost: 11035.384305318748


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=32, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444448, 0.19444444444444448, 0.19444444444444448, 0.19444444444444448, 0.05555555555555556, 0.05555555555555556, 0.05555555555555556, 0.05555555555555556]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 20730.001, 20730.001, 0.001, 20730.001, 60660.001]
memory_state: [267849.999, 286219.999, 286219.999, 306949.999, 44805.998999999996, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 3586.9458317756653, fb_sync_cost: 6275.721740722656, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.5078260869565216
cost: 9918.270245559526


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.05555555555555554, 0.05555555555555554, 0.05555555555555554, 0.05555555555555554]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 24192.501, 0.001, 24192.501, 72770.001]
memory_state: [263097.499, 279294.999, 279294.999, 303487.499, 41343.498999999996, 65535.999, 41343.498999999996, -7234.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(2): [0.19661156436282193, 0.19616539261492066, 0.19581107975629322, 0.1955297136626773, 0.05580179310927224, 0.0557873085472889, 0.05577367601836341, 0.04502954452343623]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 48385.001, 24192.501, 24192.501, 0.001, 0.001, 24192.501]
memory_state: [263097.499, 279294.999, 279294.999, 303487.499, 41343.498999999996, 65535.999, 65535.999, 41343.498999999996]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 8, 9]
execution_cost: 3856.181025505066, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.1756521739130434
cost: 9947.683900751861
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 7, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (2, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19523258317657183, 0.19523258317657183, 0.19523258317657183, 0.19523258317657183, 0.05172745314236534, 0.055780738050449086, 0.055780738050449086, 0.055780738050449086]
layer_partition: [0, 2, 4, 5, 7, 7, 7, 8, 9]
stage_memory_demand: [64582.501, 48385.001, 24192.501, 48385.001, 0.001, 0.001, 24192.501, 24192.501]
memory_state: [263097.499, 279294.999, 303487.499, 279294.999, 65535.999, 65535.999, 41343.498999999996, 41343.498999999996]
layer_partition: [0, 2, 4, 5, 7, 7, 7, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (2, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 4, 5, 7, 7, 7, 8, 9]
execution_cost: 3856.181025505066, fb_sync_cost: 6051.826095581055, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 1.3356521739130434
cost: 9947.843900751861


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(2): [0.20278677973561227, 0.2010692401168424, 0.1997053115960546, 0.19862219188837013, 0.05650344783274878, 0.05644768946350212, 0.05639521099832879, 0.025124980638514174]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(3): [0.20565935805652844, 0.20332297561008245, 0.20148048677823363, 0.20002481763788024, 0.056820886955716854, 0.056746371530774505, 0.0566762775369274, 0.01136276373754282]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
execution_cost: 4080.8959007263184, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 2.351304347826087
cost: 9982.578713378907
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [7, 4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  7
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19533630091900397, 0.19533630091900397, 0.19533630091900397, 0.19533630091900397, 0.055810371691144, 0.055810371691144, 0.055810371691144, 0.05122368125055196]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 59650.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 4376.999855041504, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 6.031304347826087
cost: 10154.02702259893


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(2): [0.20278677973561227, 0.2010692401168424, 0.1997053115960546, 0.19862219188837013, 0.05650344783274878, 0.05644768946350212, 0.05639521099832879, 0.025124980638514174]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(3): [0.20565935805652844, 0.20332297561008245, 0.20148048677823363, 0.20002481763788024, 0.056820886955716854, 0.056746371530774505, 0.0566762775369274, 0.01136276373754282]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
execution_cost: 4897.952079772949, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 4.702608695652174
cost: 10798.087766902758
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [7, 4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  7
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19533630091900397, 0.19533630091900397, 0.19533630091900397, 0.19533630091900397, 0.055810371691144, 0.055810371691144, 0.055810371691144, 0.05122368125055196]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 59650.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 5490.15998840332, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 12.062608695652173
cost: 11269.320030437968


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(2): [0.20278677973561227, 0.2010692401168424, 0.1997053115960546, 0.19862219188837013, 0.05650344783274878, 0.05644768946350212, 0.05639521099832879, 0.025124980638514174]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(3): [0.20565935805652844, 0.20332297561008245, 0.20148048677823363, 0.20002481763788024, 0.056820886955716854, 0.056746371530774505, 0.0566762775369274, 0.01136276373754282]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
execution_cost: 6532.064437866211, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 9.405217391304348
cost: 12434.953518756369
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [7, 4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  7
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19533630091900397, 0.19533630091900397, 0.19533630091900397, 0.19533630091900397, 0.055810371691144, 0.055810371691144, 0.055810371691144, 0.05122368125055196]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 59650.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 7716.480255126953, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 24.125217391304346
cost: 13505.753690921949


inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.1944444444444444, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 130420.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, -64884.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(2): [0.20278677973561227, 0.2010692401168424, 0.1997053115960546, 0.19862219188837013, 0.05650344783274878, 0.05644768946350212, 0.05639521099832879, 0.025124980638514174]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 9, 10]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 31295.001, 0.001, 130420.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 34240.998999999996, 65535.999, -64884.001000000004]
MEMORY EXCEEDED
Failures: [7]
Number of failures: 1
adj_stage_compute_performance(3): [0.20565935805652844, 0.20332297561008245, 0.20148048677823363, 0.20002481763788024, 0.056820886955716854, 0.056746371530774505, 0.0566762775369274, 0.01136276373754282]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
stage_memory_demand: [107980.001, 62590.001, 62590.001, 31295.001, 0.001, 0.001, 0.001, 31295.001]
memory_state: [219699.999, 265089.999, 265089.999, 296384.999, 65535.999, 65535.999, 65535.999, 34240.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 8, 9]
execution_cost: 9800.289154052734, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 18.810434782608695
cost: 15711.608844866545
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [7, 4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  7
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [327680, 327680, 327680, 327680, 65536, 65536, 65536, 65536]
stage_compute_performance: [0.19533630091900397, 0.19533630091900397, 0.19533630091900397, 0.19533630091900397, 0.055810371691144, 0.055810371691144, 0.055810371691144, 0.05122368125055196]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
stage_memory_demand: [76685.001, 62590.001, 62590.001, 31295.001, 31295.001, 0.001, 31295.001, 59650.001]
memory_state: [250994.999, 265089.999, 265089.999, 296384.999, 34240.998999999996, 65535.999, 34240.998999999996, 5885.999000000003]
layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 2, 4, 6, 7, 8, 8, 9, 10]
execution_cost: 12169.120788574219, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 48.25043478260869
cost: 17981.544834292865


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=128, gbs=128)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (2, 8)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 16), (2, 8)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(1, 16), (1, 16)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [22691.251, 49553.751]
memory_state: [239452.749, 1261166.249]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 128, gbs: 128, strategies: [(1, 16), (1, 16)], layer_partition: [0, 3, 10]
execution_cost: 2403.553009033203, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 0.4111325740814209, dp_cost: 0.0, pp_cost: 0.0
cost: 4412.591460943222


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=64, gbs=128)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(2, 8), (2, 8)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [22691.251, 49553.751]
memory_state: [239452.749, 1261166.249]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 64, gbs: 128, strategies: [(2, 8), (2, 8)], layer_partition: [0, 3, 10]
execution_cost: 2403.553009033203, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 0.8222651481628418, dp_cost: 1.9025390625, pp_cost: 0.0
cost: 4352.530254650116


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=32, gbs=128)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(4, 4), (4, 4)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [22691.251, 49553.751]
memory_state: [239452.749, 1261166.249]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 32, gbs: 128, strategies: [(4, 4), (4, 4)], layer_partition: [0, 3, 10]
execution_cost: 2403.553009033203, fb_sync_cost: 1883.8775634765625, parameter_upate_costs: 1.6445302963256836, dp_cost: 5.7076171874999995, pp_cost: 0.0
cost: 4325.970158958435


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=16, gbs=128)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(8, 2), (8, 2)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [43085.001, 94745.001]
memory_state: [219058.999, 1215974.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 16, gbs: 128, strategies: [(8, 2), (8, 2)], layer_partition: [0, 3, 10]
execution_cost: 1950.9391784667969, fb_sync_cost: 1757.4007034301758, parameter_upate_costs: 3.289060592651367, dp_cost: 13.317773437500001, pp_cost: 0.0
cost: 3740.540435409546


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=8, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 8, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1660.5453491210938, fb_sync_cost: 1568.930435180664, parameter_upate_costs: 6.578121185302734, dp_cost: 28.5380859375, pp_cost: 0.0
cost: 3272.3888511657715


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=4, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [88775.001, 217925.001]
memory_state: [173368.999, 1092794.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 4, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1656.970500946045, fb_sync_cost: 1512.9565238952637, parameter_upate_costs: 6.578121185302734, dp_cost: 28.5380859375, pp_cost: 0.0
cost: 3208.941661834717


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=2, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.22222222222222227, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [107980.001, 318190.001]
memory_state: [154163.999, 992529.9990000001]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 2, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1639.5936012268066, fb_sync_cost: 1465.0352001190186, parameter_upate_costs: 6.578121185302734, dp_cost: 28.5380859375, pp_cost: 0.0
cost: 3141.6942234039307


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=1, batches=1, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.22222222222222227, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [107980.001, 318190.001]
memory_state: [154163.999, 992529.9990000001]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 1, batches: 1, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1639.5936012268066, fb_sync_cost: 1465.0352001190186, parameter_upate_costs: 6.578121185302734, dp_cost: 28.5380859375, pp_cost: 0.0
cost: 3140.7196159362793


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=128, gbs=128)
invalid_strategy: dp_deg(16), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (2, 8)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 16), (2, 8)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(1, 16), (1, 16)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [22691.251, 49553.751]
memory_state: [239452.749, 1261166.249]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 128, gbs: 128, strategies: [(1, 16), (1, 16)], layer_partition: [0, 3, 10]
execution_cost: 2418.962836265564, fb_sync_cost: 538.250732421875, parameter_upate_costs: 0.9593093395233153, dp_cost: 0.0, pp_cost: 0.08695652173913043
cost: 3083.0095904080763


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=64, gbs=128)
invalid_strategy: dp_deg(16), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (4, 4)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 8), (4, 4)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(2, 8), (2, 8)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [22691.251, 49553.751]
memory_state: [239452.749, 1261166.249]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 64, gbs: 128, strategies: [(2, 8), (2, 8)], layer_partition: [0, 3, 10]
execution_cost: 2434.372663497925, fb_sync_cost: 538.250732421875, parameter_upate_costs: 1.9186186790466306, dp_cost: 4.165898862092392, pp_cost: 0.08695652173913043
cost: 3041.1697479123654


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=32, gbs=128)
invalid_strategy: dp_deg(16), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (8, 2)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 4), (8, 2)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(4, 4), (4, 4)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [22691.251, 49553.751]
memory_state: [239452.749, 1261166.249]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 32, gbs: 128, strategies: [(4, 4), (4, 4)], layer_partition: [0, 3, 10]
execution_cost: 2465.1923179626465, fb_sync_cost: 538.250732421875, parameter_upate_costs: 3.8372373580932613, dp_cost: 12.497696586277174, pp_cost: 0.08695652173913043
cost: 3051.0523798154745


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=16, gbs=128)
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(16, 1), (16, 1)]
sorted_stage_id:  [0, 1]
Adjusting stage:  0
invalid_strategy: dp_deg(16), batches(16), mbs(0)
DFS STEP
prev_strategies:  [(8, 2), (16, 1)]
sorted_stage_id:  [1, 0]
Adjusting stage:  1
valid_strategies: [(8, 2), (8, 2)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [43085.001, 94745.001]
memory_state: [219058.999, 1215974.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 16, gbs: 128, strategies: [(8, 2), (8, 2)], layer_partition: [0, 3, 10]
execution_cost: 2052.319049835205, fb_sync_cost: 502.11448669433594, parameter_upate_costs: 7.6744747161865225, dp_cost: 29.161292034646742, pp_cost: 0.08695652173913043
cost: 2606.949979284535


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=8, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [80560.001, 185040.001]
memory_state: [181583.999, 1125679.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 8, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 1838.003396987915, fb_sync_cost: 448.2658386230469, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48848293138587, pp_cost: 0.08695652173913043
cost: 2371.990484237671


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=4, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.2222222222222222, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [88775.001, 217925.001]
memory_state: [173368.999, 1092794.999]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 4, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 2010.8065605163574, fb_sync_cost: 432.2732925415039, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48848293138587, pp_cost: 0.17391304347826086
cost: 2524.9896283357043


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=2, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.22222222222222227, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [107980.001, 318190.001]
memory_state: [154163.999, 992529.9990000001]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 2, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 2340.0542736053467, fb_sync_cost: 418.581485748291, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48848293138587, pp_cost: 0.34782608695652173
cost: 2838.770232739656


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[16, 16], num_stage=2, batches=1, gbs=128)
valid_strategies: [(16, 1), (16, 1)]
stage_memory_capacity: [262144, 1310720]
stage_compute_performance: [0.22222222222222227, 0.7777777777777778]
layer_partition: [0, 3, 10]
stage_memory_demand: [107980.001, 318190.001]
memory_state: [154163.999, 992529.9990000001]
layer_partition: [0, 3, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [16, 16], num_stage: 2, batches: 1, gbs: 128, strategies: [(16, 1), (16, 1)], layer_partition: [0, 3, 10]
execution_cost: 3040.5149459838867, fb_sync_cost: 418.581485748291, parameter_upate_costs: 15.348949432373045, dp_cost: 62.48848293138587, pp_cost: 0.6956521739130435
cost: 3538.604123737501


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (4, 2)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 2), (4, 2), (4, 2)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (4, 2), (4, 2)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (4, 2)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (2, 4)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (2, 4), (2, 4), (2, 4)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 8), (2, 4), (2, 4)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 8), (1, 8), (2, 4)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(1, 8), (1, 8), (1, 8), (1, 8)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [16988.751, 5702.501, 17107.501, 32446.251]
memory_state: [114083.249, 125369.499, 638252.499, 622913.749]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 128, gbs: 128, strategies: [(1, 8), (1, 8), (1, 8), (1, 8)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2567.208230495453, fb_sync_cost: 1076.50146484375, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.2539130434782609
cost: 3769.80971777294


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (4, 2)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 2), (4, 2), (4, 2)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (4, 2), (4, 2)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 4), (2, 4), (4, 2)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(2, 4), (2, 4), (2, 4), (2, 4)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [16988.751, 5702.501, 17107.501, 32446.251]
memory_state: [114083.249, 125369.499, 638252.499, 622913.749]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 64, gbs: 128, strategies: [(2, 4), (2, 4), (2, 4), (2, 4)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2615.9075498580933, fb_sync_cost: 1076.50146484375, parameter_upate_costs: 2.192707061767578, dp_cost: 5.184931216032608, pp_cost: 0.2539130434782609
cost: 3762.4154439528093


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [0, 1, 2, 3]
Adjusting stage:  0
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (8, 1), (8, 1), (8, 1)]
sorted_stage_id:  [1, 2, 3, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (8, 1), (8, 1)]
sorted_stage_id:  [2, 3, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 2), (4, 2), (8, 1)]
sorted_stage_id:  [3, 0, 1, 2]
Adjusting stage:  3
valid_strategies: [(4, 2), (4, 2), (4, 2), (4, 2)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [32487.501, 10597.501, 31792.501, 62952.501]
memory_state: [98584.499, 120474.499, 623567.499, 592407.499]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 32, gbs: 128, strategies: [(4, 2), (4, 2), (4, 2), (4, 2)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2176.353096961975, fb_sync_cost: 1004.2289733886719, parameter_upate_costs: 4.385414123535156, dp_cost: 15.554793648097826, pp_cost: 0.2539130434782609
cost: 3231.9636301306023


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=16, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [59830.001, 20730.001, 62190.001, 122850.001]
memory_state: [71241.99900000001, 110341.999, 593169.999, 532509.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 16, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 1949.379026889801, fb_sync_cost: 896.5316772460938, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 0.2539130434782609
cost: 2906.823683421094


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=8, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.1111111111111111, 0.1111111111111111, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [64582.501, 24192.501, 72577.501, 145347.501]
memory_state: [66489.49900000001, 106879.499, 582782.499, 510012.499]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 8, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2225.6237268447876, fb_sync_cost: 864.5465850830078, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 0.5078260869565218
cost: 3143.5403445152615


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=4, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.11111111111111113, 0.11111111111111113, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [76685.001, 31295.001, 93885.001, 224305.001]
memory_state: [54386.998999999996, 99776.999, 561474.999, 431054.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 4, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 2755.7079792022705, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 1.0156521739130435
cost: 3642.85037950267


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=2, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.11111111111111113, 0.11111111111111113, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [76685.001, 31295.001, 93885.001, 224305.001]
memory_state: [54386.998999999996, 99776.999, 561474.999, 431054.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 2, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 3864.1486167907715, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 2.031304347826087
cost: 4750.357454329781


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 8, 8, 8], num_stage=4, batches=1, gbs=128)
valid_strategies: [(8, 1), (8, 1), (8, 1), (8, 1)]
stage_memory_capacity: [131072, 131072, 655360, 655360]
stage_compute_performance: [0.11111111111111113, 0.11111111111111113, 0.3888888888888889, 0.3888888888888889]
layer_partition: [0, 2, 3, 6, 10]
stage_memory_demand: [76685.001, 31295.001, 93885.001, 224305.001]
memory_state: [54386.998999999996, 99776.999, 561474.999, 431054.999]
layer_partition: [0, 2, 3, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 8, 8, 8], num_stage: 4, batches: 1, gbs: 128, strategies: [(8, 1), (8, 1), (8, 1), (8, 1)], layer_partition: [0, 2, 3, 6, 10]
execution_cost: 6081.029891967773, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 4.062608695652174
cost: 6968.295426386957


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(8), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.1111111111111111, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [16988.751, 5702.501, 0.001, 5702.501, 11405.001, 11405.001, 21041.251]
memory_state: [114083.249, 59833.498999999996, 65535.999, 321977.499, 316274.999, 316274.999, 306638.749]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 4658.509373664856, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 6937.866238829572


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(8), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.09293012755243117, 0.05669186702797304, 0.05669186702797304, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [16988.751, 0.001, 10597.501, 10597.501, 21195.001, 21195.001, 41757.501]
memory_state: [114083.249, 65535.999, 54938.498999999996, 317082.499, 306484.999, 306484.999, 285922.499]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
execution_cost: 3912.4066829681396, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5078260869565218
cost: 5992.114081245091


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
valid_strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.0979877935727841, 0.05637576290170098, 0.05637576290170098, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [32487.501, 0.001, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [98584.499, 65535.999, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
execution_cost: 3545.354723930359, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5078260869565218
cost: 5393.020878861469


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11083249740828256, 0.05557296891198234, 0.05557296891198234, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [59830.001, 24192.501, 0.001, 24192.501, 48385.001, 48385.001, 96962.501]
memory_state: [71241.99900000001, 41343.498999999996, 65535.999, 303487.499, 279294.999, 279294.999, 230717.499]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 3754.4767260551453, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 0.9356521739130435
cost: 5524.364955438531


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11009614959318087, 0.055618990650426206, 0.055618990650426206, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [64582.501, 0.001, 31295.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [66489.49900000001, 65535.999, 34240.998999999996, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
execution_cost: 4172.521114349365, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 1.871304347826087
cost: 5880.780908992602


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11111111111111113, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 0.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [54386.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 5076.57790184021, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 3.742608695652174
cost: 6782.810570960667


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11111111111111113, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 0.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [54386.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 6889.316082000732, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 7.485217391304348
cost: 8597.342144881539


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[8, 4, 4, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [131072, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.11111111111111113, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [76685.001, 31295.001, 0.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [54386.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [8, 4, 4, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 10514.792442321777, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 19.8802734375, pp_cost: 14.970434782608695
cost: 12229.329115126237


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.1111111111111111, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [11286.251, 5702.501, 5702.501, 5702.501, 11405.001, 11405.001, 21041.251]
memory_state: [54249.748999999996, 125369.499, 59833.498999999996, 321977.499, 316274.999, 316274.999, 306638.749]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 4660.305559635162, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 6939.662424799878


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05669186702797304, 0.09293012755243117, 0.05669186702797304, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [21890.001, 5702.501, 10597.501, 10597.501, 21195.001, 21195.001, 41757.501]
memory_state: [43645.998999999996, 125369.499, 54938.498999999996, 317082.499, 306484.999, 306484.999, 285922.499]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3912.883162498474, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5078260869565218
cost: 5992.590560775426


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 0, 2, 3, 4, 5, 6]
Adjusting stage:  1
valid_strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05637576290170098, 0.0979877935727841, 0.05637576290170098, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 10597.501, 20730.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 120474.499, 44805.998999999996, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3542.2980785369873, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5078260869565218
cost: 5389.9642334680975


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05557296891198234, 0.11083249740828256, 0.05557296891198234, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [40390.001, 20730.001, 24192.501, 24192.501, 48385.001, 48385.001, 96962.501]
memory_state: [25145.999000000003, 110341.999, 41343.498999999996, 303487.499, 279294.999, 279294.999, 230717.499]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3755.6633353233337, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.9356521739130435
cost: 5524.193412532806


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055618990650426206, 0.11009614959318087, 0.055618990650426206, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 24192.501, 31295.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 106879.499, 34240.998999999996, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 4174.1591691970825, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 1.871304347826087
cost: 5881.060811666406


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.11111111111111113, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 99776.999, 34240.998999999996, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 5080.414772033691, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 3.742608695652174
cost: 6785.289288980235


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.11111111111111113, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 99776.999, 34240.998999999996, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 6896.989822387695, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 7.485217391304348
cost: 8603.657733094587


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=1, device_groups=[4, 8, 4, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 131072, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.11111111111111113, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 99776.999, 34240.998999999996, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 8, 4, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 10530.139923095703, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 14.970434782608695
cost: 12243.318443726248


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.1111111111111111, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [11286.251, 5702.501, 5702.501, 5702.501, 11405.001, 11405.001, 21041.251]
memory_state: [54249.748999999996, 59833.498999999996, 125369.499, 321977.499, 316274.999, 316274.999, 306638.749]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 4660.305559635162, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 6939.662424799878


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05669186702797304, 0.05669186702797304, 0.09293012755243117, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565, 0.19842153459790565]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [21890.001, 10597.501, 5702.501, 10597.501, 21195.001, 21195.001, 41757.501]
memory_state: [43645.998999999996, 54938.498999999996, 125369.499, 317082.499, 306484.999, 306484.999, 285922.499]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3912.883162498474, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5078260869565218
cost: 5992.590560775426


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 3, 4, 5, 6]
Adjusting stage:  2
valid_strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05637576290170098, 0.05637576290170098, 0.0979877935727841, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346, 0.19731517015595346]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 10597.501, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 120474.499, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3542.2980785369873, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5078260869565218
cost: 5389.9642334680975


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05557296891198234, 0.05557296891198234, 0.11083249740828256, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382, 0.1945053911919382]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [40390.001, 24192.501, 20730.001, 24192.501, 48385.001, 48385.001, 96962.501]
memory_state: [25145.999000000003, 41343.498999999996, 110341.999, 303487.499, 279294.999, 279294.999, 230717.499]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 3755.6633353233337, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.928695652173913
cost: 5524.186456011067


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055618990650426206, 0.055618990650426206, 0.11009614959318087, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917, 0.1946664672764917]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 24192.501, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 106879.499, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 4174.1591691970825, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 1.857391304347826
cost: 5881.046898622927


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.11111111111111113, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 99776.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 5080.414772033691, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 3.714782608695652
cost: 6785.261462893279


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.11111111111111113, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 99776.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 6896.989822387695, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 7.429565217391304
cost: 8603.602080920675


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=2, device_groups=[4, 4, 8, 4, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 131072, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.11111111111111113, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 99776.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 8, 4, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
execution_cost: 10530.139923095703, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 14.859130434782609
cost: 12243.207139378423


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 0, 1, 2, 4, 5, 6]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.06451612903225806, 0.06451612903225806, 0.06451612903225806, 0.12903225806451613, 0.22580645161290322, 0.22580645161290322, 0.22580645161290322]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [11286.251, 5702.501, 5702.501, 5702.501, 11405.001, 11405.001, 21041.251]
memory_state: [54249.748999999996, 59833.498999999996, 59833.498999999996, 387513.499, 316274.999, 316274.999, 306638.749]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [1]
execution_cost: 4685.8479380607605, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5078260869565218
cost: 6965.204803225476


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 0, 1, 2, 4, 5, 6]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.060373270920337174, 0.060373270920337174, 0.060373270920337174, 0.1849608425754481, 0.21130644822118014, 0.21130644822118014, 0.21130644822118014]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [21890.001, 10597.501, 10597.501, 7127.501, 21195.001, 21195.001, 41757.501]
memory_state: [43645.998999999996, 54938.498999999996, 54938.498999999996, 386088.499, 306484.999, 306484.999, 285922.499]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [0, 2]
execution_cost: 3938.3918046951294, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5078260869565218
cost: 6018.099202972081


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 0, 1, 2, 4, 5, 6]
Adjusting stage:  3
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.059931551433817495, 0.059931551433817495, 0.059931551433817495, 0.19092405564346362, 0.20976043001836125, 0.20976043001836125, 0.20976043001836125]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 26075.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 367140.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [0, 0, 2, 2]
execution_cost: 3589.377224445343, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5078260869565218
cost: 5437.043379376453


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.058823529411764705, 0.058823529411764705, 0.058823529411764705, 0.2058823529411765, 0.2058823529411765, 0.2058823529411765, 0.2058823529411765]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [40390.001, 24192.501, 24192.501, 96770.001, 48385.001, 48385.001, 96962.501]
memory_state: [25145.999000000003, 41343.498999999996, 41343.498999999996, 296445.999, 279294.999, 279294.999, 230717.499]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [0, 0, 0, 0, 2, 2, 2, 2]
execution_cost: 3858.4072589874268, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.928695652173913
cost: 5626.93037967516


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05731389355343146, 0.05731389355343146, 0.05731389355343146, 0.2262624370286755, 0.20059862743701007, 0.20059862743701007, 0.20059862743701007]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 262610.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 130605.99900000001, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [1, 1, 1, 1, 3, 3, 3, 3]
execution_cost: 4362.829506397247, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 1.857391304347826
cost: 6069.717235823092


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05727724283941197, 0.05727724283941197, 0.05727724283941197, 0.22675722166793852, 0.20047034993794186, 0.20047034993794186, 0.20047034993794186]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 318720.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 74495.99900000001, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [2, 2, 2, 2, 6, 6, 6, 6]
execution_cost: 5461.28523349762, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 3.714782608695652
cost: 7166.131924357207


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05714285714285715, 0.05714285714285715, 0.05714285714285715, 0.2285714285714286, 0.19999999999999998, 0.19999999999999998, 0.19999999999999998]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 375540.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 17675.99900000001, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [4, 4, 4, 4, 12, 12, 12, 12]
execution_cost: 7654.666900634766, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 7.429565217391304
cost: 9361.279159167745


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05562468255168519, 0.05562468255168519, 0.05562468255168519, 0.24906678555225004, 0.19468638893089815, 0.19468638893089815, 0.19468638893089815]
layer_partition: [0, 1, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 1276300.001, 62590.001, 31295.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, -883084.0009999999, 265089.999, 296384.999, 165964.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.0746485333988627, 0.07323935926203473, 0.07193456839460144, 0.06906161604942458, 0.24754250045886747, 0.23383906413680133, 0.2236883705649005]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [76685.001, 0.001, 31295.001, 638150.0009999999, 62590.001, 62590.001, 161715.001]
memory_state: [-11149.001000000004, 65535.999, 34240.998999999996, -244934.00099999993, 265089.999, 265089.999, 165964.999]
MEMORY EXCEEDED
Failures: [0, 3]
Number of failures: 2
adj_stage_compute_performance(3): [0.05741604745294427, 0.07868335503992843, 0.07682098977799752, 0.03829901925337689, 0.2629350924627283, 0.24414619324733416, 0.23083640380018625]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 62590.001, 62590.001, 193010.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 393215.999, 265089.999, 265089.999, 134669.999]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 12162.059783935547, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815854279891305, pp_cost: 14.859130434782609
cost: 13883.61344029634
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 6, 4, 5, 3]
Adjusting stage:  0
valid_strategies: [(2, 2), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.0512877108633157, 0.0558801346679614, 0.0558801346679614, 0.25021060578716675, 0.19558047133786488, 0.19558047133786488, 0.19558047133786488]
layer_partition: [0, 1, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [20870.001, 31295.001, 31295.001, 1276300.001, 62590.001, 31295.001, 161715.001]
memory_state: [44665.998999999996, 34240.998999999996, 34240.998999999996, -883084.0009999999, 265089.999, 296384.999, 165964.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06892712880553623, 0.0737844015547155, 0.07245003639499846, 0.06937877625895725, 0.2492529147521088, 0.2352526076500948, 0.22490424159048703]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [20870.001, 31295.001, 31295.001, 0.001, 62590.001, 62590.001, 193010.001]
memory_state: [44665.998999999996, 34240.998999999996, 34240.998999999996, 393215.999, 265089.999, 265089.999, 134669.999]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(2, 2), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 12271.781921386719, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815854279891305, pp_cost: 17.41913043478261
cost: 13995.895577747511
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 0, 6, 4, 5, 3]
Adjusting stage:  1
valid_strategies: [(2, 2), (2, 2), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.051524332434104564, 0.051524332434104564, 0.056137943897861815, 0.25136498030638005, 0.19648280364251633, 0.19648280364251633, 0.19648280364251633]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [20870.001, 0.001, 0.001, 1276300.001, 62590.001, 62590.001, 62590.001]
memory_state: [44665.998999999996, 65535.999, 65535.999, -883084.0009999999, 265089.999, 265089.999, 265089.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06934549167218317, 0.06811896164247702, 0.07297411317450561, 0.06969886297644702, 0.25099066381124563, 0.23668481796544322, 0.22613360906063143]
layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [41080.001, 0.001, 31295.001, 0.001, 62590.001, 62590.001, 193010.001]
memory_state: [24455.999000000003, 65535.999, 34240.998999999996, 393215.999, 265089.999, 265089.999, 134669.999]
layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(2, 2), (2, 2), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 12550.039291381836, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815854279891305, pp_cost: 19.979130434782604
cost: 14276.712947742628
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 2, 1, 6, 4, 5, 3]
Adjusting stage:  0
valid_strategies: [(1, 4), (2, 2), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.045487610136880574, 0.051852267137219056, 0.05649524265547596, 0.25296483218792704, 0.1977333492941658, 0.1977333492941658, 0.1977333492941658]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 62590.001, 62590.001, 62590.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 265089.999, 265089.999, 265089.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06134339846363609, 0.06882604595772752, 0.07370523595312482, 0.07014247233260572, 0.2534129986402427, 0.23867510673487238, 0.22783819948664924]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [12958.751, 20210.001, 31295.001, 0.001, 62590.001, 62590.001, 193010.001]
memory_state: [52577.248999999996, 45325.998999999996, 34240.998999999996, 393215.999, 265089.999, 265089.999, 134669.999]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (2, 2), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 12739.936828613281, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815854279891305, pp_cost: 25.0991304347826
cost: 14471.730484974074
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 1, 0, 6, 4, 5, 3]
Adjusting stage:  2
valid_strategies: [(1, 4), (2, 2), (2, 2), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.04569979315770118, 0.05209413894900395, 0.05209413894900395, 0.2541448203669827, 0.1986557028591027, 0.1986557028591027, 0.1986557028591027]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 62590.001, 62590.001, 62590.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 265089.999, 265089.999, 265089.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06172087176053924, 0.06923790790221276, 0.06804050402764625, 0.07046966124454399, 0.2552182909817948, 0.24015305981376567, 0.22910039592172193]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [12958.751, 20210.001, 20210.001, 0.001, 62590.001, 62590.001, 193010.001]
memory_state: [52577.248999999996, 45325.998999999996, 45325.998999999996, 393215.999, 265089.999, 265089.999, 134669.999]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (2, 2), (2, 2), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 13018.194198608398, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815854279891305, pp_cost: 27.88173913043478
cost: 14752.770463664843
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 0, 6, 4, 5, 3]
Adjusting stage:  1
valid_strategies: [(1, 4), (1, 4), (2, 2), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.04599389402035587, 0.04599389402035587, 0.05242939060214132, 0.2557803684897329, 0.19993415095580466, 0.19993415095580466, 0.19993415095580466]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 62590.001, 62590.001, 62590.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 265089.999, 265089.999, 265089.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06224527464247243, 0.06124091484548449, 0.0687356502961999, 0.07092316850860281, 0.2577357478229334, 0.24220738401174624, 0.2308507056854235]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [12958.751, 10335.001, 20210.001, 0.001, 62590.001, 62590.001, 193010.001]
memory_state: [52577.248999999996, 55200.998999999996, 45325.998999999996, 393215.999, 265089.999, 265089.999, 134669.999]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (2, 2), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 13488.365173339844, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815854279891305, pp_cost: 33.00173913043478
cost: 15228.06143839629
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 0, 1, 6, 4, 5, 3]
Adjusting stage:  2
valid_strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.04629180477172902, 0.04629180477172902, 0.04629180477172902, 0.2574371040931492, 0.20122916053055465, 0.20122916053055465, 0.20122916053055465]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 62590.001, 62590.001, 62590.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 265089.999, 265089.999, 265089.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06277840108794797, 0.06175061704133376, 0.06078690565266626, 0.07138255066943512, 0.26031088512402156, 0.24430016615573616, 0.2326282359354989]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [12958.751, 10335.001, 10335.001, 0.001, 62590.001, 62590.001, 193010.001]
memory_state: [52577.248999999996, 55200.998999999996, 55200.998999999996, 393215.999, 265089.999, 265089.999, 134669.999]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 13958.536148071289, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815854279891305, pp_cost: 38.56695652173913
cost: 15703.797630519039
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 6, 4, 5, 3]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.04707023883662514, 0.04707023883662514, 0.04707023883662514, 0.26176611680679257, 0.2046129913010304, 0.2046129913010304, 0.1877971840812713]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 62590.001, 62590.001, 40420.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 265089.999, 265089.999, 287259.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06422204808913806, 0.06312843835870426, 0.06210455784603938, 0.072582905880347, 0.2657997539051424, 0.24884089193811887, 0.2171392742036975]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [12958.751, 10335.001, 10335.001, 0.001, 62590.001, 62590.001, 100070.001]
memory_state: [52577.248999999996, 55200.998999999996, 55200.998999999996, 393215.999, 265089.999, 265089.999, 227609.999]
layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 1, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 14119.728088378906, fb_sync_cost: 1640.0833129882812, parameter_upate_costs: 4.385414123535156, dp_cost: 12.587466032608695, pp_cost: 38.56695652173913
cost: 15816.325845512722
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (2, 2)]
sorted_stage_id:  [0, 1, 2, 6, 4, 5, 3]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.04818087291244946, 0.04818087291244946, 0.04818087291244946, 0.2679425539018095, 0.20944088608363448, 0.20944088608363448, 0.16863305519357313]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 62590.001, 62590.001, 20670.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 265089.999, 265089.999, 307009.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06630498294284604, 0.06511213196280333, 0.06399778930444938, 0.07429551772565465, 0.27367136880508103, 0.25529509343699336, 0.19499020450928664]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [12958.751, 10335.001, 10335.001, 638150.0009999999, 62590.001, 62590.001, 41863.751]
memory_state: [52577.248999999996, 55200.998999999996, 55200.998999999996, -244934.00099999993, 265089.999, 265089.999, 285816.249]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.06945696515737096, 0.06798417780953192, 0.06662075820170117, 0.04120154764084991, 0.28410708830125114, 0.2621322472933467, 0.19876221339010314]
layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [23293.751, 0.001, 10335.001, 0.001, 62590.001, 62590.001, 52198.751]
memory_state: [42242.248999999996, 65535.999, 55200.998999999996, 393215.999, 265089.999, 265089.999, 275481.249]
layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (1, 4)], layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 14399.406433105469, fb_sync_cost: 1442.4362182617188, parameter_upate_costs: 4.385414123535156, dp_cost: 12.587466032608695, pp_cost: 38.56695652173913
cost: 15898.357095512722
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (1, 4)]
sorted_stage_id:  [0, 2, 1, 4, 5, 6, 3]
Adjusting stage:  4
valid_strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (2, 2), (4, 1), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.049024714756949736, 0.049024714756949736, 0.049024714756949736, 0.2726353111151433, 0.1955950003503915, 0.21310904261429206, 0.17158650164932407]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 40420.001, 62590.001, 20670.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 287259.999, 265089.999, 307009.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06792264406493644, 0.06664891493293604, 0.06546103573059014, 0.07559673256312015, 0.2567514808988168, 0.26182351215694477, 0.19931753637410396]
layer_partition: [0, 2, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [23293.751, 0.001, 10335.001, 0.001, 40420.001, 93885.001, 41863.751]
memory_state: [42242.248999999996, 65535.999, 55200.998999999996, 393215.999, 287259.999, 233794.999, 285816.249]
layer_partition: [0, 2, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (2, 2), (4, 1), (1, 4)], layer_partition: [0, 2, 2, 3, 3, 5, 8, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 14344.573974609375, fb_sync_cost: 1442.4362182617188, parameter_upate_costs: 6.578121185302734, dp_cost: 18.881199048913043, pp_cost: 41.3495652173913
cost: 15854.793685790353
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (8, 1), (2, 2), (4, 1), (1, 4)]
sorted_stage_id:  [0, 2, 1, 5, 6, 4, 3]
Adjusting stage:  5
valid_strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (2, 2), (2, 2), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.04989864167617753, 0.04989864167617753, 0.04989864167617753, 0.27749537687374703, 0.19908172611554953, 0.19908172611554953, 0.17464524586662136]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 40420.001, 40420.001, 20670.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 287259.999, 287259.999, 307009.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.06962447869268976, 0.06826214488672652, 0.06699389851529479, 0.07694433896776953, 0.2625765610951061, 0.24508094799791041, 0.20387922563339203]
layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [23293.751, 0.001, 10335.001, 0.001, 40420.001, 40420.001, 52198.751]
memory_state: [42242.248999999996, 65535.999, 55200.998999999996, 393215.999, 287259.999, 287259.999, 275481.249]
layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (2, 2), (2, 2), (1, 4)], layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 14717.414855957031, fb_sync_cost: 1442.4362182617188, parameter_upate_costs: 2.192707061767578, dp_cost: 4.195822010869565, pp_cost: 44.132173913043474
cost: 16211.346384672082
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (8, 1), (2, 2), (2, 2), (1, 4)]
sorted_stage_id:  [0, 2, 1, 6, 4, 5, 3]
Adjusting stage:  4
valid_strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (2, 2), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05114853176234987, 0.05114853176234987, 0.05114853176234987, 0.28444624184446105, 0.17901986116822455, 0.2040684405320403, 0.17901986116822455]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 20670.001, 40420.001, 20670.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 307009.999, 287259.999, 307009.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.07209165508818022, 0.070594618707021, 0.06920459205366825, 0.07887168534900005, 0.23769874086261605, 0.25422310636786594, 0.21047036565082655]
layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
stage_memory_demand: [23293.751, 0.001, 10335.001, 0.001, 20670.001, 40420.001, 52198.751]
memory_state: [42242.248999999996, 65535.999, 55200.998999999996, 393215.999, 307009.999, 287259.999, 275481.249]
layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (2, 2), (1, 4)], layer_partition: [0, 2, 2, 3, 3, 5, 7, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 14986.083984375, fb_sync_cost: 1442.4362182617188, parameter_upate_costs: 2.192707061767578, dp_cost: 4.195822010869565, pp_cost: 49.69739130434783
cost: 16485.580730481353
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (2, 2), (1, 4)]
sorted_stage_id:  [0, 2, 1, 6, 5, 4, 3]
Adjusting stage:  5
valid_strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05246264652753052, 0.05246264652753052, 0.05246264652753052, 0.29175427187833786, 0.18361926284635682, 0.18361926284635682, 0.18361926284635682]
layer_partition: [0, 1, 1, 1, 3, 5, 7, 9]
stage_memory_demand: [12958.751, 0.001, 0.001, 1276300.001, 20670.001, 20670.001, 20670.001]
memory_state: [52577.248999999996, 65535.999, 65535.999, -883084.0009999999, 307009.999, 307009.999, 307009.999]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.07474698982097225, 0.07309629772516175, 0.0715678791179298, 0.08089806700064499, 0.24553436846339155, 0.22948230404416034, 0.21759188595584092]
layer_partition: [0, 2, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [23293.751, 0.001, 10335.001, 638150.0009999999, 20670.001, 20670.001, 41863.751]
memory_state: [42242.248999999996, 65535.999, 55200.998999999996, -244934.00099999993, 307009.999, 307009.999, 285816.249]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(3): [0.07865738312204001, 0.07660692587830478, 0.07472961573459821, 0.04486307739166337, 0.25553041884645855, 0.23630964713852537, 0.22243659230719295]
layer_partition: [0, 2, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [23293.751, 0.001, 10335.001, 0.001, 31005.001, 20670.001, 41863.751]
memory_state: [42242.248999999996, 65535.999, 55200.998999999996, 393215.999, 296674.999, 307009.999, 285816.249]
layer_partition: [0, 2, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 2, 3, 3, 6, 8, 10]
data loadbalancer: [7, 7, 7, 7, 25, 25, 25, 25]
execution_cost: 15254.753112792969, fb_sync_cost: 1442.4362182617188, parameter_upate_costs: 1.6445302963256836, dp_cost: 0.0, pp_cost: 55.262608695652176
cost: 16755.071077514316
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [0, 2, 1, 6, 4, 5, 3]
Adjusting stage:  3
valid_strategies: [(1, 4), (1, 4), (1, 4), (4, 2), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05375646305225228, 0.05375646305225228, 0.05375646305225228, 0.2742877487945941, 0.188147620682883, 0.188147620682883, 0.188147620682883]
layer_partition: [0, 1, 2, 2, 4, 6, 8, 10]
stage_memory_demand: [12958.751, 10335.001, 0.001, 427660.001, 20670.001, 20670.001, 41863.751]
memory_state: [52577.248999999996, 55200.998999999996, 65535.999, -34444.00099999999, 307009.999, 307009.999, 285816.249]
MEMORY EXCEEDED
Failures: [3]
Number of failures: 1
adj_stage_compute_performance(2): [0.05839169846334177, 0.05804834769214995, 0.057730430311416794, 0.2269767994669523, 0.2010262182820272, 0.197687322608175, 0.19521406655346968]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
stage_memory_demand: [12958.751, 10335.001, 10335.001, 213830.001, 20670.001, 20670.001, 41863.751]
memory_state: [52577.248999999996, 55200.998999999996, 55200.998999999996, 179385.999, 307009.999, 307009.999, 285816.249]
layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (4, 2), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 4, 6, 8, 10]
data loadbalancer: [14, 14, 50, 50]
execution_cost: 14899.653196334839, fb_sync_cost: 1442.4362182617188, parameter_upate_costs: 1.096353530883789, dp_cost: 3.146866508152174, pp_cost: 56.65391304347826
cost: 16403.961155146724
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (4, 2), (1, 4), (1, 4), (1, 4)]
sorted_stage_id:  [0, 1, 2, 3, 6, 4, 5]
Adjusting stage:  3
valid_strategies: [(1, 4), (1, 4), (1, 4), (2, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 393216, 327680, 327680, 327680]
stage_compute_performance: [0.05561735261401556, 0.05561735261401556, 0.05561735261401556, 0.24916573971078976, 0.1946607341490545, 0.1946607341490545, 0.1946607341490545]
layer_partition: [0, 1, 2, 3, 5, 7, 8, 10]
stage_memory_demand: [12958.751, 10335.001, 10335.001, 124020.001, 20670.001, 10335.001, 41863.751]
memory_state: [52577.248999999996, 55200.998999999996, 55200.998999999996, 269195.999, 307009.999, 317344.999, 285816.249]
layer_partition: [0, 1, 2, 3, 5, 7, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (2, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 5, 7, 8, 10]
data loadbalancer: [28, 100]
execution_cost: 14753.219604492188, fb_sync_cost: 1442.4362182617188, parameter_upate_costs: 1.096353530883789, dp_cost: 2.0979110054347827, pp_cost: 59.436521739130434
cost: 16259.261216497005


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 4), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.3888888888888889, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [11286.251, 5702.501, 5702.501, 0.001, 17107.501, 11405.001, 21041.251]
memory_state: [54249.748999999996, 59833.498999999996, 59833.498999999996, 65535.999, 638252.499, 316274.999, 306638.749]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 4662.859797477722, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5008695652173913
cost: 6942.209706120699


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.34278333506180053, 0.20911439338942708, 0.20911439338942708]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [21890.001, 10597.501, 10597.501, 0.001, 17107.501, 21195.001, 41757.501]
memory_state: [43645.998999999996, 54938.498999999996, 54938.498999999996, 65535.999, 638252.499, 306484.999, 285922.499]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 3916.1936044692993, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5008695652173913
cost: 5995.894046224512


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 0, 1, 2, 3, 5, 6]
Adjusting stage:  4
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.35610071657121584, 0.20487704472734042, 0.20487704472734042]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 31792.501, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 623567.499, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 3548.6331582069397, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5008695652173913
cost: 5396.292356616311


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.3882179489171987, 0.1946579253445277, 0.1946579253445277]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [40390.001, 24192.501, 24192.501, 0.001, 62190.001, 48385.001, 96962.501]
memory_state: [25145.999000000003, 41343.498999999996, 41343.498999999996, 65535.999, 593169.999, 279294.999, 230717.499]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 3770.3410387039185, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 0.9147826086956522
cost: 5544.548897703419


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.3864396461789041, 0.19522374894307593, 0.19522374894307593]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 72577.501, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 582782.499, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 4203.010320663452, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 1.8295652173913044
cost: 5915.568875357586


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.3888888888888889, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 93885.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 561474.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 5138.697624206543, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 3.659130434782609
cost: 6849.187314247463


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.3888888888888889, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 93885.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 561474.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 7013.555526733398, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 7.318260869565218
cost: 8725.7551322738


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=4, device_groups=[4, 4, 4, 4, 8, 4, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 655360, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.3888888888888889, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 93885.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 561474.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 8, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 6, 8, 10]
execution_cost: 10763.27133178711, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 14.636521739130435
cost: 12481.814590729424


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 4), (2, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 4), (2, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (2, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.3888888888888889, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [11286.251, 5702.501, 5702.501, 0.001, 11405.001, 17107.501, 21041.251]
memory_state: [54249.748999999996, 59833.498999999996, 59833.498999999996, 65535.999, 316274.999, 638252.499, 306638.749]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 4662.859797477722, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5008695652173913
cost: 6942.209706120699


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2), (4, 1)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2), (4, 1)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (4, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.20911439338942708, 0.34278333506180053, 0.20911439338942708]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [21890.001, 10597.501, 10597.501, 0.001, 21195.001, 17107.501, 41757.501]
memory_state: [43645.998999999996, 54938.498999999996, 54938.498999999996, 65535.999, 306484.999, 638252.499, 285922.499]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 3916.1936044692993, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5008695652173913
cost: 5995.894046224512


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
sorted_stage_id:  [5, 0, 1, 2, 3, 4, 6]
Adjusting stage:  5
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.20487704472734042, 0.35610071657121584, 0.20487704472734042]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 31792.501, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 623567.499, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 3548.6331582069397, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5008695652173913
cost: 5396.292356616311


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.1946579253445277, 0.3882179489171987, 0.1946579253445277]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [40390.001, 24192.501, 24192.501, 0.001, 48385.001, 62190.001, 96962.501]
memory_state: [25145.999000000003, 41343.498999999996, 41343.498999999996, 65535.999, 279294.999, 593169.999, 230717.499]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 3770.3410387039185, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 0.9147826086956521
cost: 5544.548897703419


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.19522374894307593, 0.3864396461789041, 0.19522374894307593]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 62590.001, 72577.501, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 265089.999, 582782.499, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 4203.010320663452, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 1.8295652173913042
cost: 5915.568875357586


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.3888888888888889, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 62590.001, 93885.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 265089.999, 561474.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 5138.697624206543, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 3.6591304347826084
cost: 6849.187314247463


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.3888888888888889, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 62590.001, 93885.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 265089.999, 561474.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 7013.555526733398, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 7.318260869565217
cost: 8725.7551322738


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=5, device_groups=[4, 4, 4, 4, 4, 8, 4], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 655360, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.3888888888888889, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 62590.001, 93885.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 265089.999, 561474.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 8, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 5, 8, 10]
execution_cost: 10763.27133178711, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 6.578121185302734, dp_cost: 22.02806555706522, pp_cost: 14.636521739130433
cost: 12481.814590729424


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 4)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 4)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 4)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.3888888888888889]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [11286.251, 5702.501, 5702.501, 0.001, 5702.501, 11405.001, 32446.251]
memory_state: [54249.748999999996, 59833.498999999996, 59833.498999999996, 65535.999, 321977.499, 316274.999, 622913.749]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 4662.690997123718, fb_sync_cost: 1076.50146484375, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5008695652173913
cost: 5865.539440922945


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [3, 4, 5, 6, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 2)]
sorted_stage_id:  [4, 5, 6, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 2)]
sorted_stage_id:  [5, 6, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 2)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.059746969539836305, 0.20911439338942708, 0.20911439338942708, 0.34278333506180053]
layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
stage_memory_demand: [21890.001, 10597.501, 10597.501, 0.001, 21195.001, 10597.501, 32446.251]
memory_state: [43645.998999999996, 54938.498999999996, 54938.498999999996, 65535.999, 306484.999, 317082.499, 622913.749]
layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)], layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
execution_cost: 3916.178345680237, fb_sync_cost: 1076.50146484375, parameter_upate_costs: 2.192707061767578, dp_cost: 5.184931216032608, pp_cost: 0.5008695652173913
cost: 5062.933196296693


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=32, gbs=128)
invalid_strategy: dp_deg(8), batches(32), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
sorted_stage_id:  [6, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.058536298493525825, 0.20487704472734042, 0.20487704472734042, 0.35610071657121584]
layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 41460.001, 20730.001, 62952.501]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 286219.999, 306949.999, 592407.499]
layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], layer_partition: [0, 1, 2, 3, 3, 5, 6, 10]
execution_cost: 3548.5759377479553, fb_sync_cost: 1004.2289733886719, parameter_upate_costs: 4.385414123535156, dp_cost: 15.554793648097826, pp_cost: 0.5008695652173913
cost: 4604.433427438322


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.05561655009843648, 0.1946579253445277, 0.1946579253445277, 0.3882179489171987]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [40390.001, 24192.501, 24192.501, 0.001, 24192.501, 48385.001, 122850.001]
memory_state: [25145.999000000003, 41343.498999999996, 41343.498999999996, 65535.999, 303487.499, 279294.999, 532509.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 3770.095467567444, fb_sync_cost: 896.5316772460938, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 1.0017391304347827
cost: 4728.287950185692


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.05577821398373599, 0.19522374894307593, 0.19522374894307593, 0.3864396461789041]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 31295.001, 62590.001, 145347.501]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 510012.499]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 4202.59952545166, fb_sync_cost: 864.5465850830078, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 2.0034782608695654
cost: 5122.011795296047


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.3888888888888889]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 31295.001, 62590.001, 224305.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 431054.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 5137.631177902222, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 4.006956521739131
cost: 6027.764882550447


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.3888888888888889]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 31295.001, 62590.001, 224305.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 431054.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 7011.422634124756, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 8.013913043478261
cost: 7903.614080359417


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=6, device_groups=[4, 4, 4, 4, 4, 4, 8], num_stage=7, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 655360]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.3888888888888889]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 31295.001, 62590.001, 224305.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 431054.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 8], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 10]
execution_cost: 10759.005546569824, fb_sync_cost: 837.162971496582, parameter_upate_costs: 8.770828247070312, dp_cost: 36.294518512228265, pp_cost: 16.027826086956523
cost: 11658.236298380312


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=128, gbs=128)
invalid_strategy: dp_deg(4), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6, 7]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 7, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 7, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 7, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 7, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 7, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [6, 7, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [7, 0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  7
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6, 7]
Adjusting stage:  0
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 7, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [2, 3, 4, 5, 6, 7, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [3, 4, 5, 6, 7, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [4, 5, 6, 7, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2), (2, 2)]
sorted_stage_id:  [5, 6, 7, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2), (2, 2)]
sorted_stage_id:  [6, 7, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(2), batches(128), mbs(0)
DFS STEP
prev_strategies:  [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (2, 2)]
sorted_stage_id:  [7, 0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  7
valid_strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [11286.251, 5702.501, 5702.501, 0.001, 5702.501, 11405.001, 11405.001, 21041.251]
memory_state: [54249.748999999996, 59833.498999999996, 59833.498999999996, 65535.999, 321977.499, 316274.999, 316274.999, 306638.749]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 128, gbs: 128, strategies: [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 4678.185224533081, fb_sync_cost: 2153.0029296875, parameter_upate_costs: 1.096353530883789, dp_cost: 0.0, pp_cost: 0.5878260869565217
cost: 6957.622089697797


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=64, gbs=128)
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [0, 1, 2, 3, 4, 5, 6, 7]
Adjusting stage:  0
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [1, 2, 3, 4, 5, 6, 7, 0]
Adjusting stage:  1
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [2, 3, 4, 5, 6, 7, 0, 1]
Adjusting stage:  2
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [3, 4, 5, 6, 7, 0, 1, 2]
Adjusting stage:  3
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [4, 5, 6, 7, 0, 1, 2, 3]
Adjusting stage:  4
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1), (4, 1)]
sorted_stage_id:  [5, 6, 7, 0, 1, 2, 3, 4]
Adjusting stage:  5
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1), (4, 1)]
sorted_stage_id:  [6, 7, 0, 1, 2, 3, 4, 5]
Adjusting stage:  6
invalid_strategy: dp_deg(4), batches(64), mbs(0)
DFS STEP
prev_strategies:  [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (4, 1)]
sorted_stage_id:  [7, 0, 1, 2, 3, 4, 5, 6]
Adjusting stage:  7
valid_strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [21890.001, 10597.501, 10597.501, 0.001, 10597.501, 21195.001, 21195.001, 41757.501]
memory_state: [43645.998999999996, 54938.498999999996, 54938.498999999996, 65535.999, 317082.499, 306484.999, 306484.999, 285922.499]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 64, gbs: 128, strategies: [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 3936.0562562942505, fb_sync_cost: 2008.4579467773438, parameter_upate_costs: 2.192707061767578, dp_cost: 6.174040421195652, pp_cost: 0.5878260869565217
cost: 6015.843654571202


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=32, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.055555555555555546, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442, 0.19444444444444442]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [39100.001, 20730.001, 20730.001, 0.001, 20730.001, 41460.001, 41460.001, 81390.001]
memory_state: [26435.999000000003, 44805.998999999996, 44805.998999999996, 65535.999, 306949.999, 286219.999, 286219.999, 246289.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 32, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 3586.643636226654, fb_sync_cost: 1793.0633544921875, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 0.5878260869565217
cost: 5434.389791157764


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=16, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [40390.001, 24192.501, 24192.501, 0.001, 24192.501, 48385.001, 48385.001, 96962.501]
memory_state: [25145.999000000003, 41343.498999999996, 41343.498999999996, 65535.999, 303487.499, 279294.999, 279294.999, 230717.499]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 16, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 3858.4072589874268, fb_sync_cost: 1729.0931701660156, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 1.1756521739130434
cost: 5627.1773361969


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=8, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 4376.11722946167, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 2.351304347826087
cost: 6083.498871930993


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=4, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 4, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 5488.394737243652, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 4.702608695652174
cost: 7194.229254190196


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=2, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 2, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 7712.949752807617, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 9.405217391304348
cost: 9421.53766351451


inter_stage_plan: InterStagePlan(ns_idx=1, node_sequence=(<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), dg_idx=0, device_groups=[4, 4, 4, 4, 4, 4, 4, 4], num_stage=8, batches=1, gbs=128)
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)]
stage_memory_capacity: [65536, 65536, 65536, 65536, 327680, 327680, 327680, 327680]
stage_compute_performance: [0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445, 0.19444444444444445]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
stage_memory_demand: [45390.001, 31295.001, 31295.001, 0.001, 31295.001, 62590.001, 62590.001, 161715.001]
memory_state: [20145.999000000003, 34240.998999999996, 34240.998999999996, 65535.999, 296384.999, 265089.999, 265089.999, 165964.999]
layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
node_sequence: (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), device_group: [4, 4, 4, 4, 4, 4, 4, 4], num_stage: 8, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 1, 2, 3, 3, 4, 6, 8, 10]
execution_cost: 12162.059783935547, fb_sync_cost: 1674.325942993164, parameter_upate_costs: 4.385414123535156, dp_cost: 18.522121263586957, pp_cost: 18.810434782608695
cost: 13879.078304566092
Average time: 188.04097175598145 ms
len(costs): 237
rank, cost, node_sequence, device_groups, strategies(dp_deg, tp_deg), batches(number of batch), layer_partition
1, 2371.990484237671, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 8, [0, 3, 10]
2, 2396.9674170017242, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(1, 32)], 128, [0, 10]
3, 2463.2555382770042, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(4, 8)], 1, [0, 10]
4, 2524.9896283357043, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 4, [0, 3, 10]
5, 2606.949979284535, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(8, 2), (8, 2)], 16, [0, 3, 10]
6, 2691.8472052035127, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(8, 4)], 2, [0, 10]
7, 2838.770232739656, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 2, [0, 3, 10]
8, 2840.955996554831, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(8, 4)], 4, [0, 10]
9, 2906.823683421094, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 16, [0, 2, 3, 6, 10]
10, 3025.191303750743, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(16, 2)], 8, [0, 10]
11, 3041.1697479123654, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(2, 8), (2, 8)], 64, [0, 3, 10]
12, 3051.0523798154745, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(4, 4), (4, 4)], 32, [0, 3, 10]
13, 3083.0095904080763, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(1, 16), (1, 16)], 128, [0, 3, 10]
14, 3140.7196159362793, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 1, [0, 3, 10]
15, 3141.6942234039307, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 2, [0, 3, 10]
16, 3143.5403445152615, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 8, [0, 2, 3, 6, 10]
17, 3208.941661834717, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 4, [0, 3, 10]
18, 3231.9636301306023, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(4, 2), (4, 2), (4, 2), (4, 2)], 32, [0, 2, 3, 6, 10]
19, 3272.3888511657715, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 8, [0, 3, 10]
20, 3474.7658491549287, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(8, 4)], 16, [0, 10]
21, 3475.1509326022606, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(4, 8)], 32, [0, 10]
22, 3495.9186335024624, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(16, 1), (16, 1)], 8, [0, 7, 10]
23, 3498.734053549559, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [32], [(2, 16)], 64, [0, 10]
24, 3538.604123737501, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(16, 1), (16, 1)], 1, [0, 3, 10]
25, 3606.029136243074, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(16, 1), (16, 1)], 4, [0, 7, 10]
26, 3642.85037950267, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 4, [0, 2, 3, 6, 10]
27, 3740.540435409546, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(8, 2), (8, 2)], 16, [0, 3, 10]
28, 3762.4154439528093, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(2, 4), (2, 4), (2, 4), (2, 4)], 64, [0, 2, 3, 6, 10]
29, 3769.80971777294, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(1, 8), (1, 8), (1, 8), (1, 8)], 128, [0, 2, 3, 6, 10]
30, 3817.704299512117, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(8, 2), (8, 2)], 16, [0, 7, 10]
31, 3885.0449739539104, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(16, 1), (16, 1)], 2, [0, 7, 10]
32, 4309.996341187021, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(2, 8), (2, 8)], 64, [0, 7, 10]
33, 4320.223347498023, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(4, 4), (4, 4)], 32, [0, 7, 10]
34, 4325.970158958435, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(4, 4), (4, 4)], 32, [0, 3, 10]
35, 4351.6639964787855, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(1, 16), (1, 16)], 128, [0, 7, 10]
36, 4352.530254650116, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(2, 8), (2, 8)], 64, [0, 3, 10]
37, 4412.591460943222, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [16, 16], [(1, 16), (1, 16)], 128, [0, 3, 10]
38, 4584.908667274143, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [16, 16], [(16, 1), (16, 1)], 1, [0, 7, 10]
39, 4604.433427438322, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], 32, [0, 1, 2, 3, 3, 5, 6, 10]
40, 4728.287950185692, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 16, [0, 1, 2, 3, 3, 4, 6, 10]
41, 4750.357454329781, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 2, [0, 2, 3, 6, 10]
42, 5062.933196296693, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)], 64, [0, 1, 2, 3, 3, 5, 6, 10]
43, 5122.011795296047, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 8, [0, 1, 2, 3, 3, 4, 6, 10]
44, 5154.801030007237, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 16, [0, 4, 7, 8, 10]
45, 5305.646948303554, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 8, [0, 4, 7, 8, 10]
46, 5389.9642334680975, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 4, 6, 8, 10]
47, 5389.9642334680975, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 4, 6, 8, 10]
48, 5393.020878861469, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 2, 2, 3, 4, 6, 8, 10]
49, 5396.292356616311, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 3, 6, 8, 10]
50, 5396.292356616311, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)], 32, [0, 1, 2, 3, 3, 5, 8, 10]
51, 5434.389791157764, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 3, 4, 6, 8, 10]
52, 5437.043379376453, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 32, [0, 1, 2, 3, 4, 6, 8, 10]
53, 5524.186456011067, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 4, 6, 8, 10]
54, 5524.193412532806, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 4, 6, 8, 10]
55, 5524.364955438531, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 3, 3, 4, 6, 8, 10]
56, 5544.548897703419, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 3, 6, 8, 10]
57, 5544.548897703419, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 16, [0, 1, 2, 3, 3, 5, 8, 10]
58, 5611.286838904671, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 4, [0, 4, 8, 9, 10]
59, 5626.93037967516, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 4, 6, 8, 10]
60, 5627.1773361969, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 1, 2, 3, 3, 4, 6, 8, 10]
61, 5652.662686009614, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(4, 2), (4, 2), (4, 2), (4, 2)], 32, [0, 4, 7, 8, 10]
62, 5818.402837477974, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (4, 2)], 4, [0, 4, 7, 8, 10]
63, 5865.539440922945, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)], 128, [0, 1, 2, 3, 3, 4, 6, 10]
64, 5880.780908992602, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 2, 2, 3, 4, 6, 8, 10]
65, 5881.046898622927, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 4, 6, 8, 10]
66, 5881.060811666406, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 4, 6, 8, 10]
67, 5915.568875357586, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 3, 6, 8, 10]
68, 5915.568875357586, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 8, [0, 1, 2, 3, 3, 5, 8, 10]
69, 5992.114081245091, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 2, 3, 4, 6, 8, 10]
70, 5992.590560775426, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 4, 6, 8, 10]
71, 5992.590560775426, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 4, 6, 8, 10]
72, 5995.894046224512, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 3, 6, 8, 10]
73, 5995.894046224512, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 64, [0, 1, 2, 3, 3, 5, 8, 10]
74, 6015.843654571202, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 3, 4, 6, 8, 10]
75, 6018.099202972081, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)], 64, [0, 1, 2, 3, 4, 6, 8, 10]
76, 6027.764882550447, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 4, [0, 1, 2, 3, 3, 4, 6, 10]
77, 6069.717235823092, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 4, 6, 8, 10]
78, 6083.498871930993, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 1, 2, 3, 3, 4, 6, 8, 10]
79, 6300.06863050212, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(2, 4), (2, 4), (2, 4), (2, 4)], 64, [0, 4, 7, 8, 10]
80, 6307.118529914358, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(1, 8), (1, 8), (1, 8), (1, 8)], 128, [0, 4, 7, 8, 10]
81, 6376.539165082185, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 2, [0, 4, 8, 9, 10]
82, 6782.810570960667, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 2, 3, 3, 4, 6, 8, 10]
83, 6785.261462893279, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 4, 6, 8, 10]
84, 6785.289288980235, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 4, 6, 8, 10]
85, 6849.187314247463, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 3, 6, 8, 10]
86, 6849.187314247463, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 4, [0, 1, 2, 3, 3, 5, 8, 10]
87, 6925.939714627473, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (4, 2)], 2, [0, 4, 7, 8, 10]
88, 6933.608447984612, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 16, [0, 2, 4, 6, 7, 8, 8, 10]
89, 6937.866238829572, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 2, 3, 3, 4, 6, 8, 10]
90, 6939.662424799878, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 4, 6, 8, 10]
91, 6939.662424799878, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 4, 6, 8, 10]
92, 6942.209706120699, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 3, 6, 8, 10]
93, 6942.209706120699, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)], 128, [0, 1, 2, 3, 3, 5, 8, 10]
94, 6957.622089697797, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 3, 4, 6, 8, 10]
95, 6965.204803225476, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)], 128, [0, 1, 2, 3, 4, 6, 8, 10]
96, 6968.295426386957, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 1, [0, 2, 3, 6, 10]
97, 7091.786093539363, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], 32, [0, 3, 4, 6, 8, 8, 9, 10]
98, 7166.131924357207, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 4, 6, 8, 10]
99, 7194.229254190196, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 1, 2, 3, 3, 4, 6, 8, 10]
100, 7232.653916309191, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 8, [0, 2, 4, 6, 7, 8, 8, 10]
101, 7734.502889046047, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4)], 64, [0, 3, 4, 6, 8, 8, 9, 10]
102, 7819.502457607104, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], 4, [0, 3, 4, 6, 8, 8, 9, 10]
103, 7878.469928729845, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 4, [0, 3, 4, 6, 8, 8, 9, 10]
104, 7903.614080359417, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 2, [0, 1, 2, 3, 3, 4, 6, 10]
105, 7909.967639840167, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (8, 1)], 1, [0, 4, 8, 9, 10]
106, 8237.513146166593, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 16, [0, 2, 4, 6, 8, 8, 9, 10]
107, 8427.452949931932, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1)], 32, [0, 2, 4, 6, 8, 8, 9, 10]
108, 8428.372949931932, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], 32, [0, 2, 4, 6, 8, 9, 9, 10]
109, 8552.101842638927, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8)], 128, [0, 2, 4, 6, 7, 8, 8, 10]
110, 8597.342144881539, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 2, 3, 3, 4, 6, 8, 10]
111, 8603.602080920675, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 4, 6, 8, 10]
112, 8603.657733094587, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 4, 6, 8, 10]
113, 8678.921931669815, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 8, [0, 2, 4, 6, 8, 8, 9, 10]
114, 8725.7551322738, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 3, 6, 8, 10]
115, 8725.7551322738, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 2, [0, 1, 2, 3, 3, 5, 8, 10]
116, 9143.937291329426, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 8, 8, 8], [(8, 1), (8, 1), (8, 1), (4, 2)], 1, [0, 4, 7, 8, 10]
117, 9170.369266296884, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)], 8, [0, 3, 5, 7, 8, 8, 9, 10]
118, 9361.279159167745, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 4, 6, 8, 10]
119, 9421.53766351451, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 1, 2, 3, 3, 4, 6, 8, 10]
120, 9448.626636292001, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (1, 4)], 8, [0, 3, 5, 7, 8, 8, 9, 10]
121, 9467.777902911643, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], 2, [0, 3, 4, 6, 8, 8, 9, 10]
122, 9509.881714109337, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 64, [0, 2, 4, 6, 8, 8, 9, 10]
123, 9510.301714109337, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2)], 64, [0, 2, 4, 6, 8, 9, 9, 10]
124, 9525.788242648581, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 2, [0, 3, 4, 6, 8, 8, 9, 10]
125, 9537.350323691162, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2)], 16, [0, 2, 4, 5, 7, 8, 9, 10]
126, 9573.434792288075, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 4, [0, 2, 4, 6, 8, 8, 9, 10]
127, 9801.01037437439, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 6, 8, 8, 8, 9]
128, 9808.950065450254, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 3, 5, 8, 8, 8, 8, 9]
129, 9822.153399843963, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 4, 6, 8, 8, 8, 8, 9]
130, 9844.699977087768, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 6, 7, 8, 8, 9]
131, 9849.887435367418, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 32, [0, 2, 4, 6, 8, 8, 9, 10]
132, 9857.317565704843, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)], 8, [0, 3, 5, 7, 8, 8, 9, 10]
133, 9865.055589636098, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 7, 8, 8, 8, 9]
134, 9865.215589636098, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 7, 7, 7, 8, 9]
135, 9875.723594500501, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 4, 6, 7, 8, 8, 8, 9]
136, 9876.130972159013, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 3, 6, 7, 8, 8, 8, 9]
137, 9877.817531171882, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 2, 4, 7, 8, 8, 8, 9]
138, 9881.17556982621, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 4, 6, 7, 8, 8, 8, 9]
139, 9881.33556982621, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (2, 2), (4, 1), (4, 1), (4, 1)], 16, [0, 4, 5, 7, 7, 7, 8, 9]
140, 9886.303971249954, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 3, 6, 7, 8, 8, 8, 9]
141, 9905.066252869316, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)], 8, [0, 2, 4, 6, 8, 8, 8, 9]
142, 9906.57138543751, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (1, 4)], 8, [0, 3, 5, 7, 8, 8, 8, 9]
143, 9906.89138543751, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (1, 4), (1, 4)], 8, [0, 3, 5, 7, 8, 8, 8, 9]
144, 9907.531385437509, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], 8, [0, 3, 5, 7, 8, 8, 8, 9]
145, 9918.270245559526, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 32, [0, 2, 4, 6, 7, 8, 8, 9, 10]
146, 9947.683900751861, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 6, 7, 8, 8, 8, 9]
147, 9947.843900751861, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (2, 2), (4, 1), (4, 1), (4, 1)], 16, [0, 2, 4, 5, 7, 7, 7, 8, 9]
148, 9968.797077271005, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 3, 5, 7, 8, 8, 8, 9]
149, 9982.578713378907, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 3, 5, 7, 8, 8, 8, 8, 9]
150, 9984.748851681585, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)], 4, [0, 3, 5, 7, 8, 8, 9, 10]
151, 10005.768149142059, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], 8, [0, 4, 6, 7, 8, 9, 9, 10]
152, 10078.587637184806, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], 8, [0, 2, 4, 5, 7, 8, 8, 9]
153, 10113.70323645882, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 8, [0, 3, 6, 7, 8, 8, 8, 9]
154, 10154.02702259893, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], 8, [0, 2, 4, 6, 7, 8, 8, 9, 10]
155, 10255.98482994743, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (2, 2)], 8, [0, 2, 4, 7, 8, 8, 8, 9]
156, 10264.926221676702, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)], 4, [0, 3, 5, 7, 8, 8, 9, 10]
157, 10666.880618954534, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)], 4, [0, 3, 5, 7, 8, 8, 9, 10]
158, 10706.114954067729, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)], 4, [0, 2, 4, 6, 8, 8, 8, 9]
159, 10707.444745236273, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (1, 4)], 4, [0, 3, 5, 7, 8, 8, 8, 9]
160, 10708.084745236272, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (2, 2), (1, 4)], 4, [0, 3, 5, 7, 8, 8, 8, 9]
161, 10710.644745236272, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], 4, [0, 3, 5, 7, 8, 8, 8, 9]
162, 10769.990437069768, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 3, 5, 7, 8, 8, 8, 9]
163, 10798.087766902758, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 3, 5, 7, 8, 8, 8, 8, 9]
164, 10997.880813840782, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 4, 6, 8, 8, 9, 10]
165, 10998.592054592631, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], 4, [0, 2, 4, 5, 7, 8, 8, 9]
166, 11014.30947198785, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 4, 6, 7, 8, 8, 9, 10]
167, 11015.43469697206, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 5, 7, 8, 8, 9, 10]
168, 11015.43469697206, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(2, 2), (2, 2), (2, 4), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 4, 7, 8, 8, 9, 10]
169, 11035.384305318748, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)], 64, [0, 2, 4, 6, 7, 8, 8, 9, 10]
170, 11051.705508197289, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 4, 6, 7, 8, 8, 8, 9]
171, 11051.850372984514, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 2, 4, 7, 8, 8, 8, 9]
172, 11060.336813062586, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 4, [0, 3, 6, 7, 8, 8, 8, 9]
173, 11269.320030437968, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], 4, [0, 2, 4, 6, 7, 8, 8, 9, 10]
174, 11368.308158330503, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 2, [0, 2, 4, 6, 8, 8, 9, 10]
175, 11658.236298380312, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 1, [0, 1, 2, 3, 3, 4, 6, 10]
176, 12229.329115126237, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [8, 4, 4, 4, 4, 4, 4], [(8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 2, 3, 3, 4, 6, 8, 10]
177, 12243.207139378423, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 4, 6, 8, 10]
178, 12243.318443726248, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (8, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 4, 6, 8, 10]
179, 12293.84435997341, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1)], 2, [0, 3, 5, 6, 8, 8, 8, 9]
180, 12296.27802777, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4)], 128, [0, 2, 4, 5, 8, 8, 8, 9]
181, 12305.800812988282, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (2, 2)], 2, [0, 2, 4, 6, 8, 8, 9, 10]
182, 12320.492770831066, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4)], 128, [0, 2, 4, 6, 7, 8, 9, 10]
183, 12320.617770831066, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 8), (1, 4), (1, 4)], 128, [0, 2, 4, 5, 7, 8, 9, 10]
184, 12322.651856160372, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 4, 6, 7, 8, 8, 9, 10]
185, 12323.165052151888, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(1, 4), (1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 2, 4, 7, 8, 8, 9, 10]
186, 12323.71322891733, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(1, 4), (1, 8), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 3, 6, 7, 8, 8, 9, 10]
187, 12338.577435728985, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)], 128, [0, 2, 4, 6, 7, 8, 8, 9, 10]
188, 12374.695014409604, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 3, 5, 7, 8, 8, 8, 9]
189, 12400.657684279731, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (2, 4), (4, 1), (4, 1), (4, 1)], 2, [0, 3, 5, 6, 8, 8, 8, 9]
190, 12434.953518756369, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 3, 5, 7, 8, 8, 8, 8, 9]
191, 12481.814590729424, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 6, 8, 10]
192, 12481.814590729424, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 8, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 5, 8, 10]
193, 12767.252615923675, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 2)], 1, [0, 3, 4, 6, 8, 8, 9, 10]
194, 12823.348692889007, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 8], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (8, 1)], 1, [0, 3, 4, 6, 8, 8, 9, 10]
195, 12844.448534214185, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], 2, [0, 2, 4, 5, 7, 8, 8, 9]
196, 12950.965170997952, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 2, 4, 7, 8, 8, 8, 9]
197, 12953.64270535013, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 4, 6, 7, 8, 8, 8, 9]
198, 12959.451611076023, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 2, [0, 3, 6, 7, 8, 8, 8, 9]
199, 13505.753690921949, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], 2, [0, 2, 4, 6, 7, 8, 8, 9, 10]
200, 13879.078304566092, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 4, 6, 8, 10]
201, 13883.61344029634, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 5, 7, 10]
202, 13995.895577747511, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 5, 7, 10]
203, 14276.712947742628, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (2, 2), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 2, 2, 3, 3, 5, 7, 10]
204, 14471.730484974074, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (2, 2), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 5, 7, 10]
205, 14719.626213919599, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 7, 8]
206, 14722.186213919598, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 7, 8]
207, 14727.306213919599, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 7, 8]
208, 14752.770463664843, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (2, 2), (2, 2), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 5, 7, 10]
209, 14775.131905753095, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 3, 5, 7, 7, 7, 7, 8]
210, 14906.021248238605, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 7, 8]
211, 14941.220070731122, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (1, 4), (2, 2)], 1, [0, 3, 5, 7, 7, 7, 7, 8]
212, 14960.97871281831, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 8, 4], [(2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 4), (2, 2)], 1, [0, 2, 4, 6, 8, 8, 9, 10]
213, 15067.808068360038, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (2, 2), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 7, 8]
214, 15228.06143839629, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (2, 2), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 5, 7, 10]
215, 15703.797630519039, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 1, 2, 3, 3, 5, 7, 10]
216, 15711.608844866545, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 3, 5, 7, 8, 8, 8, 8, 9]
217, 15816.325845512722, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (2, 2)], 1, [0, 1, 2, 3, 3, 5, 7, 10]
218, 15821.735668225496, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 7, 8]
219, 15854.793685790353, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (8, 1), (2, 2), (4, 1), (1, 4)], 1, [0, 2, 2, 3, 3, 5, 8, 10]
220, 15898.357095512722, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (8, 1), (4, 1), (4, 1), (1, 4)], 1, [0, 2, 2, 3, 3, 5, 7, 10]
221, 16211.346384672082, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (8, 1), (2, 2), (2, 2), (1, 4)], 1, [0, 2, 2, 3, 3, 5, 7, 10]
222, 16259.261216497005, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (2, 4), (1, 4), (1, 4), (1, 4)], 1, [0, 1, 2, 3, 5, 7, 8, 10]
223, 16403.961155146724, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (4, 2), (1, 4), (1, 4), (1, 4)], 1, [0, 1, 2, 3, 4, 6, 8, 10]
224, 16485.580730481353, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (2, 2), (1, 4)], 1, [0, 2, 2, 3, 3, 5, 7, 10]
225, 16539.085315860248, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 8, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1)], 1, [0, 2, 4, 5, 7, 8, 8, 9]
226, 16752.11858942778, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 8, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 2, 4, 7, 8, 8, 8, 9]
227, 16755.071077514316, (<DeviceType.V100: 'v100'>, <DeviceType.A100: 'a100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (1, 4), (1, 4)], 1, [0, 2, 2, 3, 3, 6, 8, 10]
228, 16760.44092205877, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [8, 4, 4, 4, 4, 4, 4], [(4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 4, 6, 7, 8, 8, 8, 9]
229, 16760.605029505852, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 8, 4, 4, 4, 4, 4], [(4, 1), (4, 2), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1)], 1, [0, 3, 6, 7, 8, 8, 8, 9]
230, 16839.588263616148, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (2, 4), (1, 4), (1, 4), (1, 4)], 1, [0, 2, 4, 6, 8, 8, 9, 10]
231, 16984.836379031305, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (4, 2), (1, 4), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 8, 8, 9, 10]
232, 17981.544834292865, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 4, 4, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (4, 1), (2, 2)], 1, [0, 2, 4, 6, 7, 8, 8, 9, 10]
233, 18197.379792410808, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)], 1, [0, 3, 5, 7, 7, 7, 8, 9]
234, 18478.197162405926, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (2, 2), (2, 2)], 1, [0, 3, 5, 7, 7, 7, 8, 9]
235, 19236.45104429162, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(2, 2), (2, 2), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 8, 9]
236, 19559.76938882247, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (2, 2), (2, 2), (8, 1), (1, 4), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 8, 9]
237, 20103.494081664707, (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), [4, 4, 4, 8, 4, 4, 4], [(1, 4), (1, 4), (1, 4), (8, 1), (1, 4), (1, 4), (1, 4)], 1, [0, 3, 5, 7, 7, 7, 8, 9]
